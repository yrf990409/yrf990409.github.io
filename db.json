{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"themes/light/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":0,"renderable":1},{"_id":"themes/light/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/light/source/fancybox/fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/light/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/light/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/light/source/fancybox/fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/light/source/fancybox/jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/light/source/fancybox/jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/light/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/light/source/js/gallery.js","path":"js/gallery.js","modified":0,"renderable":1},{"_id":"themes/light/source/js/jquery-3.4.1.min.js","path":"js/jquery-3.4.1.min.js","modified":0,"renderable":1},{"_id":"themes/light/source/js/jquery.imagesloaded.min.js","path":"js/jquery.imagesloaded.min.js","modified":0,"renderable":1},{"_id":"themes/light/source/css/font/fontawesome-webfont.eot","path":"css/font/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/light/source/css/font/fontawesome-webfont.svg","path":"css/font/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"themes/light/source/css/font/fontawesome-webfont.ttf","path":"css/font/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/light/source/css/font/fontawesome-webfont.woff","path":"css/font/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"source/images/20240824/2024-08-27-14-21-28.png","path":"images/20240824/2024-08-27-14-21-28.png","modified":0,"renderable":0},{"_id":"source/images/20240824/cleveref.png","path":"images/20240824/cleveref.png","modified":0,"renderable":0},{"_id":"source/images/20240824/landscape.png","path":"images/20240824/landscape.png","modified":0,"renderable":0},{"_id":"source/images/20240824/landscape_after.png","path":"images/20240824/landscape_after.png","modified":0,"renderable":0},{"_id":"source/images/20240824/landscape_center.png","path":"images/20240824/landscape_center.png","modified":0,"renderable":0},{"_id":"source/images/20240824/subfigure.png","path":"images/20240824/subfigure.png","modified":0,"renderable":0},{"_id":"source/images/20240824/tablenote.png","path":"images/20240824/tablenote.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20221217132844590.png","path":"images/20240712/image-20221217132844590.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20221217162523874.png","path":"images/20240712/image-20221217162523874.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20230930182045754.png","path":"images/20240712/image-20230930182045754.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20230930192441679.png","path":"images/20240712/image-20230930192441679.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20230930192546137.png","path":"images/20240712/image-20230930192546137.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20230930192625728.png","path":"images/20240712/image-20230930192625728.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20230930192855816.png","path":"images/20240712/image-20230930192855816.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20230930194758499.png","path":"images/20240712/image-20230930194758499.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001134101744.png","path":"images/20240712/image-20231001134101744.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001134157379.png","path":"images/20240712/image-20231001134157379.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001134208296.png","path":"images/20240712/image-20231001134208296.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001134234483.png","path":"images/20240712/image-20231001134234483.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001134303941.png","path":"images/20240712/image-20231001134303941.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001134944337.png","path":"images/20240712/image-20231001134944337.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001135319241.png","path":"images/20240712/image-20231001135319241.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001140304900.png","path":"images/20240712/image-20231001140304900.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001140515750.png","path":"images/20240712/image-20231001140515750.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001140517974.png","path":"images/20240712/image-20231001140517974.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001140519650.png","path":"images/20240712/image-20231001140519650.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001140532936.png","path":"images/20240712/image-20231001140532936.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001151417317.png","path":"images/20240712/image-20231001151417317.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001151523651.png","path":"images/20240712/image-20231001151523651.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001164150891.png","path":"images/20240712/image-20231001164150891.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001165505931.png","path":"images/20240712/image-20231001165505931.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001165725593.png","path":"images/20240712/image-20231001165725593.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001165858415.png","path":"images/20240712/image-20231001165858415.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001165922621.png","path":"images/20240712/image-20231001165922621.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001165952424.png","path":"images/20240712/image-20231001165952424.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001170909421.png","path":"images/20240712/image-20231001170909421.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001171701950.png","path":"images/20240712/image-20231001171701950.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001171745717.png","path":"images/20240712/image-20231001171745717.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001172136136.png","path":"images/20240712/image-20231001172136136.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001172945916.png","path":"images/20240712/image-20231001172945916.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001173153802.png","path":"images/20240712/image-20231001173153802.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001173452560.png","path":"images/20240712/image-20231001173452560.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001173620154.png","path":"images/20240712/image-20231001173620154.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001184526448.png","path":"images/20240712/image-20231001184526448.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001192302431.png","path":"images/20240712/image-20231001192302431.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001201801595.png","path":"images/20240712/image-20231001201801595.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001203448287.png","path":"images/20240712/image-20231001203448287.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231001203458641.png","path":"images/20240712/image-20231001203458641.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20231006133646069.png","path":"images/20240712/image-20231006133646069.png","modified":0,"renderable":0},{"_id":"source/images/20240712/image-20240712115425.png","path":"images/20240712/image-20240712115425.png","modified":0,"renderable":0}],"Cache":[{"_id":"source/_posts/.DS_Store","hash":"1ac43383105fb765685d8043ae7733a99d3e5214","modified":1724745037590},{"_id":"source/_posts/2024-07-09-hello_blog.md","hash":"4348b94f9e7fade9f0d957b4ba542664345d15a0","modified":1723948831169},{"_id":"source/.DS_Store","hash":"fa5b8e45502fd1723f16315906df2bc184575f9f","modified":1724746108557},{"_id":"source/_posts/2024-07-12-Matlab程序开发经验分享.md","hash":"2ccb8fd7d6f19234e0f4b71bb7f4fa8b9d2d0c03","modified":1724745881295},{"_id":"source/_posts/2024-08-18-写作.md","hash":"56ea8543797a3b6c0480c33d2ecd1111cb6739a2","modified":1724731261315},{"_id":"source/_posts/2024-08-24-elsarticle.md","hash":"636e3073672a1620b56628a9ed152d7350bc9406","modified":1724745956270},{"_id":"source/images/20240712/image-20221217132844590.png","hash":"69355b0b793a636412b4b0cd630ee942d4e2c6ec","modified":1720755829098},{"_id":"source/images/20240712/image-20221217162523874.png","hash":"cfda6f06f6a5b6d6b07095fd0a7fa4be80191419","modified":1720755829111},{"_id":"source/images/20240824/tablenote.png","hash":"256d559f224edbe448db90e30d94247de25029e9","modified":1724741052673},{"_id":"source/images/20240712/image-20230930192441679.png","hash":"6b6aa6e3a0dcf0a2a996de9ca64ede09376aa63a","modified":1720755829125},{"_id":"source/images/.DS_Store","hash":"40f441e13ff88a5039bc1f95630069d9fd17f44b","modified":1724744967189},{"_id":"source/images/20240712/image-20230930182045754.png","hash":"6af68207436df65f4d311f48fd8c075d00d43410","modified":1720755829117},{"_id":"source/images/20240712/image-20231001134157379.png","hash":"3d8b8ddacc2c38bbdaff1224602e470622096c85","modified":1720755829203},{"_id":"source/images/20240712/image-20231001134234483.png","hash":"c41029641b0303f04a33e665a0580d27a82c1258","modified":1720755829234},{"_id":"source/images/20240712/image-20231001134208296.png","hash":"3d8b8ddacc2c38bbdaff1224602e470622096c85","modified":1720755829222},{"_id":"source/images/20240712/image-20230930194758499.png","hash":"390a05d02197096e146a531e0adac8f694bee7b8","modified":1720755829155},{"_id":"source/images/20240712/image-20231001134101744.png","hash":"c03016ba0489d3b829a92d5d0a509cece9650344","modified":1720755829168},{"_id":"source/images/20240712/image-20231001134303941.png","hash":"c41029641b0303f04a33e665a0580d27a82c1258","modified":1720755829246},{"_id":"source/images/20240712/image-20231001165505931.png","hash":"99112237243e306ef8c1f4528ad86a3284770bd4","modified":1720755829382},{"_id":"source/images/20240712/image-20231001164150891.png","hash":"48848547303b41175dfcda61ea75d7cd87eade03","modified":1720755829367},{"_id":"source/images/20240712/image-20231001151523651.png","hash":"c0471a1007a3c36c47762ed676fdee5b1774b0ae","modified":1720755829352},{"_id":"source/images/20240712/image-20231001165858415.png","hash":"a7be36e9d2f17d2661a8e51cb23eebeabd4ac9d8","modified":1720755829410},{"_id":"source/images/20240712/image-20231001165952424.png","hash":"180cab94bea8f013e16d1f5ac22f23262816eb38","modified":1720755829447},{"_id":"source/images/20240712/image-20231001165922621.png","hash":"6af409a9e73cc93e3aaadcea807e728ac24b1b59","modified":1720755829439},{"_id":"source/images/20240712/image-20231001165725593.png","hash":"3ad38d940d19d613b1937365ef6f3c21afeb91d5","modified":1720755829401},{"_id":"source/images/20240712/image-20231001172136136.png","hash":"fc80fb2a14025c8c4c4a5df88dbdc03530f7b0a4","modified":1720755829518},{"_id":"source/images/20240712/image-20231001171745717.png","hash":"eb1921fac23e940bb027101ad35ee69331d3d608","modified":1720755829504},{"_id":"source/images/20240712/image-20231001172945916.png","hash":"8c306c86b48daf8354558a93f3c3474a7a81d671","modified":1720755829529},{"_id":"source/images/20240712/image-20231001203448287.png","hash":"5606df42049ff4f1bca51f67d0ceeeca96c8d3ca","modified":1696163690000},{"_id":"source/images/20240712/image-20231001201801595.png","hash":"17eb285713ca7cd71a42eb53ebbb86f15d7e8e65","modified":1696162682000},{"_id":"source/images/20240712/image-20231001203458641.png","hash":"ba48e61bd4b69cd4064877dd6f6eff56d7df0a99","modified":1696163700000},{"_id":"source/images/20240712/image-20231006133646069.png","hash":"87fac75cbe8d7602e5d279546ca81c81253d3384","modified":1696570608000},{"_id":"source/images/20240712/image-20240712115425.png","hash":"43a00c3cf95ae13d2ce1fb2aed333bd9a3bf29f1","modified":1720756475733},{"_id":"source/images/20240712/image-20231001173452560.png","hash":"8f7b424fc63a12df34589f04464b6246ecbf9d8f","modified":1720755829556},{"_id":"source/images/20240824/cleveref.png","hash":"c748bba01e1730388fd73a90fbd97a583c36f538","modified":1724742461591},{"_id":"source/images/20240824/landscape.png","hash":"1274944998612776d5c3a793c1e9b2d1d8e9ad06","modified":1724742842275},{"_id":"source/images/20240824/landscape_center.png","hash":"283be28acf27ccfc7b0aea265234579e8e080ab2","modified":1724743321463},{"_id":"themes/light/source/css/_base/utils.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1712588836000},{"_id":"source/images/20240712/image-20230930192625728.png","hash":"e3e5d5bffe9a15f29c77002a8c9e8589da393aad","modified":1720755829139},{"_id":"source/images/20240712/image-20231001134944337.png","hash":"4524f726a65d4d4c814371983a68fead6ee37be3","modified":1720755829253},{"_id":"source/images/20240712/image-20231001135319241.png","hash":"d51c0490b25a94257664cdf6510086e51ed93928","modified":1720755829081},{"_id":"source/images/20240712/image-20231001140532936.png","hash":"572da902bf74363a8f09f881d871544680a286c5","modified":1720755829322},{"_id":"source/images/20240712/image-20231001140304900.png","hash":"f5db8cfb706a1766ce9c63ae4be772417fa5b54c","modified":1720755829265},{"_id":"source/images/20240712/image-20231001140515750.png","hash":"572da902bf74363a8f09f881d871544680a286c5","modified":1720755829277},{"_id":"source/images/20240712/image-20231001140517974.png","hash":"572da902bf74363a8f09f881d871544680a286c5","modified":1720755829290},{"_id":"source/images/20240712/image-20231001140519650.png","hash":"572da902bf74363a8f09f881d871544680a286c5","modified":1720755829303},{"_id":"source/images/20240712/image-20231001170909421.png","hash":"69ed2b69c1ec75c7ae21007e15084728b8a9b19b","modified":1720755829466},{"_id":"source/images/20240712/image-20231001173620154.png","hash":"f4e6ac47c4b4a7d2cf8272811ff88ded9ebedba8","modified":1720755829569},{"_id":"source/images/20240712/image-20231001173153802.png","hash":"9219ea62aef28eebe650a4c90b09b4b96d5388cf","modified":1720755829542},{"_id":"source/images/20240824/2024-08-27-14-21-28.png","hash":"07ad6430e0bbf135bf111a9ecdfb85d5267a385a","modified":1724739988279},{"_id":"source/images/20240824/subfigure.png","hash":"85009255dd38457574c9f0596f92021594734184","modified":1724741878287},{"_id":"themes/light/.gitignore","hash":"eaa3d84cb77d92a21b111fd1e37f53edc1ff9de0","modified":1712588836000},{"_id":"themes/light/LICENSE","hash":"c6f301bc722f0af3a55267a36c1c147aeddc6e46","modified":1712588836000},{"_id":"themes/light/_config.yml","hash":"4b3929f514d658ebafe5fe6bfcbcf9b8f7e644f2","modified":1724900780440},{"_id":"themes/light/README.md","hash":"bbf4cfa9399264eed1fb22790d3ee8e385cfa997","modified":1712588836000},{"_id":"themes/light/layout/archive.ejs","hash":"a18842e3d719fe3ca9b977a6995f8facc75c8673","modified":1712588836000},{"_id":"themes/light/layout/category.ejs","hash":"9b740fc33f6f028df60f0bc4312bf3ebd03aa8ea","modified":1712588836000},{"_id":"themes/light/layout/index.ejs","hash":"e569d8fe0741a24efb89e44781f9e616da17e036","modified":1712588836000},{"_id":"themes/light/layout/layout.ejs","hash":"1b4ee853dcd80892ba971954641c0e283ddb2e6e","modified":1712588836000},{"_id":"themes/light/layout/page.ejs","hash":"70cbc9854655773cc6ba84eecaaf330fed430465","modified":1712588836000},{"_id":"themes/light/layout/post.ejs","hash":"70cbc9854655773cc6ba84eecaaf330fed430465","modified":1712588836000},{"_id":"themes/light/layout/tag.ejs","hash":"45150a2365768b6b67880193c9264ad2bb4814db","modified":1712588836000},{"_id":"themes/light/languages/de.yml","hash":"e076c7f2eb29ebcfb04d94861bf3063c4b08078c","modified":1712588836000},{"_id":"themes/light/languages/de-DE.yml","hash":"e076c7f2eb29ebcfb04d94861bf3063c4b08078c","modified":1712588836000},{"_id":"themes/light/languages/default.yml","hash":"fd7397be7789b43c1c163ab4faf106318811c2a8","modified":1712588836000},{"_id":"themes/light/languages/en-GB.yml","hash":"fd7397be7789b43c1c163ab4faf106318811c2a8","modified":1712588836000},{"_id":"themes/light/languages/en-US.yml","hash":"fd7397be7789b43c1c163ab4faf106318811c2a8","modified":1712588836000},{"_id":"themes/light/languages/en.yml","hash":"fd7397be7789b43c1c163ab4faf106318811c2a8","modified":1712588836000},{"_id":"themes/light/.DS_Store","hash":"21a91ebadcee0e35f12d3350ec682e4f13c207e5","modified":1720425025986},{"_id":"themes/light/languages/es.yml","hash":"de273af604b27812cfd4195e7b7f28ceff2734b3","modified":1712588836000},{"_id":"themes/light/languages/es-ES.yml","hash":"de273af604b27812cfd4195e7b7f28ceff2734b3","modified":1712588836000},{"_id":"themes/light/languages/ja-JP.yml","hash":"1511143393fb86819a9d8685ee81c3bbf1e10b23","modified":1712588836000},{"_id":"themes/light/languages/ja.yml","hash":"1511143393fb86819a9d8685ee81c3bbf1e10b23","modified":1712588836000},{"_id":"themes/light/languages/no.yml","hash":"bf11017d77f64fbafb9c99ac219d076b20d53afc","modified":1712588836000},{"_id":"themes/light/languages/lt.yml","hash":"8826ef5b3911e094f8a118d8db981532d0919bb6","modified":1712588836000},{"_id":"themes/light/languages/lt-LT.yml","hash":"8826ef5b3911e094f8a118d8db981532d0919bb6","modified":1712588836000},{"_id":"themes/light/languages/pl-PL.yml","hash":"3f36d08e84a85651bf777cec0752193057c08430","modified":1712588836000},{"_id":"themes/light/languages/pl.yml","hash":"3f36d08e84a85651bf777cec0752193057c08430","modified":1712588836000},{"_id":"themes/light/languages/zh-CN.yml","hash":"ca0118e9081b54cc0fca8596660bd6acf4c0308f","modified":1712588836000},{"_id":"themes/light/languages/ru.yml","hash":"35aadf8fdd28aaff8a1c8f50e80201dcf8ce0604","modified":1712588836000},{"_id":"themes/light/languages/ru-RU.yml","hash":"35aadf8fdd28aaff8a1c8f50e80201dcf8ce0604","modified":1712588836000},{"_id":"themes/light/languages/zh-TW.yml","hash":"6141b4c7a094c74bd9df7c08908d92b561c1a0c0","modified":1712588836000},{"_id":"themes/light/.github/workflows/deploy.yml","hash":"8e2b2e96230bd100311e1cf836c6d1b3d226d9e0","modified":1712588836000},{"_id":"themes/light/layout/_widget/archive.ejs","hash":"ec9170f9257c9f6bf322d2bc501ce30634a41ffa","modified":1712588836000},{"_id":"themes/light/layout/_widget/category.ejs","hash":"1b4276f68e6bcab9dbe5538955445b0ad689176a","modified":1712588836000},{"_id":"themes/light/layout/_widget/search.ejs","hash":"f3600ade452f70bd49cb8cf53f3b6e59015f2ce3","modified":1712588836000},{"_id":"themes/light/layout/_widget/tag.ejs","hash":"06c53c04bd4e3e5924fc50feb97b0319ddc7c834","modified":1712588836000},{"_id":"themes/light/layout/_partial/after_footer.ejs","hash":"8d433832b97d5deeed32547bd2130ea870a2b489","modified":1712588836000},{"_id":"themes/light/layout/_widget/recent_posts.ejs","hash":"9e299ce56b221fc287828ad0c73e91ae6bba0fb7","modified":1712588836000},{"_id":"themes/light/layout/_widget/tagcloud.ejs","hash":"a236c86481196ae43206e056ba78cec14f1ac014","modified":1712588836000},{"_id":"themes/light/layout/_partial/archive.ejs","hash":"92e6fa48d15f2ccf91f589dacc898489a40974ba","modified":1712588836000},{"_id":"themes/light/layout/_partial/article.ejs","hash":"a8c4601ffc1327b816043a5081772f9bd6c7debc","modified":1712588836000},{"_id":"themes/light/layout/_partial/comment.ejs","hash":"eb6a26f7133fc81be6eac6e62d3c8c99f7791f5f","modified":1712588836000},{"_id":"themes/light/layout/_partial/footer.ejs","hash":"1deac5914b2fc93b271732fd4d5cbd0a6f78875f","modified":1712588836000},{"_id":"themes/light/layout/_partial/google_analytics.ejs","hash":"85785202d60795ce0844daa85ee0c661aabf429e","modified":1712588836000},{"_id":"themes/light/layout/_partial/head.ejs","hash":"db2e0e61efe1d6c4bf6eb020983f1d1fdc3d521c","modified":1712588836000},{"_id":"themes/light/layout/_partial/facebook_comment.ejs","hash":"3fdc1d0ce9177825e7417635fbc545a35d528d04","modified":1712588836000},{"_id":"themes/light/layout/_partial/header.ejs","hash":"ba97d05f033c98aa3acea060f7e18020ccfe5b7d","modified":1712588836000},{"_id":"themes/light/layout/_partial/pagination.ejs","hash":"bca8de52586b7a929abdfef92dad93d98f4ac77f","modified":1712588836000},{"_id":"themes/light/layout/_partial/sidebar.ejs","hash":"caf351797a18d03d8ee945ceb9f83785c50c09f9","modified":1712588836000},{"_id":"themes/light/source/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1712588836000},{"_id":"themes/light/source/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1712588836000},{"_id":"themes/light/source/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1712588836000},{"_id":"themes/light/source/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1712588836000},{"_id":"themes/light/source/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1712588836000},{"_id":"themes/light/source/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1712588836000},{"_id":"themes/light/source/fancybox/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1712588836000},{"_id":"themes/light/source/css/style.styl","hash":"c03b2520e4a85b981e29516cadc0a365e6500e3d","modified":1712588836000},{"_id":"themes/light/source/js/gallery.js","hash":"f8a4ba7fb8349cca374a3c69fff9b2bf21f742ed","modified":1712588836000},{"_id":"themes/light/source/js/jquery.imagesloaded.min.js","hash":"4109837b1f6477bacc6b095a863b1b95b1b3693f","modified":1712588836000},{"_id":"themes/light/layout/_partial/post/category.ejs","hash":"037a6e5d51407205846c6c21bb08e5928f424ef0","modified":1712588836000},{"_id":"themes/light/layout/_partial/post/gallery.ejs","hash":"fafc2501d7e65983b0f5c2b58151ca12e57c0574","modified":1712588836000},{"_id":"themes/light/layout/_partial/post/tag.ejs","hash":"ec06dba9abac62d6bec84baab0e185467ca0bce1","modified":1712588836000},{"_id":"themes/light/layout/_partial/post/title.ejs","hash":"fcb98a84fe5beffa3162fa2e12e06dc937a789b6","modified":1712588836000},{"_id":"themes/light/source/css/_base/layout.styl","hash":"1b58c21aa48a8f9f7f811af681ac182dd058e23d","modified":1712588836000},{"_id":"themes/light/source/css/_base/variable.styl","hash":"6f3ad13e49634dae8cd992bbd598f5ff0b39a816","modified":1712588836000},{"_id":"themes/light/source/css/_partial/archive.styl","hash":"072e9b8c5ee9acf95ac7cce9c34706d41e412229","modified":1712588836000},{"_id":"themes/light/source/fancybox/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1712588836000},{"_id":"themes/light/source/css/_partial/article.styl","hash":"3c1d34424030de89f49b6bcba812ac1027704cdd","modified":1712588836000},{"_id":"themes/light/source/css/_partial/comment.styl","hash":"e7f8c085bfa8c26afc4b2fbc9f2092f4f07aef34","modified":1712588836000},{"_id":"themes/light/source/css/_partial/footer.styl","hash":"1757872dbdbd09295a625f13e356aa798a8bb308","modified":1712588836000},{"_id":"themes/light/source/css/_partial/index.styl","hash":"7a8c0ec6ab99a9f8e00c9687aca29d31752424a2","modified":1712588836000},{"_id":"themes/light/source/css/_partial/sidebar.styl","hash":"159f565f1811c149cdbb692d03fc90697c24da55","modified":1712588836000},{"_id":"themes/light/source/css/_partial/header.styl","hash":"50d36fe0c803cbba69dd57493611466e4d72156e","modified":1712588836000},{"_id":"themes/light/source/css/_partial/syntax.styl","hash":"e766ae76f993733421c69020a030eb2ae1899895","modified":1712588836000},{"_id":"themes/light/source/css/font/fontawesome-webfont.eot","hash":"d775f599ff3f23be082e6a9604b4898718923a37","modified":1712588836000},{"_id":"source/images/20240712/image-20230930192855816.png","hash":"f9ed6dad1dfdd7a36492d950bf1a03513bd1ffba","modified":1720755829145},{"_id":"source/images/20240712/image-20231001151417317.png","hash":"574918d349973c6378f4e074f25947b5a0a8faf3","modified":1720755829330},{"_id":"source/images/20240712/image-20231001184526448.png","hash":"1344a3c20bf660ef99b97817aece8aab3a2b0658","modified":1720755829584},{"_id":"source/images/20240712/image-20231001192302431.png","hash":"f0aa7a9edcb6a5f43e329846023c2a84050c540f","modified":1696159384000},{"_id":"themes/light/source/css/font/fontawesome-webfont.woff","hash":"0612cddf2f835cceffccc88fd194f97367d0b024","modified":1712588836000},{"_id":"source/images/20240824/landscape_after.png","hash":"18da62260794f63d1c693a1117efe72145ed269f","modified":1724743840153},{"_id":"themes/light/source/js/jquery-3.4.1.min.js","hash":"88523924351bac0b5d560fe0c5781e2556e7693d","modified":1712588836000},{"_id":"themes/light/source/css/font/fontawesome-webfont.svg","hash":"d162419c91b8bab3a4fd327c933a0fcf3799c251","modified":1712588836000},{"_id":"themes/light/source/css/font/fontawesome-webfont.ttf","hash":"a9468f6a1fe965fbcaf5a1bd6c11705e2fc5f84c","modified":1712588836000},{"_id":"source/images/20240712/image-20230930192546137.png","hash":"243bb6abf19a86809139c055d931270847654c42","modified":1720755829131},{"_id":"source/images/20240712/image-20231001171701950.png","hash":"e4984503cdfb8b8f9c1d29f8d4332187a75c9c5b","modified":1720755829481},{"_id":"public/2024/08/24/2024-08-24-elsarticle/index.html","hash":"298cefd3eaccc0313baf669cf49f30e1232964b8","modified":1724900790481},{"_id":"public/2024/07/12/2024-07-12-Matlab程序开发经验分享/index.html","hash":"b9d1feaa87f949557568c0af9931fb9fa9a2c4af","modified":1724900790481},{"_id":"public/2024/08/18/2024-08-18-写作/index.html","hash":"63d8e65155ec390633832cd1f09a873ce654fcd3","modified":1724900790481},{"_id":"public/2024/07/09/2024-07-09-hello_blog/index.html","hash":"473feadc3407da738b0f2b154922735750190be7","modified":1724900790481},{"_id":"public/archives/index.html","hash":"73a339e528ccd411bba5d889b4a20fbcbef03404","modified":1724900790481},{"_id":"public/archives/2024/index.html","hash":"0c8913ebaaaa6a5c0846acc2cbc10cb67d0f5eab","modified":1724900790481},{"_id":"public/archives/2024/07/index.html","hash":"794bdefd9a4ffd2b1e44b708a3b0b4a615651775","modified":1724900790481},{"_id":"public/archives/2024/08/index.html","hash":"e8273bc1c9372057ea513a3b49da5349d0bf950f","modified":1724900790481},{"_id":"public/tags/Others/index.html","hash":"7bb50cfe6874a244570985086cc687a384dcb6fa","modified":1724900790481},{"_id":"public/tags/Matlab/index.html","hash":"b45a086a1b91d456c4fd3dbf78373e1551d458b0","modified":1724900790481},{"_id":"public/tags/写作/index.html","hash":"f4b87b54defdbb8c42dae8da755da5187bc1b560","modified":1724900790481},{"_id":"public/tags/Latex/index.html","hash":"813205e3848b10fb1b1f36cfa24b2d5513d39b68","modified":1724900790481},{"_id":"public/index.html","hash":"becd6bef13ce46df6b13208b4be317d987ccfcea","modified":1724900790481},{"_id":"public/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1724900626988},{"_id":"public/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1724900626988},{"_id":"public/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1724900626988},{"_id":"public/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1724900626988},{"_id":"public/css/font/fontawesome-webfont.eot","hash":"d775f599ff3f23be082e6a9604b4898718923a37","modified":1724900626988},{"_id":"public/css/font/fontawesome-webfont.woff","hash":"0612cddf2f835cceffccc88fd194f97367d0b024","modified":1724900626988},{"_id":"public/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1724900626988},{"_id":"public/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1724900626988},{"_id":"public/images/20240824/tablenote.png","hash":"256d559f224edbe448db90e30d94247de25029e9","modified":1724900626988},{"_id":"public/images/20240712/image-20221217132844590.png","hash":"69355b0b793a636412b4b0cd630ee942d4e2c6ec","modified":1724900626988},{"_id":"public/images/20240712/image-20221217162523874.png","hash":"cfda6f06f6a5b6d6b07095fd0a7fa4be80191419","modified":1724900626988},{"_id":"public/images/20240712/image-20230930182045754.png","hash":"6af68207436df65f4d311f48fd8c075d00d43410","modified":1724900626988},{"_id":"public/images/20240712/image-20231001134101744.png","hash":"c03016ba0489d3b829a92d5d0a509cece9650344","modified":1724900626988},{"_id":"public/images/20240712/image-20231001134208296.png","hash":"3d8b8ddacc2c38bbdaff1224602e470622096c85","modified":1724900626988},{"_id":"public/images/20240712/image-20230930194758499.png","hash":"390a05d02197096e146a531e0adac8f694bee7b8","modified":1724900626988},{"_id":"public/images/20240712/image-20231001134157379.png","hash":"3d8b8ddacc2c38bbdaff1224602e470622096c85","modified":1724900626988},{"_id":"public/images/20240712/image-20230930192441679.png","hash":"6b6aa6e3a0dcf0a2a996de9ca64ede09376aa63a","modified":1724900626988},{"_id":"public/images/20240712/image-20231001134303941.png","hash":"c41029641b0303f04a33e665a0580d27a82c1258","modified":1724900626988},{"_id":"public/images/20240712/image-20231001134234483.png","hash":"c41029641b0303f04a33e665a0580d27a82c1258","modified":1724900626988},{"_id":"public/images/20240712/image-20231001151523651.png","hash":"c0471a1007a3c36c47762ed676fdee5b1774b0ae","modified":1724900626988},{"_id":"public/images/20240712/image-20231001165725593.png","hash":"3ad38d940d19d613b1937365ef6f3c21afeb91d5","modified":1724900626988},{"_id":"public/images/20240712/image-20231001165505931.png","hash":"99112237243e306ef8c1f4528ad86a3284770bd4","modified":1724900626988},{"_id":"public/images/20240712/image-20231001165858415.png","hash":"a7be36e9d2f17d2661a8e51cb23eebeabd4ac9d8","modified":1724900626988},{"_id":"public/images/20240712/image-20231001165922621.png","hash":"6af409a9e73cc93e3aaadcea807e728ac24b1b59","modified":1724900626988},{"_id":"public/images/20240712/image-20231001172945916.png","hash":"8c306c86b48daf8354558a93f3c3474a7a81d671","modified":1724900626988},{"_id":"public/images/20240712/image-20231001164150891.png","hash":"48848547303b41175dfcda61ea75d7cd87eade03","modified":1724900626988},{"_id":"public/images/20240712/image-20231001171745717.png","hash":"eb1921fac23e940bb027101ad35ee69331d3d608","modified":1724900626988},{"_id":"public/images/20240712/image-20231001173452560.png","hash":"8f7b424fc63a12df34589f04464b6246ecbf9d8f","modified":1724900626988},{"_id":"public/images/20240712/image-20231001165952424.png","hash":"180cab94bea8f013e16d1f5ac22f23262816eb38","modified":1724900626988},{"_id":"public/images/20240712/image-20231001172136136.png","hash":"fc80fb2a14025c8c4c4a5df88dbdc03530f7b0a4","modified":1724900626988},{"_id":"public/images/20240712/image-20231001201801595.png","hash":"17eb285713ca7cd71a42eb53ebbb86f15d7e8e65","modified":1724900626988},{"_id":"public/images/20240712/image-20231001203448287.png","hash":"5606df42049ff4f1bca51f67d0ceeeca96c8d3ca","modified":1724900626988},{"_id":"public/images/20240712/image-20231006133646069.png","hash":"87fac75cbe8d7602e5d279546ca81c81253d3384","modified":1724900626988},{"_id":"public/images/20240712/image-20240712115425.png","hash":"43a00c3cf95ae13d2ce1fb2aed333bd9a3bf29f1","modified":1724900626988},{"_id":"public/images/20240712/image-20231001203458641.png","hash":"ba48e61bd4b69cd4064877dd6f6eff56d7df0a99","modified":1724900626988},{"_id":"public/css/font/fontawesome-webfont.ttf","hash":"a9468f6a1fe965fbcaf5a1bd6c11705e2fc5f84c","modified":1724900626988},{"_id":"public/images/20240824/cleveref.png","hash":"c748bba01e1730388fd73a90fbd97a583c36f538","modified":1724900626988},{"_id":"public/css/font/fontawesome-webfont.svg","hash":"d162419c91b8bab3a4fd327c933a0fcf3799c251","modified":1724900626988},{"_id":"public/images/20240824/landscape.png","hash":"1274944998612776d5c3a793c1e9b2d1d8e9ad06","modified":1724900626988},{"_id":"public/images/20240824/landscape_center.png","hash":"283be28acf27ccfc7b0aea265234579e8e080ab2","modified":1724900626988},{"_id":"public/fancybox/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1724900626988},{"_id":"public/js/gallery.js","hash":"f8a4ba7fb8349cca374a3c69fff9b2bf21f742ed","modified":1724900626988},{"_id":"public/css/style.css","hash":"233b1bf75dd92991d20c68387070ba37c1d34e9c","modified":1724900626988},{"_id":"public/fancybox/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1724900626988},{"_id":"public/js/jquery.imagesloaded.min.js","hash":"4109837b1f6477bacc6b095a863b1b95b1b3693f","modified":1724900626988},{"_id":"public/js/jquery-3.4.1.min.js","hash":"88523924351bac0b5d560fe0c5781e2556e7693d","modified":1724900626988},{"_id":"public/images/20240712/image-20231001134944337.png","hash":"4524f726a65d4d4c814371983a68fead6ee37be3","modified":1724900626988},{"_id":"public/images/20240712/image-20231001135319241.png","hash":"d51c0490b25a94257664cdf6510086e51ed93928","modified":1724900626988},{"_id":"public/images/20240712/image-20231001140515750.png","hash":"572da902bf74363a8f09f881d871544680a286c5","modified":1724900626988},{"_id":"public/images/20240712/image-20230930192625728.png","hash":"e3e5d5bffe9a15f29c77002a8c9e8589da393aad","modified":1724900626988},{"_id":"public/images/20240712/image-20231001140519650.png","hash":"572da902bf74363a8f09f881d871544680a286c5","modified":1724900626988},{"_id":"public/images/20240712/image-20231001140304900.png","hash":"f5db8cfb706a1766ce9c63ae4be772417fa5b54c","modified":1724900626988},{"_id":"public/images/20240712/image-20231001140517974.png","hash":"572da902bf74363a8f09f881d871544680a286c5","modified":1724900626988},{"_id":"public/images/20240712/image-20231001140532936.png","hash":"572da902bf74363a8f09f881d871544680a286c5","modified":1724900626988},{"_id":"public/images/20240712/image-20231001170909421.png","hash":"69ed2b69c1ec75c7ae21007e15084728b8a9b19b","modified":1724900626988},{"_id":"public/images/20240712/image-20231001173153802.png","hash":"9219ea62aef28eebe650a4c90b09b4b96d5388cf","modified":1724900626988},{"_id":"public/images/20240712/image-20231001173620154.png","hash":"f4e6ac47c4b4a7d2cf8272811ff88ded9ebedba8","modified":1724900626988},{"_id":"public/images/20240824/2024-08-27-14-21-28.png","hash":"07ad6430e0bbf135bf111a9ecdfb85d5267a385a","modified":1724900626988},{"_id":"public/images/20240824/subfigure.png","hash":"85009255dd38457574c9f0596f92021594734184","modified":1724900626988},{"_id":"public/images/20240712/image-20230930192855816.png","hash":"f9ed6dad1dfdd7a36492d950bf1a03513bd1ffba","modified":1724900626988},{"_id":"public/images/20240712/image-20231001151417317.png","hash":"574918d349973c6378f4e074f25947b5a0a8faf3","modified":1724900626988},{"_id":"public/images/20240712/image-20231001184526448.png","hash":"1344a3c20bf660ef99b97817aece8aab3a2b0658","modified":1724900626988},{"_id":"public/images/20240712/image-20231001192302431.png","hash":"f0aa7a9edcb6a5f43e329846023c2a84050c540f","modified":1724900626988},{"_id":"public/images/20240824/landscape_after.png","hash":"18da62260794f63d1c693a1117efe72145ed269f","modified":1724900626988},{"_id":"public/images/20240712/image-20230930192546137.png","hash":"243bb6abf19a86809139c055d931270847654c42","modified":1724900626988},{"_id":"public/images/20240712/image-20231001171701950.png","hash":"e4984503cdfb8b8f9c1d29f8d4332187a75c9c5b","modified":1724900626988}],"Category":[],"Data":[],"Page":[],"Post":[{"title":"写在第一篇","date":"2024-07-09T05:00:00.000Z","_content":"这是我的创建这个主页的第一篇blog。\n为什么创建这个博客呢?\n想了想, 大概是想让飞速流转的时光留下一些印记。\n我忽然想起来十二年前在家里, 我哥那时候就是我现在的年纪。\n一转眼, 他今年快四十岁。\n\n飞逝的时光不免让人有些难过, \n能在blog里面记录人的成长, \n仿佛是在时间长河里面保存几滴样本。 \n\n","source":"_posts/2024-07-09-hello_blog.md","raw":"---\ntitle: 写在第一篇\ntag: Others\ndate: 2024-07-09 13:00:00\n---\n这是我的创建这个主页的第一篇blog。\n为什么创建这个博客呢?\n想了想, 大概是想让飞速流转的时光留下一些印记。\n我忽然想起来十二年前在家里, 我哥那时候就是我现在的年纪。\n一转眼, 他今年快四十岁。\n\n飞逝的时光不免让人有些难过, \n能在blog里面记录人的成长, \n仿佛是在时间长河里面保存几滴样本。 \n\n","slug":"2024-07-09-hello_blog","published":1,"updated":"2024-08-18T02:40:31.169Z","comments":1,"layout":"post","photos":[],"_id":"cm0epapyk0000hjm1fk1bdvcy","content":"<p>这是我的创建这个主页的第一篇blog。<br>为什么创建这个博客呢?<br>想了想, 大概是想让飞速流转的时光留下一些印记。<br>我忽然想起来十二年前在家里, 我哥那时候就是我现在的年纪。<br>一转眼, 他今年快四十岁。</p>\n<p>飞逝的时光不免让人有些难过,<br>能在blog里面记录人的成长,<br>仿佛是在时间长河里面保存几滴样本。 </p>\n","excerpt":"","more":"<p>这是我的创建这个主页的第一篇blog。<br>为什么创建这个博客呢?<br>想了想, 大概是想让飞速流转的时光留下一些印记。<br>我忽然想起来十二年前在家里, 我哥那时候就是我现在的年纪。<br>一转眼, 他今年快四十岁。</p>\n<p>飞逝的时光不免让人有些难过,<br>能在blog里面记录人的成长,<br>仿佛是在时间长河里面保存几滴样本。 </p>\n"},{"title":"Matlab程序开发经验分享","date":"2024-07-12T04:00:00.000Z","_content":"\n记录在学校的一次matlab课上的技术分享。\n\n**前言**：本次分享主要内容是介绍一些常用的技术，目的是让大家了解遇到某种编程需求该怎么做，用什么方法解决什么问题。\n\n**假设**：各位已经掌握matlab的基本方法，并且自己也会写一些简单代码了。\n\n\n# 1. 代码优化\n\n**Q：为什么我的代码这么慢？**\n\n**A：解释型语言就是比编译型语言慢 + 代码未优化**\n\n## 1. 1 预分配内存\n\n在进行循环语句时，应当先声明变量所需空间的大小，再进行循环，避免每次循环向数组中增加数字。\n\n**不推荐写法**\n\n```matlab\ntic\nfor i = 1:1000\n\tmat(i,i) = i;\nend\ntoc\n% 历时 0.115061 秒。\n```\n\n**推荐写法**\n\n```matlab\ntic\nmat_2 = zeros(1000); % 先把数组的大小声明，在内存中开辟一块空间\nfor i = 1:1000\n\tmat_2(i,i) = i;\nend\ntoc\n% 历时 0.005585 秒。\n```\n\n**为什么出现这样的差异？**\n\n反复调整数组的大小将导致花费额外的时间找到更大的、**连续的**内存空间。\n\n**所有类型的变量都需要这样做吗**\n\n不一定，cell类型则不需要，但是放在cell中的数据类型可能需要。cell数组内存不连续，但是每个cell要求连续内存。（这也是看情况的，cell在编译成mex文件时，同样需要初始化内存）\n\n参考链接：\n\nhttps://ww2.mathworks.cn/help/matlab/matlab_prog/preallocating-arrays.html\n\nhttps://ww2.mathworks.cn/help/matlab/matlab_prog/techniques-for-improving-performance.html\n\nhttps://ww2.mathworks.cn/help/matlab/matlab_prog/avoid-unnecessary-copies-of-data.html\n\nhttps://ww2.mathworks.cn/help/matlab/matlab_prog/strategies-for-efficient-use-of-memory.html\n\n\n\n## 1. 2 向量化\n\n官方定义：\n\n> 修正基于循环且面向标量的代码以使用 MATLAB 矩阵和向量运算的过程称为***向量化***。\n\n简单来说，就是替代for循环做一些简单操作，以提高运行速度、可读性、正确性。即，算法流程控制`for`循环，简单操作向量化。\n\n**向量化是matlab的一个重要特点，这在其他语言很少出现**\n\n向量化的语句通常有底层的支持，利用到了CPU指令集进行优化，因此速度较快。\n\nfor循环遍历慢的原因是matlab为解释性语言。\n\n### 求1至10000的每个数的正弦的和\n\n**循环写法：**\n\n```matlab\ntic\nall_sum = 0;\nfor i = 1:1e4\n\tall_sum = all_sum + sin(i);\nend\ndisp(['all_sum: ', num2str(all_sum)])\ntoc\n% all_sum: 1.6339\n% 历时 0.038938 秒。\n```\n\n**向量化写法：**\n\n```matlab\ntic\nall_sum = sum(sin(1:1e4));\ndisp(['all_sum: ', num2str(all_sum)])\ntoc\n% all_sum: 1.6339\n% 历时 0.008211 秒。\n```\n\n为什么`all_sum`这么小？\n\n### 隐式扩展，求每个人每科成绩与平均值的差距\n\n```matlab\n% 每个人有三门课，\nA = [97 89 84; \n     95 82 92; \n     64 80 99;\n     76 77 67;\n     88 59 74; \n     78 66 87; \n     55 93 85];\t\t% 每一列是一个人\n```\n\n**循环写法**\n\n```matlab\nmA = mean(A);\t\t\t% 求每列的平均值\nB = zeros(size(A));\t\t% 记录每个人每门课的差距\nfor n = 1:size(A,2)\t\t% 对每一列进行操作\n    B(:,n) = A(:,n) - mA(n);\nend\n```\n\n**向量化写法**\n\n```\ndevA = A - mean(A)\n```\n\n注意，在向量化写法中，`mean(A)`的结果是1c 3大小的。即使 `A` 是一个 7×3 矩阵，`mean(A)` 是一个 1×3 向量，MATLAB 也会隐式扩展该向量，就好像其大小与矩阵相同一样，并且该运算将作为正常的按元素减法运算来执行。（广播操作）\n\n### 逻辑索引，线性索引，下标索引\n\n**介绍三种索引方式的区别**\n\n一个矩阵A ，寻找这个矩阵中大于500的数字的行列数\n\n**循环方法**（单个循环，获得线性索引，双层循环，获得行列数）\n\n```matlab\nA = magic(100);\ntic\nsub = zeros(sum(A>500, 'all'), 2);\ncount = 1;\nfor i = 1:100\n\tfor j = 1:100\n\t\tif A(i,j) > 500\n\t\t\tsub(count,:) = [i,j];\n\t\t\tcount = count + 1;\n\t\tend\n\tend\nend\ntoc\n```\n\n**find方法**\n\n```\nA = magic(100);\ntic\n[row, col] = find(A>500);\nsub = [row, col];\ntoc\n```\n\n**处处用find真的合适吗？**\n\n求矩阵A中，所有大于500的数的和\n\n`sum(A(find(A>500)))`线性索引\n<!-- ../images/20240712/image-20231001192302431.png -->\n![image-20230930182045754](../images/20240712/image-20230930182045754.png)\n\n`sum(A>500))`这里直接使用了逻辑索引\n\n**注意：在for循环中，尽量不用注意：在for 循环中，尽量不用find，有些慢。如果不得不使用for获取满足条件的索引，先记录线性索引，然后用ind2sub()函数转化**\n\n### 重复数组\n\n根据向量、矩阵创造大的矩阵\n\n```matlab\nA = repmat(1:3,5,2)\nB = repmat([1 2; 3 4],2,2)\n\n% A =\n\n%     1     2     3     1     2     3\n%     1     2     3     1     2     3\n%     1     2     3     1     2     3\n%     1     2     3     1     2     3\n%     1     2     3     1     2     3\n\n\n% B =\n\n%     1     2     1     2\n%     3     4     3     4\n%     1     2     1     2\n%     3     4     3     4\n```\n\n思考题：多个等间隔指针的轮盘赌如何向量化（随机遍历抽样，遗传算法中经常使用的一个选择方法）？\n\n参考链接：https://ww2.mathworks.cn/help/matlab/matlab_prog/vectorization.html\n\n## 1. 3 冗余运算\n\n消除for循环中的冗余运算有助于提升算法的性能。能放到外层的，就放到外层。\n\n给定一个矩阵A，要求A的每个数乘以当前行数，在加上当前列数，再加一个固定的数\n\n```matlab\nfor i = 1:size(A, 1) % 行\n\tfor j = 1:size(A, 2)\n\t\tfix = 1;\n\t\ttmp = A(i,j);\n\t\ttmp = tmp * i + j;\n\t\tA(i,j) = tmp + fix;\n\tend\nend\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n% fix 提出\nfix = 1;\nfor i = 1:size(A, 1) % 行\n\tfor j = 1:size(A, 2)\n\t\ttmp = A(i,j);\n\t\ttmp = tmp * i + j;\n\t\tA(i,j) = tmp + fix;\n\tend\nend\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nfix = 1;\nfor i = 1:size(A, 1) % 行\n\tA(i,:) = A(i,:) * i;\n\tfor j = 1:size(A, 2)\n\t\tA(i,j) = A(i,j) + j + fix;\n\tend\nend\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n% 向量化\nA = (1:size(A, 1))' .* A + (1:size(A, 2)) + fix\n```\n\n\n\n## 1. 4 性能分析\n\n**我的代码怎么这么慢？想改，改什么呢？**\n\n这个时候，需要使用探查器进行代码性能分析\n\n比如对debug.m脚本（模拟禁忌搜索的过程）进行性能分析：\n\n```matlab\n% debug.m\n% 模拟禁忌搜索的过程\ntic\ntabu = zeros(30, 2);\nfor i = 1:1e5\n    rand_int = [randi(15), randi(15)];\n    if ismember(rand_int, tabu, \"rows\")\n        continue\n    else\n        tabu = [rand_int; tabu(1:end-1, :)];\n    end\nend\ntoc\n```\n\n**Step 1. 打开探查器**\n\n![image-20230930192441679](../images/20240712/image-20230930192441679.png)\n\n**Step 2. 在探查器中运行代码**\n\n![image-20230930192625728](../images/20240712/image-20230930192625728.png)\n\n**Step 3. 点击函数名称 获得具体情况**\n\n![image-20230930192855816](../images/20240712/image-20230930192855816.png)\n\n发现原来是`ismember`函数运行太慢了，所以根据问题特性，我们自己写一个`my_ismember`函数，替换原有的`ismember`函数。\n\n原`ismember`函数耗时4.931秒，自己写的`my_ismember`函数耗时0.937秒。\n\n![image-20230930194758499](../images/20240712/image-20230930194758499.png)\n\n上述例子说明：\n\n- 不一定内置函数就足够好，一些函数内置函数为了支持各种数据类型、大小，还是很慢的\n\n- 根据问题、数据结果特征进行重构\n\n  ```matlab\n  function flag = my_ismember(a, b)\n  % 判断a是否在b中\n  \n  validateattributes(a, {'numeric'}, {'size',[1,2]})\n  validateattributes(b, {'numeric'}, {'size',[nan,2]})\n  \n  col_1_flag = b(:, 1) == a(1);\n  col_2_flag = b(:, 2) == a(2);\n  \n  if any(col_1_flag & col_2_flag)\n      flag = true;\n  else\n      flag = false;\n  end\n  end\n  ```\n\n  **注意：** 探查器中运行的代码速度包括了统计时间，因此比一般方式下运行更慢。\n  \n  参考：https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html\n\n## 1. 5 使用更具效率的算法\n\n有些时候，真正慢的是使用的算法的复杂度很高（{% katex %}O(n^2){% endkatex %}甚至{% katex %}O(n^3){% endkatex %}, 或者说是算法过于朴素），跟向量化等上述技术无关。这种慢根源于算法的复杂度，解决方法是换个思路重写。\n\n### 双数之和\n\n给定一个整数数组 `nums` 和一个整数目标值 `target`，请你在该数组中找出 **和为目标值** *`target`* 的那 **两个** 整数，并返回它们的数组下标。\n\n```matlab\n% 输入：nums = [2,7,11,15], target = 9\n% 输出：[0,1]\n% 解释：因为 nums[0] + nums[1] == 9 ，返回 [0, 1] 。\n\n% 随机构造\nrng(pi);\nnums = [2,7,11,15];\nrand_num = randperm(5e4) + 20;\nnums = [nums, randperm(5e4) + 20];\n\nnums = nums(randperm(length(nums))); % nums长度为50004 \ntarget = 9;\n\ntic\ntwo_sum(nums, target)\ntoc\n% ans =\n%       36335       36975\n% 历时 4.324590 秒。\n\ntic\ntwo_sum_hash(nums, target)\ntoc\n% ans = \n%       36335       36975\n% 历时 0.020854 秒。\n\n%  足足200倍速度差距\n```\n\n**暴力枚举（朴素）算法**\n\n```matlab\nfunction output = two_sum(nums, target)\n% O(N^2)\nlen_num = length(nums);\nfor i = 1:len_num\n    for j = 1:len_num\n        if i == j\n            continue\n        end\n\n        if nums(i) + nums(j) == target\n            output = [i,j];\n            return\n        end\n    end\nend\nend\n```\n\n**字典 - 空间换时间**\n\n```matlab\nfunction output = two_sum_hash(nums, target)\n% 该代码使用了dictionary()， 仅支持2022b以上版本\n% O(NlogN)\nlen_num = length(nums);\nd = dictionary(nums, 1:len_num);\nfor i = 1:len_num\n    val_1 = nums(i);\n    val_2 = target - val_1;\n    if isKey(d, val_2) && d(val_2) ~= i\n        output = [d(val_2), i];\n    end\nend\nend\n```\n\n\n\n# 2. <font color=\"#dd0000\">工具箱</font>\n\n## 2.1 Coder\n\nMatlab和python一样是一门解释性语言，因此运行速度不如编译型语言（C++等），因此一些复杂的函数运行起来相对较慢。\n\n不过，Matlab Coder提供了一种方法，使得我们可以将一个函数编译成C或C++或二进制文件，供Matlab使用。步骤如下：\n\n你需要一个Matlab  Coder工具箱。如果没有，则在附加功能中获取。在顶部APP中打开Coder。\n\n![image-20231001134101744](../images/20240712/image-20231001134101744.png)\n\n![image-20231001134208296](../images/20240712/image-20231001134208296.png)\n\n- **进入Select环节**：键入你想编译的函数，注意只能是函数，不能是脚本。这里以`lagrangian_relax`函数为例，然后点击next。![image-20231001134303941](../images/20240712/image-20231001134303941.png)\n- **进入 review环节**：在这个环节，Coder会检查你的代码有无问题，这个步骤会检查`lagrangian_relax`函数调用的所有函数。![image-20231001134944337](../images/20240712/image-20231001134944337.png)\n\n在底部出现了一条警告，此时应注意，警告和错误是不同的，程序可以有警告（前提是已知警告产生的原因和后果），错误则不同。错误将直接导致程序运行不通。\n\n解决完所有问题后，点Next。\n\n- **进入Define环节：**该环节定义了所有变量的类型&大小。\n\n  ![image-20231001135319241](../images/20240712/image-20231001135319241.png)\n\n  在上方的框中，输入调用`lagrangian_relax`函数的脚本，然后点`Autodefine Input Types`按钮，等程序运行，所有的变量的大小自动确定。**但是**，自动确定的变量大小类型是固定的，也就是说只能输入这种大小的数据，所以，对一些不确定大小的数据，需要手动将大小调整成inf。点Next，继续。\n\n- **进入 check环节**：Coder会运行之前输入的脚本，检查是否有运行问题、编译问题等等。这一步可能会出现各种报错，这些报错的原因并不是`lagrangian_relax`函数的结果有问题，而是写脚本的习惯超出编译器可理解的范围，或者编译器认为写的不严谨，数据类型/大小匹配等一系列问题。需要逐个修改，直至通过编译。\n\n![image-20231001140304900](../images/20240712/image-20231001140304900.png)\n\n- **进入 generate环节**：如果仅仅想在matlab中调用编译好的二进制文件提升运行速度，那么选择mex即可，点Geneate等待生成。\n\n  ![image-20231001140519650](../images/20240712/image-20231001140519650.png)\n\n- **完成**\n  ![image-20231001140532936](../images/20240712/image-20231001140532936.png)\n\n\n\n接下来，我们就可以像使用一个普通函数一样使用这个mex文件了。\n\n```matlab\ntic\nlagrangian_relax_mex(data, super_cus, param); % 生成的mex文件\ntoc\n% Iter:  25; LB:    32233.19; UB*:   42478.36; Cons: 2.000000; Gap:  24.12 % \n% LR finish: max iteration\n% 历时 3.555206 秒。\n\n\ntic\nlagrangian_relax(data, super_cus, param); % 原来的函数\ntoc\n% Iter:  25; LB:    32233.19; UB*:   42478.36; Cons: 2.000000; Gap:  24.12 % \n% LR finish: max iteration\n% 历时 93.820573 秒。\n```\n\n可以观察到，两种方法输出的结果是一样的，但是速度差了30倍。\n\n**Coder的缺点：**\n\n- 并不是所有内置函数都支持Coder的，例如dictionary就不支持。不支持的函数会在编译时报错。\n\n- Coder编译的文件来源于选择的C++编译器，很可能出现mex文件在另一台电脑上无法运行的情况。\n\n- Coder编译的文件的另一个问题是不能跨平台，mac/win/linux编译得到的文件时不同的。\n\n参考链接：[通过生成 MEX 函数加快 MATLAB 算法的执行速度](https://ww2.mathworks.cn/help/releases/R2020b/coder/gs/generating-mex-functions-from-matlab-code-at-the-command-line.html)\n\n​\t\t\t\t\t[从 MATLAB 代码生成 C 和 C++ 代码](https://ww2.mathworks.cn/products/matlab-coder.html)\n\n​\t\t\t\t\t[MATLAB Coder入门到放弃](https://zhuanlan.zhihu.com/p/604283307)\n\n​\t\t\t\t\thttps://blog.csdn.net/qq_36584460/article/details/110791330\t\n\n**（实操环节），编译一个mex文件并运行**\n\n\n## 2. 2 parallel computing toolbox\n\n前面提到过利用多核心进行并行计算，需要并行计算工具箱。\n\n> 该工具箱通过在本地运行的 worker（MATLAB 计算引擎）上执行应用程序，允许你充分利用多核台式机的处理能力。无需更改代码，即可在集群或云上运行同一个应用程序。还可以将该工具箱与 MATLAB Parallel Server 结合使用，以执行由于太大而无法装入单台机器内存的矩阵计算\n\n### 并行for循环\n\n```matlab\ntic\nn = 200;\nA = 500;\na = zeros(1,n);\nfor i = 1:n\n    a(i) = max(abs(eig(rand(A))));\nend\ntoc\n% 历时 37.256415 秒。\n```\n\n```matlab\ntic\nn = 200;\nA = 500;\na = zeros(1,n);\nparfor i = 1:n\n    a(i) = max(abs(eig(rand(A)))); % 最大 / 绝对 / 特征值 / 随机\nend\ntoc\n% 历时 8.028954 秒。\n```\n\n使用场景：许多简单计算的循环，parfor将循环划分为组，以便每个线程可以执行一组。\n\n**但是，**循环中一组循环的结果依赖前面某次循环的结果时，不能使用并行计算（归约[Reduction Variables](https://ww2.mathworks.cn/help/parallel-computing/reduction-variable.html)除外）。并行计算有一系列局限性，而且在一些情况下（例如，广播变量）并不能加速代码运行。\n\n**使用`parfor`的情况：**\n\n- 每次的for循环很慢（单个时间长）\n- 简单计算的多次循环（单个时间短但是数量多）\n- 多层for嵌套的外层使用parfor更具收益（**思考：为什么？**）\n\n**不推荐用`parfor`的情况：**\n\n- 已经将for向量化的情况（向量化比parfor收益更高）\n- 循环已经很快了（并行化的时间开销更高，包括初始化，分配等）\n\n**强烈反对的情况：**\n\n- 向量化 -> for循环 -> parfor循环 （反向优化）\n\n**`for`转`parfor`的一个不可行举例**\n\n![image-20231001201801595](../images/20240712/image-20231001201801595.png)\n\nfor转parfor一定程度上很复杂，有各式各样的规则限制、写法限制，这里只做一个简单介绍。关于什么时候用parfor，如何将for转为parfor，使用parfor的要求，常见问题等，参见[parfor文档](https://ww2.mathworks.cn/help/parallel-computing/parallel-for-loops-parfor.html?s_tid=CRUX_lftnav)。\n\n参考链接：[在多核计算机、GPU 和集群上执行并行计算](https://ww2.mathworks.cn/products/parallel-computing.html)\n\n**补充：parfor可以和coder结合使用，生成的mex文件也是支持多核计算的**\n\n## 2. 3 Symbolic Math Toolbox\n\n符号计算工具箱，就是能计算数学公式的一个工具箱，变量不再是数值而是符号。因此可以求计算**定积分**和**不定积分**的**解析解**，计算符号表达式或函数的**导数**，并使用级数展开式逼近函数，等等。\n\n例如，求{% katex %} \\int_a^b \\sin x dx{% endkatex %}在{% katex %}[\\frac{\\pi}{2}, \\frac{3\\pi}{2}]{% endkatex %}上的积分\n\n```matlab\nsyms x\nint(sin(x),pi/2,3*pi/2)\n% ans = 0\n```\n\n这只是一个简单的例子，表示我们可以使用matlab做这件事，具体应用：\n\n**某博弈论问题求纳什均衡点**\n\n解方程组：\n\n![image-20231001203458641](../images/20240712/image-20240712115425.png)\n\n\n解得四个解中的一个解为纳什均衡点。\n\n![image-20231001151417317](../images/20240712/image-20231001151417317.png)\n\n**纳什均衡点{% katex %}E_4{% endkatex %}的雅克比矩阵**\n\n![image-20231001151523651](../images/20240712/image-20231001151523651.png)\n\n**注：符号计算工具箱不支持coder**\n\n如何查看是否支持 coder？详见函数参考文档的底部支持列表\n\n# 3. 技巧经验\n\n## 3. 1 使用结构体进行传参\n\n假设你有一辆车，车长4米，平时跑72km/h，车重1000kg，载重2000kg，现在你写了一个函数`f`用于估计油耗。\n\n```matlab\nfunction consume = f(len, velocity, weight, capacity)\n\t...\nend\n```\n\n使用结构体封装一下\n\n```matlab\nvehicle = struct()\nvehicle.len = 4;\nvehicle.velocity = 72;\nvehicle.weight = 1000;\nvehicle.capacity = 2000;\n\nfunction consume = f(vehicle)\n\t...\nend\n```\n\n包括传出，也可以使用结构体，解决了参数记错的问题。\n\nconsume = [1, 2, 3, 4]\n\nconsume. air = 1; % 空气阻力产生的燃料消耗\n\nconsume.weight = 2; % 重量产生的消耗\n\n...\n\n给名字就不容易错了，比consume(1) consume(2) 这种要方便\n\n\n\n## 3.2 使用句柄函数@\n\n### `C = bsxfun(fun,A,B)` \n\nBinary Singleton Expansion Function\n\n对数组 `A` 和 `B` 应用函数句柄 `fun` 指定的按元素二元运算。\n\n```matlab\nA = [8; 17; 20; 24]\nB = [0 10 21]\nC = bsxfun(@gt,A,B)\n\n% C = 4x3 logical array\n\n%    1   0   0\n%    1   1   0\n%    1   1   0\n%    1   1   1\n\n```\n\n其中`@gt`的意思是大于\"greater than\"， 因此生成了隐式扩展结果。\n\n接下来，给定一个向量`a`和一个向量`b`，求{% katex %}a-e^b{% endkatex %}的所有组合的结果。\n\n```matlab\na = [1 2 3 4];\nb = [5; 6; 7];\n\n% 第一种方法\nc = zeros(length(b), length(a));\nfor i = 1:length(a)\n\tfor j = 1:length(b)\n\t\tc(j,i) = a(i) - exp(b(j));\n\tend\nend\ndisp(c)\n\n% 第二种方法\nf = @(a, b) a - exp(b);\nc = bsxfun(f, a, b);\ndisp(c)\n```\n\n### `A = cellfun(func, C)`\n\n 对元胞数组`C`的每个元胞进行操作。\n\n获取元胞数组中，每个元胞的大小\n\n```matlab\nC = cell(3, 1);\nC{1,1} = 'Sunday';\nC{2,1} = magic(3);\nC{3,1} = 1:10;\n\n% 循环操作\nA = zeros(size(C, 1), 1);\nfor i = 1:size(C, 1)\n\tA(i) = length(C{i,1}(:));\nend\ndisp(A)\n% [6; 9; 10]\n\n% cellfun\nA = cellfun(@(x) length(x(:)), C)\n% [6; 9; 10]\n\n```\n\n### `A = structfun(func, S)`\n\n对标量结构体的每个字段应用函数\n\n```matlab\nS.f1 = 1:10;\nS.f2 = [2; 4; 6];\nS.f3 = []\n\nA = structfun(@mean,S)\n% A = 3×1\n\n%     5.5000\n%     4.0000\n%        NaN\n```\n\n## 3. 3 运行日志\n\n将命令行窗口文本记录到日志文件中\n\n```matlab\ndiary 'myDiaryFile.txt'\n\nfor i = 1:10\n\tdisp(exp(i))\nend\n\ndiary off\n```\n\n你就会得到一个`myDiaryFile.txt`文件，用于记录所有打印的结果。\n\n用处：追踪程序运行状况，运行到哪次迭代？运行到哪一步？配合其他函数，还可以记录何时运行等信息。\n\n## 3.4 格式化输出\n\n格式化字符串\n\n```matlab\nformatSpec = 'The array is %dx%d.';\nA1 = 2;\nA2 = 3;\nstr = sprintf(formatSpec,A1,A2)\n% str = \n% 'The array is 2x3.'\n\nfprint(formatSpec,A1,A2)\n% 'The array is 2x3.'\n```\n\n参考： https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html\n\n有什么用？多次运行一个函数，但是输入参数不同时，配合`diary`函数可生成结果日志\n\n![image-20231001164150891](../images/20240712/image-20231001164150891.png)\n\n解放双手，从自动运行做起，拒绝**手动保存**每次的运行结果。\n\n## 3.5 运行时间\n\n想要获取运行了多久？使用`tic`和`toc`函数统计代码运行时间。\n\n高级用法：使用多个tic测量时间\n\n```matlab\ntStart = tic;           % pair 2: tic\nn = 10;\nT = zeros(1,n);\nfor i = 1:n\n    A = rand(12000,4400);\n    B = rand(12000,4400);\n    tic         % pair 1: tic\n    C = A.*B;\n    T(i)= toc;  % pair 1: toc\nend\ntMul = sum(T) % tMul = 0.6037\ntEnd = toc(tStart) % tEnd = 11.6301\n```\n\n其他统计代码运行时长的方法：\n\n[t = cputime](https://ww2.mathworks.cn/help/releases/R2023b/matlab/ref/cputime.html?)\n\n[t = datetime](https://www.mathworks.com/help/releases/R2023b/matlab/ref/datetime.html?searchHighlight=datetime&s_tid=doc_srchtitle#d126e310370)\n\n## 3.6 多层嵌套\n\n看这样一个代码，每月每天你孤单会想起谁：\n\n```matlab\nfor month = 1:12  % 月\n\tfor day = 1:30 % 天\n\t\tif 孤单？\n\t\t\t你想起一个人\n\t\t\tif 想找个人来陪\n\t\t\t\t找！\n\t\t\tend\n\t\tend\n\tend\nend\n```\n\n上述代码的问题：嵌套太多了，一层一层的嵌套。（写代码的习惯，不影响执行效率，但是影响可读性）\n\n```matlab\nfor month = 1:12  % 月\n\tfor day = 1:30 % 天\n\t\tif ~ 孤单？ % 非孤单 \"~\"取反\n\t\t\tcontinue\n\t\tend\n\t\t\n\t\t你想起一个人\n\t\tif 想找个人来陪\n\t\t\t找！\n\t\tend\n\tend\nend\n```\n\n使用continue关键字跳转，避免嵌套，提升可读性\n\n## 3.7 Latex公式\n\nlatex是特别常用且提升效率的公式编辑方法，推荐大家使用！\n\n好处：输入公式时，手不再使用鼠标，全键盘操作\n\n可以使用的场景：\n\n- word\n- markdown\n- latex\n- mathtype\n- matlab\n- ...\n\n## 3.8 实时脚本做展示\n\n一般不用这个功能做开发，但是实时脚本是良好的展示工具\n\n类似于 python 的 jupyter notebook\n\n![image-20231006133646069](../images/20240712/image-20231006133646069.png)\n\n## 3.9 数值精度问题\n\n数值精度问题普遍存在于计算机语言中，我们不讨论产生数值精度的具体原因，只需要知道存在这样的问题。\n\n例如：\n\n```matlab\n0.1 + 0.2 == 0.3\n\n% ans =\n\n%  logical\n\n%   0\n\n```\n\n在for循环中，需要避免以下的情况\n\n```matlab\nfor i = 0.0:0.1:1.0\n    disp('-------------------')\n    for j = 0.0:0.1:1.0-i\n        k = 1.0 - i - j;\n        disp([i,j,k])\n    end\nend\n\n% -------------------\n%    0.7000         0    0.3000\n%    0.7000    0.1000    0.2000\n%    0.7000    0.2000    0.1000\n%    0.7000    0.3000   -0.0000\n```\n\n出现一个非常小的负数，极有可能导致bug\n\n```matlab\nfor i = 0:10\n    disp('-------------------')\n    for j = 0:(10-i)\n        k = 10 - i - j;\n        disp([i,j,k] / 10)\n    end\nend\n\n-------------------\n    0.7000         0    0.3000\n\n    0.7000    0.1000    0.2000\n\n    0.7000    0.2000    0.1000\n\n    0.7000    0.3000         0\n\n```\n\n\n\n## 3.10 在线Matlab\n\n电脑没有matlab？只要有许可证，就能使用matlab在线编程（https://ww2.mathworks.cn/products/matlab-online.html）。\n\n## 3.11 Markdown语言\n\n本文档就是使用的markdown编写的，这是一种文本标记语言，实现文本的不同格式、样式。\n\n# 4. 如何DEBUG\n\n## 4.1 断点\n\n调试程序是每个编程语言必备的操作，没有人能完美写完一个复杂的代码并且没有任何小错误。当这些错误直观发现不了时，使用断点追踪程序每步的运算有助于发现问题。\n\n![image-20231001165505931](../images/20240712/image-20231001165505931.png)\n\n## 4.2 条件断点\n\n例如在这个循环中，每次`j=3`时就报错，我们增加一个条件断点，当满足这个条件时，程序暂停。\n\n![image-20231001165725593](../images/20240712/image-20231001165725593.png)\n\n![image-20231001165858415](../images/20240712/image-20231001165858415.png)\n\n## 4.3 错误暂停\n\n![image-20231001165922621](../images/20240712/image-20231001165922621.png)\n\n建议把出现错误暂停勾选，这样程序会停止在出错的哪一行，有助于分析/复现问题。\n\n![image-20231001165952424](../images/20240712/image-20231001165952424.png)\n\n## 4.4 搜索问题\n\n当一个问题，自己不能解决的时候，我们通常会使用搜索引擎进行检索，如何获得问题的答案？\n\n例如：\n\n> 我想删除一个cell数组中空的元胞，保留下非空的元胞\n\n一般我会用 “语言 + 关键词 ”搜索\n\n- 搜索方法：`MATLAB cell删除空元胞`\n\n- 结果质量：\n  - Matlab中文论坛 / 知乎 / 博客园 \n  - CSDN（垃圾堆里找吃的，但不代表都是垃圾） / 简书\n  - 百度知道 （几乎驴唇不对马嘴） / 其他小网站\n\n![image-20231001170909421](../images/20240712/image-20231001170909421.png)\n\n## 4. 5 <font color=\"#dd0000\">向他人提问</font>\n\n向他人提问，包括同学、老师、网友等。\n\n为什么向他人提问很重要？正确的提问方式有助于提升双方沟通效率，快速发现问题。\n\n**错误的提问方式**\n\n1. 不会截图 用手机拍照的\n\n<img src=\"https://img-blog.csdnimg.cn/975ac90367e0403bb704c1785dd9c27b.jpg?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5b6h6aOOQk_lsJE=,size_20,color_FFFFFF,t_70,g_se,x_16\" alt=\"img\" style=\"zoom: 50%;\" />\n\n2. 截图截一半 只截图报错信息traceback， 不截图代码的\n\n   ![image-20231001171745717](../images/20240712/image-20231001171745717.png)\n\n3. 不截图前后文的\n\n   > 为什么我这句代码报错了？\n\n   ![image-20231001172136136](../images/20240712/image-20231001172136136.png)\n\n4. 自己不思考、不检索，直接问别人的。\n\n   > 我想删除一个cell数组中空的元胞，保留下非空的元胞，matlab怎么写？\n\n**正确的提问方式**（不仅适用于代码提问）\n\n- 尽可能详细说出你的问题\n\n- 提供代码（如果是截图，截图要全面）\n\n- 问题如何复现\n\n- 你已经做了什么操作，但是还是不行\n\n- 发送之前读一读你的提问\n\n  举例 1：\n\n  ![image-20231001172945916](../images/20240712/image-20231001172945916.png)\n\n  举例 2：![image-20231001173153802](../images/20240712/image-20231001173153802.png)\n\n## 4. 6 文档\n\n如果你知道matlab的某个函数的名字，但是不会写，那么可以在matlab右上角搜索文档，也可以在命令行中使用`help 'fun_name'`获得文档。\n\n![image-20231001173452560](../images/20240712/image-20231001173452560.png)\n\n此外，在命令行中输入`doc 'fun_name'`可以打开在线文档。\n\n```matlab\ndoc zeros\n```\n\n![image-20231001173620154](../images/20240712/image-20231001173620154.png)\n\n# 5. <font color=\"#dd0000\">外部功能</font>\n\n## 5.1 Python\n\n很多时候，我们发现某个功能只在python中有，matlab中没有或者不如python好用。\n\n这个时候，我们可以写一个python函数，然后让matlab调用这个py函数，再将结果处理成matlab可接收的类型即可。\n\n举例来说，Gurobi对Python支持远远比matlab好，建模也更加方便，我们可以使用matlab调用python，python调用gurobi来实现：\n\n首先，我们写一个python调用gurobi的函数`grbpy_v.py`\n\n```python\n# grbpy_v.py\nimport gurobipy as gp\nimport numpy as np\nimport math\n\ndef model(f, alpha, beta, gamma, mu, kappa):\n    # 集合\n    I = range(len(f))\n    P = range(len(alpha[0]))\n    N = range(len(gamma[0]))\n    M = range(len(beta[0]))\n\n    # 建模\n    model = gp.Model()\n\n    # 变量\n    v = model.addVars((i for i in I), vtype = gp.GRB.BINARY, name ='v')\n\n    # 目标\n    obj = gp.quicksum((f[i] - gp.quicksum(alpha[i,p] for p in P) \\\n                            - gp.quicksum(beta[i,m] - mu[i,m] for m in M)\\\n                            - gp.quicksum(gamma[i,n] - kappa[i,n] for n in N)) * v[i] for i in I) \\\n        - gp.quicksum(mu[i,m] for i in I for m in M) \\\n        - gp.quicksum(kappa[i,n] for i in I for n in N)\n    model.setObjective(obj, sense = gp.GRB.MINIMIZE)\n    \n    # 约束\n    # 无\n\n    # 求解\n    model.Params.OutputFlag = 0\n    model.Params.MIPGap = 0.01\n    model.optimize()\n\n    # 整理\n    loc = np.zeros([1,len(f)])\n    for i in I:\n        if math.isclose(v[i].X, 1):\n            loc[0,i] = 1\n\n    obj_val = model.getAttr('ObjVal')\n\n    return (loc, obj_val)\n\n```\n\n然后，我们写一个matlab脚本（函数）调用这个py函数\n\n```matlab\npy.importlib.reload(py.importlib.import_module('grbpy_v'));\n\nfix_ws_py = py.numpy.array(fixed_ws);\nalpha_py  = py.numpy.array(alpha);\nbeta_py   = py.numpy.array(beta);\nmu_py     = py.numpy.array(mu);\ngamma_py  = py.numpy.array(gamma);\nkappa_py  = py.numpy.array(kappa);\n\nres = py.grbpy_v.model(fix_ws_py, alpha_py, beta_py, gamma_py, mu_py, kappa_py);\n```\n\n注意上述存在类型转换，需要把matlab的矩阵转成python的numpy矩阵才可以使用。\n\n参考：[从 MATLAB 中调用 Python](https://www.mathworks.com/help/releases/R2023b/matlab/call-python-libraries.html?s_tid=doc_srchtitle)\n\n## 5. 2 Gurobi （运筹）\n\nGurobi是一款求解器，做运筹优化方面常常会用到，这里将介绍直接使用matlab调用gurobi，不借助其他软件或包。\n\n来源于Guorbi官方文档：\n\n```matlab\nfunction facility()\n\n% Copyright 2023, Gurobi Optimization, LLC\n%\n% Facility location: a company currently ships its product from 5 plants\n% to 4 warehouses. It is considering closing some plants to reduce\n% costs. What plant(s) should the company close, in order to minimize\n% transportation and fixed costs?\n%\n% Note that this example uses lists instead of dictionaries.  Since\n% it does not work with sparse data, lists are a reasonable option.\n%\n% Based on an example from Frontline Systems:\n%   http://www.solver.com/disfacility.htm\n% Used with permission.\n\n% define primitive data\nnPlants     = 5;\nnWarehouses = 4;\n% Warehouse demand in thousands of units\nDemand      = [15; 18; 14; 20];\n% Plant capacity in thousands of units\nCapacity    = [20; 22; 17; 19; 18];\n% Fixed costs for each plant\nFixedCosts  = [12000; 15000; 17000; 13000; 16000];\n% Transportation costs per thousand units\nTransCosts  = [\n    4000; 2000; 3000; 2500; 4500;\n    2500; 2600; 3400; 3000; 4000;\n    1200; 1800; 2600; 4100; 3000;\n    2200; 2600; 3100; 3700; 3200];\n\n% Index helper function\nflowidx = @(w, p) nPlants * w + p;\n\n% Build model\nmodel.modelname = 'facility';\nmodel.modelsense = 'min';\n\n% Set data for variables\nncol = nPlants + nPlants * nWarehouses;\nmodel.lb    = zeros(ncol, 1);\nmodel.ub    = [ones(nPlants, 1); inf(nPlants * nWarehouses, 1)];\nmodel.obj   = [FixedCosts; TransCosts];\nmodel.vtype = [repmat('B', nPlants, 1); repmat('C', nPlants * nWarehouses, 1)];\n\nfor p = 1:nPlants\n    model.varnames{p} = sprintf('Open%d', p);\nend\n\nfor w = 1:nWarehouses\n    for p = 1:nPlants\n        v = flowidx(w, p);\n        model.varnames{v} = sprintf('Trans%d,%d', w, p);\n    end\nend\n\n% Set data for constraints and matrix\nnrow = nPlants + nWarehouses;\nmodel.A     = sparse(nrow, ncol);\nmodel.rhs   = [zeros(nPlants, 1); Demand];\nmodel.sense = [repmat('<', nPlants, 1); repmat('=', nWarehouses, 1)];\n\n% Production constraints\nfor p = 1:nPlants\n    for w = 1:nWarehouses\n        model.A(p, p) = -Capacity(p);\n        model.A(p, flowidx(w, p)) = 1.0;\n    end\n    model.constrnames{p} = sprintf('Capacity%d', p);\nend\n\n% Demand constraints\nfor w = 1:nWarehouses\n    for p = 1:nPlants\n        model.A(nPlants+w, flowidx(w, p)) = 1.0;\n    end\n    model.constrnames{nPlants+w} = sprintf('Demand%d', w);\nend\n\n% Save model\ngurobi_write(model,'facility_m.lp');\n\n% Guess at the starting point: close the plant with the highest fixed\n% costs; open all others first open all plants\nmodel.start = [ones(nPlants, 1); inf(nPlants * nWarehouses, 1)];\n[~, idx] = max(FixedCosts);\nmodel.start(idx) = 0;\n\n% Set parameters\nparams.method = 2;\n\n% Optimize\nres = gurobi(model, params);\n\n% Print solution\nif strcmp(res.status, 'OPTIMAL')\n    fprintf('\\nTotal Costs: %g\\n', res.objval);\n    fprintf('solution:\\n');\n    for p = 1:nPlants\n        if res.x(p) > 0.99\n            fprintf('Plant %d open:\\n', p);\n        end\n        for w = 1:nWarehouses\n            if res.x(flowidx(w, p)) > 0.0001\n                fprintf('  Transport %g units to warehouse %d\\n', res.x(flowidx(w, p)), w);\n            end\n        end\n    end\nelse\n    fprintf('\\n No solution\\n');\nend\n\nend\n\n```\n\n想表达的是，gurobi对matlab很不友好：\n\n- 系数矩阵必须是自己算明白索引后，转换为一个稀疏矩阵。\n- 很难按照约束一条一条添加\n- 有些gurobi功能matlab不能使用\n\n同样模型，python的版本\n\n```python\n#!/usr/bin/env python3.7\n\n# Copyright 2023, Gurobi Optimization, LLC\n\n# Facility location: a company currently ships its product from 5 plants\n# to 4 warehouses. It is considering closing some plants to reduce\n# costs. What plant(s) should the company close, in order to minimize\n# transportation and fixed costs?\n#\n# Note that this example uses lists instead of dictionaries.  Since\n# it does not work with sparse data, lists are a reasonable option.\n#\n# Based on an example from Frontline Systems:\n#   http://www.solver.com/disfacility.htm\n# Used with permission.\n\nimport gurobipy as gp\nfrom gurobipy import GRB\n\n\n# Warehouse demand in thousands of units\ndemand = [15, 18, 14, 20]\n\n# Plant capacity in thousands of units\ncapacity = [20, 22, 17, 19, 18]\n\n# Fixed costs for each plant\nfixedCosts = [12000, 15000, 17000, 13000, 16000]\n\n# Transportation costs per thousand units\ntransCosts = [[4000, 2000, 3000, 2500, 4500],\n              [2500, 2600, 3400, 3000, 4000],\n              [1200, 1800, 2600, 4100, 3000],\n              [2200, 2600, 3100, 3700, 3200]]\n\n# Range of plants and warehouses\nplants = range(len(capacity))\nwarehouses = range(len(demand))\n\n# Model\nm = gp.Model(\"facility\")\n\n# Plant open decision variables: open[p] == 1 if plant p is open.\nopen = m.addVars(plants,\n                 vtype=GRB.BINARY,\n                 obj=fixedCosts,\n                 name=\"open\")\n\n# Transportation decision variables: transport[w,p] captures the\n# optimal quantity to transport to warehouse w from plant p\ntransport = m.addVars(warehouses, plants, obj=transCosts, name=\"trans\")\n\n# You could use Python looping constructs and m.addVar() to create\n# these decision variables instead.  The following would be equivalent\n# to the preceding two statements...\n#\n# open = []\n# for p in plants:\n#     open.append(m.addVar(vtype=GRB.BINARY,\n#                          obj=fixedCosts[p],\n#                          name=\"open[%d]\" % p))\n#\n# transport = []\n# for w in warehouses:\n#     transport.append([])\n#     for p in plants:\n#         transport[w].append(m.addVar(obj=transCosts[w][p],\n#                                      name=\"trans[%d,%d]\" % (w, p)))\n\n# The objective is to minimize the total fixed and variable costs\nm.ModelSense = GRB.MINIMIZE\n\n# Production constraints\n# Note that the right-hand limit sets the production to zero if the plant\n# is closed\nm.addConstrs(\n    (transport.sum('*', p) <= capacity[p]*open[p] for p in plants), \"Capacity\")\n\n# Using Python looping constructs, the preceding would be...\n#\n# for p in plants:\n#     m.addConstr(sum(transport[w][p] for w in warehouses)\n#                 <= capacity[p] * open[p], \"Capacity[%d]\" % p)\n\n# Demand constraints\nm.addConstrs(\n    (transport.sum(w) == demand[w] for w in warehouses),\n    \"Demand\")\n\n# ... and the preceding would be ...\n# for w in warehouses:\n#     m.addConstr(sum(transport[w][p] for p in plants) == demand[w],\n#                 \"Demand[%d]\" % w)\n\n# Save model\nm.write('facilityPY.lp')\n\n# Guess at the starting point: close the plant with the highest fixed costs;\n# open all others\n\n# First open all plants\nfor p in plants:\n    open[p].Start = 1.0\n\n# Now close the plant with the highest fixed cost\nprint('Initial guess:')\nmaxFixed = max(fixedCosts)\nfor p in plants:\n    if fixedCosts[p] == maxFixed:\n        open[p].Start = 0.0\n        print('Closing plant %s' % p)\n        break\nprint('')\n\n# Use barrier to solve root relaxation\nm.Params.Method = 2\n\n# Solve\nm.optimize()\n\n# Print solution\nprint('\\nTOTAL COSTS: %g' % m.ObjVal)\nprint('SOLUTION:')\nfor p in plants:\n    if open[p].X > 0.99:\n        print('Plant %s open' % p)\n        for w in warehouses:\n            if transport[w, p].X > 0:\n                print('  Transport %g units to warehouse %s' %\n                      (transport[w, p].X, w))\n    else:\n        print('Plant %s closed!' % p)\n\n```\n\n\n\n## 5.3 Yalmip （运筹）\n\nyalmip是一款基于matlab进行数学建模的包，或者说是一种基于matlab的建模语言，使用yalmip的好处是解决了matlab建模的痛点，并且可以调用多个求解器对模型进行求解。\n\n然而，求解器方面，如果用gurobi / COPT，则一般使用python建模。如果用cplex，则使用java。\n\n如果不会别的语言，必须使用matlab进行建模和求解的话，yalmip无疑是最好的选择。\n\n## 5.4 gramm（画图）\n\ngramm是基于matlab开发的一个绘图工具，可以画很多好看的图。\n\nmatlab的图一般都很丑，需要自己不断调试。而gramm默认的配色，基本可以直接使用。\n\n![image-20231001184526448](../images/20240712/image-20231001184526448.png)\n\n参考：\n\nhttps://www.mathworks.com/matlabcentral/fileexchange/54465-gramm-complete-data-visualization-toolbox-ggplot2-r-like\n\nhttps://github.com/piermorel/gramm\n\n# 6. One more thing\n\n科研常用工具列表，成为一个合格的板砖人（科研民工）\n\n| 名字               | 价格     | 用处                                                         |\n| ------------------ | -------- | ------------------------------------------------------------ |\n| Office三件套       | 学校提供 | 略                                                           |\n| Mathtype           | 收费     | 数学公式编辑（推荐搭配latex数学命令使用）                    |\n| Typora             | 收费     | markdown编辑器，本次分享使用markdown完成                     |\n| VScode             | 免费     | 地表最强编辑器，我用vscode开发python, latex, markdown        |\n| Notion             | 免费     | 个人知识库（上手很慢，但是可以很好规划你的生活）             |\n| Endnote            | 学校提供 | 个人文献库（直接插入国标引用格式到word）                     |\n| Calibre            | 免费     | 个人图书馆                                                   |\n| 百度云             | 功能收费 | 备份+同步（一年不到200块，同步文件+备份文件）                |\n| Office 365         | 收费     | 与Office年度版本不同，这是订阅制的office，享受更多功能+1T 云盘 |\n| Acrobat DC         | 收费     | PDF编辑器                                                    |\n| Latex              | 免费     | 写期刊论文使用，直接输出pdf                                  |\n| Overleaf / Slagger | 免费     | 在线latex                                                    |\n| Powertoys          | 免费     | Windows拓展工具（非常强大，保持唤醒、取色、分屏等等等）      |\n| Steam / Epic       | ?        | 玩                                                           |\n\n# 7. 结语\n\n1. 使用正版，获得更多的技术支持，工具箱，社区等。\n2. 使用新版，获得更多的功能，更快的运行，更美的界面。\n3. 如果想用matlab，那就**多写多练**。\n4. Matlab真的好用吗？好用不一定，但真的简单，个人认为比Python简单。\n5. 只进行数值计算则matlab不是唯一选择（python, java等都可以），matlab的精髓是工具箱和仿真。\n\n------\n\n感谢各位！\n\n","source":"_posts/2024-07-12-Matlab程序开发经验分享.md","raw":"---\ntitle: Matlab程序开发经验分享\ntag: Matlab\ndate: 2024-07-12 12:00:00\n---\n\n记录在学校的一次matlab课上的技术分享。\n\n**前言**：本次分享主要内容是介绍一些常用的技术，目的是让大家了解遇到某种编程需求该怎么做，用什么方法解决什么问题。\n\n**假设**：各位已经掌握matlab的基本方法，并且自己也会写一些简单代码了。\n\n\n# 1. 代码优化\n\n**Q：为什么我的代码这么慢？**\n\n**A：解释型语言就是比编译型语言慢 + 代码未优化**\n\n## 1. 1 预分配内存\n\n在进行循环语句时，应当先声明变量所需空间的大小，再进行循环，避免每次循环向数组中增加数字。\n\n**不推荐写法**\n\n```matlab\ntic\nfor i = 1:1000\n\tmat(i,i) = i;\nend\ntoc\n% 历时 0.115061 秒。\n```\n\n**推荐写法**\n\n```matlab\ntic\nmat_2 = zeros(1000); % 先把数组的大小声明，在内存中开辟一块空间\nfor i = 1:1000\n\tmat_2(i,i) = i;\nend\ntoc\n% 历时 0.005585 秒。\n```\n\n**为什么出现这样的差异？**\n\n反复调整数组的大小将导致花费额外的时间找到更大的、**连续的**内存空间。\n\n**所有类型的变量都需要这样做吗**\n\n不一定，cell类型则不需要，但是放在cell中的数据类型可能需要。cell数组内存不连续，但是每个cell要求连续内存。（这也是看情况的，cell在编译成mex文件时，同样需要初始化内存）\n\n参考链接：\n\nhttps://ww2.mathworks.cn/help/matlab/matlab_prog/preallocating-arrays.html\n\nhttps://ww2.mathworks.cn/help/matlab/matlab_prog/techniques-for-improving-performance.html\n\nhttps://ww2.mathworks.cn/help/matlab/matlab_prog/avoid-unnecessary-copies-of-data.html\n\nhttps://ww2.mathworks.cn/help/matlab/matlab_prog/strategies-for-efficient-use-of-memory.html\n\n\n\n## 1. 2 向量化\n\n官方定义：\n\n> 修正基于循环且面向标量的代码以使用 MATLAB 矩阵和向量运算的过程称为***向量化***。\n\n简单来说，就是替代for循环做一些简单操作，以提高运行速度、可读性、正确性。即，算法流程控制`for`循环，简单操作向量化。\n\n**向量化是matlab的一个重要特点，这在其他语言很少出现**\n\n向量化的语句通常有底层的支持，利用到了CPU指令集进行优化，因此速度较快。\n\nfor循环遍历慢的原因是matlab为解释性语言。\n\n### 求1至10000的每个数的正弦的和\n\n**循环写法：**\n\n```matlab\ntic\nall_sum = 0;\nfor i = 1:1e4\n\tall_sum = all_sum + sin(i);\nend\ndisp(['all_sum: ', num2str(all_sum)])\ntoc\n% all_sum: 1.6339\n% 历时 0.038938 秒。\n```\n\n**向量化写法：**\n\n```matlab\ntic\nall_sum = sum(sin(1:1e4));\ndisp(['all_sum: ', num2str(all_sum)])\ntoc\n% all_sum: 1.6339\n% 历时 0.008211 秒。\n```\n\n为什么`all_sum`这么小？\n\n### 隐式扩展，求每个人每科成绩与平均值的差距\n\n```matlab\n% 每个人有三门课，\nA = [97 89 84; \n     95 82 92; \n     64 80 99;\n     76 77 67;\n     88 59 74; \n     78 66 87; \n     55 93 85];\t\t% 每一列是一个人\n```\n\n**循环写法**\n\n```matlab\nmA = mean(A);\t\t\t% 求每列的平均值\nB = zeros(size(A));\t\t% 记录每个人每门课的差距\nfor n = 1:size(A,2)\t\t% 对每一列进行操作\n    B(:,n) = A(:,n) - mA(n);\nend\n```\n\n**向量化写法**\n\n```\ndevA = A - mean(A)\n```\n\n注意，在向量化写法中，`mean(A)`的结果是1c 3大小的。即使 `A` 是一个 7×3 矩阵，`mean(A)` 是一个 1×3 向量，MATLAB 也会隐式扩展该向量，就好像其大小与矩阵相同一样，并且该运算将作为正常的按元素减法运算来执行。（广播操作）\n\n### 逻辑索引，线性索引，下标索引\n\n**介绍三种索引方式的区别**\n\n一个矩阵A ，寻找这个矩阵中大于500的数字的行列数\n\n**循环方法**（单个循环，获得线性索引，双层循环，获得行列数）\n\n```matlab\nA = magic(100);\ntic\nsub = zeros(sum(A>500, 'all'), 2);\ncount = 1;\nfor i = 1:100\n\tfor j = 1:100\n\t\tif A(i,j) > 500\n\t\t\tsub(count,:) = [i,j];\n\t\t\tcount = count + 1;\n\t\tend\n\tend\nend\ntoc\n```\n\n**find方法**\n\n```\nA = magic(100);\ntic\n[row, col] = find(A>500);\nsub = [row, col];\ntoc\n```\n\n**处处用find真的合适吗？**\n\n求矩阵A中，所有大于500的数的和\n\n`sum(A(find(A>500)))`线性索引\n<!-- ../images/20240712/image-20231001192302431.png -->\n![image-20230930182045754](../images/20240712/image-20230930182045754.png)\n\n`sum(A>500))`这里直接使用了逻辑索引\n\n**注意：在for循环中，尽量不用注意：在for 循环中，尽量不用find，有些慢。如果不得不使用for获取满足条件的索引，先记录线性索引，然后用ind2sub()函数转化**\n\n### 重复数组\n\n根据向量、矩阵创造大的矩阵\n\n```matlab\nA = repmat(1:3,5,2)\nB = repmat([1 2; 3 4],2,2)\n\n% A =\n\n%     1     2     3     1     2     3\n%     1     2     3     1     2     3\n%     1     2     3     1     2     3\n%     1     2     3     1     2     3\n%     1     2     3     1     2     3\n\n\n% B =\n\n%     1     2     1     2\n%     3     4     3     4\n%     1     2     1     2\n%     3     4     3     4\n```\n\n思考题：多个等间隔指针的轮盘赌如何向量化（随机遍历抽样，遗传算法中经常使用的一个选择方法）？\n\n参考链接：https://ww2.mathworks.cn/help/matlab/matlab_prog/vectorization.html\n\n## 1. 3 冗余运算\n\n消除for循环中的冗余运算有助于提升算法的性能。能放到外层的，就放到外层。\n\n给定一个矩阵A，要求A的每个数乘以当前行数，在加上当前列数，再加一个固定的数\n\n```matlab\nfor i = 1:size(A, 1) % 行\n\tfor j = 1:size(A, 2)\n\t\tfix = 1;\n\t\ttmp = A(i,j);\n\t\ttmp = tmp * i + j;\n\t\tA(i,j) = tmp + fix;\n\tend\nend\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n% fix 提出\nfix = 1;\nfor i = 1:size(A, 1) % 行\n\tfor j = 1:size(A, 2)\n\t\ttmp = A(i,j);\n\t\ttmp = tmp * i + j;\n\t\tA(i,j) = tmp + fix;\n\tend\nend\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\nfix = 1;\nfor i = 1:size(A, 1) % 行\n\tA(i,:) = A(i,:) * i;\n\tfor j = 1:size(A, 2)\n\t\tA(i,j) = A(i,j) + j + fix;\n\tend\nend\n\n%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n% 向量化\nA = (1:size(A, 1))' .* A + (1:size(A, 2)) + fix\n```\n\n\n\n## 1. 4 性能分析\n\n**我的代码怎么这么慢？想改，改什么呢？**\n\n这个时候，需要使用探查器进行代码性能分析\n\n比如对debug.m脚本（模拟禁忌搜索的过程）进行性能分析：\n\n```matlab\n% debug.m\n% 模拟禁忌搜索的过程\ntic\ntabu = zeros(30, 2);\nfor i = 1:1e5\n    rand_int = [randi(15), randi(15)];\n    if ismember(rand_int, tabu, \"rows\")\n        continue\n    else\n        tabu = [rand_int; tabu(1:end-1, :)];\n    end\nend\ntoc\n```\n\n**Step 1. 打开探查器**\n\n![image-20230930192441679](../images/20240712/image-20230930192441679.png)\n\n**Step 2. 在探查器中运行代码**\n\n![image-20230930192625728](../images/20240712/image-20230930192625728.png)\n\n**Step 3. 点击函数名称 获得具体情况**\n\n![image-20230930192855816](../images/20240712/image-20230930192855816.png)\n\n发现原来是`ismember`函数运行太慢了，所以根据问题特性，我们自己写一个`my_ismember`函数，替换原有的`ismember`函数。\n\n原`ismember`函数耗时4.931秒，自己写的`my_ismember`函数耗时0.937秒。\n\n![image-20230930194758499](../images/20240712/image-20230930194758499.png)\n\n上述例子说明：\n\n- 不一定内置函数就足够好，一些函数内置函数为了支持各种数据类型、大小，还是很慢的\n\n- 根据问题、数据结果特征进行重构\n\n  ```matlab\n  function flag = my_ismember(a, b)\n  % 判断a是否在b中\n  \n  validateattributes(a, {'numeric'}, {'size',[1,2]})\n  validateattributes(b, {'numeric'}, {'size',[nan,2]})\n  \n  col_1_flag = b(:, 1) == a(1);\n  col_2_flag = b(:, 2) == a(2);\n  \n  if any(col_1_flag & col_2_flag)\n      flag = true;\n  else\n      flag = false;\n  end\n  end\n  ```\n\n  **注意：** 探查器中运行的代码速度包括了统计时间，因此比一般方式下运行更慢。\n  \n  参考：https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html\n\n## 1. 5 使用更具效率的算法\n\n有些时候，真正慢的是使用的算法的复杂度很高（{% katex %}O(n^2){% endkatex %}甚至{% katex %}O(n^3){% endkatex %}, 或者说是算法过于朴素），跟向量化等上述技术无关。这种慢根源于算法的复杂度，解决方法是换个思路重写。\n\n### 双数之和\n\n给定一个整数数组 `nums` 和一个整数目标值 `target`，请你在该数组中找出 **和为目标值** *`target`* 的那 **两个** 整数，并返回它们的数组下标。\n\n```matlab\n% 输入：nums = [2,7,11,15], target = 9\n% 输出：[0,1]\n% 解释：因为 nums[0] + nums[1] == 9 ，返回 [0, 1] 。\n\n% 随机构造\nrng(pi);\nnums = [2,7,11,15];\nrand_num = randperm(5e4) + 20;\nnums = [nums, randperm(5e4) + 20];\n\nnums = nums(randperm(length(nums))); % nums长度为50004 \ntarget = 9;\n\ntic\ntwo_sum(nums, target)\ntoc\n% ans =\n%       36335       36975\n% 历时 4.324590 秒。\n\ntic\ntwo_sum_hash(nums, target)\ntoc\n% ans = \n%       36335       36975\n% 历时 0.020854 秒。\n\n%  足足200倍速度差距\n```\n\n**暴力枚举（朴素）算法**\n\n```matlab\nfunction output = two_sum(nums, target)\n% O(N^2)\nlen_num = length(nums);\nfor i = 1:len_num\n    for j = 1:len_num\n        if i == j\n            continue\n        end\n\n        if nums(i) + nums(j) == target\n            output = [i,j];\n            return\n        end\n    end\nend\nend\n```\n\n**字典 - 空间换时间**\n\n```matlab\nfunction output = two_sum_hash(nums, target)\n% 该代码使用了dictionary()， 仅支持2022b以上版本\n% O(NlogN)\nlen_num = length(nums);\nd = dictionary(nums, 1:len_num);\nfor i = 1:len_num\n    val_1 = nums(i);\n    val_2 = target - val_1;\n    if isKey(d, val_2) && d(val_2) ~= i\n        output = [d(val_2), i];\n    end\nend\nend\n```\n\n\n\n# 2. <font color=\"#dd0000\">工具箱</font>\n\n## 2.1 Coder\n\nMatlab和python一样是一门解释性语言，因此运行速度不如编译型语言（C++等），因此一些复杂的函数运行起来相对较慢。\n\n不过，Matlab Coder提供了一种方法，使得我们可以将一个函数编译成C或C++或二进制文件，供Matlab使用。步骤如下：\n\n你需要一个Matlab  Coder工具箱。如果没有，则在附加功能中获取。在顶部APP中打开Coder。\n\n![image-20231001134101744](../images/20240712/image-20231001134101744.png)\n\n![image-20231001134208296](../images/20240712/image-20231001134208296.png)\n\n- **进入Select环节**：键入你想编译的函数，注意只能是函数，不能是脚本。这里以`lagrangian_relax`函数为例，然后点击next。![image-20231001134303941](../images/20240712/image-20231001134303941.png)\n- **进入 review环节**：在这个环节，Coder会检查你的代码有无问题，这个步骤会检查`lagrangian_relax`函数调用的所有函数。![image-20231001134944337](../images/20240712/image-20231001134944337.png)\n\n在底部出现了一条警告，此时应注意，警告和错误是不同的，程序可以有警告（前提是已知警告产生的原因和后果），错误则不同。错误将直接导致程序运行不通。\n\n解决完所有问题后，点Next。\n\n- **进入Define环节：**该环节定义了所有变量的类型&大小。\n\n  ![image-20231001135319241](../images/20240712/image-20231001135319241.png)\n\n  在上方的框中，输入调用`lagrangian_relax`函数的脚本，然后点`Autodefine Input Types`按钮，等程序运行，所有的变量的大小自动确定。**但是**，自动确定的变量大小类型是固定的，也就是说只能输入这种大小的数据，所以，对一些不确定大小的数据，需要手动将大小调整成inf。点Next，继续。\n\n- **进入 check环节**：Coder会运行之前输入的脚本，检查是否有运行问题、编译问题等等。这一步可能会出现各种报错，这些报错的原因并不是`lagrangian_relax`函数的结果有问题，而是写脚本的习惯超出编译器可理解的范围，或者编译器认为写的不严谨，数据类型/大小匹配等一系列问题。需要逐个修改，直至通过编译。\n\n![image-20231001140304900](../images/20240712/image-20231001140304900.png)\n\n- **进入 generate环节**：如果仅仅想在matlab中调用编译好的二进制文件提升运行速度，那么选择mex即可，点Geneate等待生成。\n\n  ![image-20231001140519650](../images/20240712/image-20231001140519650.png)\n\n- **完成**\n  ![image-20231001140532936](../images/20240712/image-20231001140532936.png)\n\n\n\n接下来，我们就可以像使用一个普通函数一样使用这个mex文件了。\n\n```matlab\ntic\nlagrangian_relax_mex(data, super_cus, param); % 生成的mex文件\ntoc\n% Iter:  25; LB:    32233.19; UB*:   42478.36; Cons: 2.000000; Gap:  24.12 % \n% LR finish: max iteration\n% 历时 3.555206 秒。\n\n\ntic\nlagrangian_relax(data, super_cus, param); % 原来的函数\ntoc\n% Iter:  25; LB:    32233.19; UB*:   42478.36; Cons: 2.000000; Gap:  24.12 % \n% LR finish: max iteration\n% 历时 93.820573 秒。\n```\n\n可以观察到，两种方法输出的结果是一样的，但是速度差了30倍。\n\n**Coder的缺点：**\n\n- 并不是所有内置函数都支持Coder的，例如dictionary就不支持。不支持的函数会在编译时报错。\n\n- Coder编译的文件来源于选择的C++编译器，很可能出现mex文件在另一台电脑上无法运行的情况。\n\n- Coder编译的文件的另一个问题是不能跨平台，mac/win/linux编译得到的文件时不同的。\n\n参考链接：[通过生成 MEX 函数加快 MATLAB 算法的执行速度](https://ww2.mathworks.cn/help/releases/R2020b/coder/gs/generating-mex-functions-from-matlab-code-at-the-command-line.html)\n\n​\t\t\t\t\t[从 MATLAB 代码生成 C 和 C++ 代码](https://ww2.mathworks.cn/products/matlab-coder.html)\n\n​\t\t\t\t\t[MATLAB Coder入门到放弃](https://zhuanlan.zhihu.com/p/604283307)\n\n​\t\t\t\t\thttps://blog.csdn.net/qq_36584460/article/details/110791330\t\n\n**（实操环节），编译一个mex文件并运行**\n\n\n## 2. 2 parallel computing toolbox\n\n前面提到过利用多核心进行并行计算，需要并行计算工具箱。\n\n> 该工具箱通过在本地运行的 worker（MATLAB 计算引擎）上执行应用程序，允许你充分利用多核台式机的处理能力。无需更改代码，即可在集群或云上运行同一个应用程序。还可以将该工具箱与 MATLAB Parallel Server 结合使用，以执行由于太大而无法装入单台机器内存的矩阵计算\n\n### 并行for循环\n\n```matlab\ntic\nn = 200;\nA = 500;\na = zeros(1,n);\nfor i = 1:n\n    a(i) = max(abs(eig(rand(A))));\nend\ntoc\n% 历时 37.256415 秒。\n```\n\n```matlab\ntic\nn = 200;\nA = 500;\na = zeros(1,n);\nparfor i = 1:n\n    a(i) = max(abs(eig(rand(A)))); % 最大 / 绝对 / 特征值 / 随机\nend\ntoc\n% 历时 8.028954 秒。\n```\n\n使用场景：许多简单计算的循环，parfor将循环划分为组，以便每个线程可以执行一组。\n\n**但是，**循环中一组循环的结果依赖前面某次循环的结果时，不能使用并行计算（归约[Reduction Variables](https://ww2.mathworks.cn/help/parallel-computing/reduction-variable.html)除外）。并行计算有一系列局限性，而且在一些情况下（例如，广播变量）并不能加速代码运行。\n\n**使用`parfor`的情况：**\n\n- 每次的for循环很慢（单个时间长）\n- 简单计算的多次循环（单个时间短但是数量多）\n- 多层for嵌套的外层使用parfor更具收益（**思考：为什么？**）\n\n**不推荐用`parfor`的情况：**\n\n- 已经将for向量化的情况（向量化比parfor收益更高）\n- 循环已经很快了（并行化的时间开销更高，包括初始化，分配等）\n\n**强烈反对的情况：**\n\n- 向量化 -> for循环 -> parfor循环 （反向优化）\n\n**`for`转`parfor`的一个不可行举例**\n\n![image-20231001201801595](../images/20240712/image-20231001201801595.png)\n\nfor转parfor一定程度上很复杂，有各式各样的规则限制、写法限制，这里只做一个简单介绍。关于什么时候用parfor，如何将for转为parfor，使用parfor的要求，常见问题等，参见[parfor文档](https://ww2.mathworks.cn/help/parallel-computing/parallel-for-loops-parfor.html?s_tid=CRUX_lftnav)。\n\n参考链接：[在多核计算机、GPU 和集群上执行并行计算](https://ww2.mathworks.cn/products/parallel-computing.html)\n\n**补充：parfor可以和coder结合使用，生成的mex文件也是支持多核计算的**\n\n## 2. 3 Symbolic Math Toolbox\n\n符号计算工具箱，就是能计算数学公式的一个工具箱，变量不再是数值而是符号。因此可以求计算**定积分**和**不定积分**的**解析解**，计算符号表达式或函数的**导数**，并使用级数展开式逼近函数，等等。\n\n例如，求{% katex %} \\int_a^b \\sin x dx{% endkatex %}在{% katex %}[\\frac{\\pi}{2}, \\frac{3\\pi}{2}]{% endkatex %}上的积分\n\n```matlab\nsyms x\nint(sin(x),pi/2,3*pi/2)\n% ans = 0\n```\n\n这只是一个简单的例子，表示我们可以使用matlab做这件事，具体应用：\n\n**某博弈论问题求纳什均衡点**\n\n解方程组：\n\n![image-20231001203458641](../images/20240712/image-20240712115425.png)\n\n\n解得四个解中的一个解为纳什均衡点。\n\n![image-20231001151417317](../images/20240712/image-20231001151417317.png)\n\n**纳什均衡点{% katex %}E_4{% endkatex %}的雅克比矩阵**\n\n![image-20231001151523651](../images/20240712/image-20231001151523651.png)\n\n**注：符号计算工具箱不支持coder**\n\n如何查看是否支持 coder？详见函数参考文档的底部支持列表\n\n# 3. 技巧经验\n\n## 3. 1 使用结构体进行传参\n\n假设你有一辆车，车长4米，平时跑72km/h，车重1000kg，载重2000kg，现在你写了一个函数`f`用于估计油耗。\n\n```matlab\nfunction consume = f(len, velocity, weight, capacity)\n\t...\nend\n```\n\n使用结构体封装一下\n\n```matlab\nvehicle = struct()\nvehicle.len = 4;\nvehicle.velocity = 72;\nvehicle.weight = 1000;\nvehicle.capacity = 2000;\n\nfunction consume = f(vehicle)\n\t...\nend\n```\n\n包括传出，也可以使用结构体，解决了参数记错的问题。\n\nconsume = [1, 2, 3, 4]\n\nconsume. air = 1; % 空气阻力产生的燃料消耗\n\nconsume.weight = 2; % 重量产生的消耗\n\n...\n\n给名字就不容易错了，比consume(1) consume(2) 这种要方便\n\n\n\n## 3.2 使用句柄函数@\n\n### `C = bsxfun(fun,A,B)` \n\nBinary Singleton Expansion Function\n\n对数组 `A` 和 `B` 应用函数句柄 `fun` 指定的按元素二元运算。\n\n```matlab\nA = [8; 17; 20; 24]\nB = [0 10 21]\nC = bsxfun(@gt,A,B)\n\n% C = 4x3 logical array\n\n%    1   0   0\n%    1   1   0\n%    1   1   0\n%    1   1   1\n\n```\n\n其中`@gt`的意思是大于\"greater than\"， 因此生成了隐式扩展结果。\n\n接下来，给定一个向量`a`和一个向量`b`，求{% katex %}a-e^b{% endkatex %}的所有组合的结果。\n\n```matlab\na = [1 2 3 4];\nb = [5; 6; 7];\n\n% 第一种方法\nc = zeros(length(b), length(a));\nfor i = 1:length(a)\n\tfor j = 1:length(b)\n\t\tc(j,i) = a(i) - exp(b(j));\n\tend\nend\ndisp(c)\n\n% 第二种方法\nf = @(a, b) a - exp(b);\nc = bsxfun(f, a, b);\ndisp(c)\n```\n\n### `A = cellfun(func, C)`\n\n 对元胞数组`C`的每个元胞进行操作。\n\n获取元胞数组中，每个元胞的大小\n\n```matlab\nC = cell(3, 1);\nC{1,1} = 'Sunday';\nC{2,1} = magic(3);\nC{3,1} = 1:10;\n\n% 循环操作\nA = zeros(size(C, 1), 1);\nfor i = 1:size(C, 1)\n\tA(i) = length(C{i,1}(:));\nend\ndisp(A)\n% [6; 9; 10]\n\n% cellfun\nA = cellfun(@(x) length(x(:)), C)\n% [6; 9; 10]\n\n```\n\n### `A = structfun(func, S)`\n\n对标量结构体的每个字段应用函数\n\n```matlab\nS.f1 = 1:10;\nS.f2 = [2; 4; 6];\nS.f3 = []\n\nA = structfun(@mean,S)\n% A = 3×1\n\n%     5.5000\n%     4.0000\n%        NaN\n```\n\n## 3. 3 运行日志\n\n将命令行窗口文本记录到日志文件中\n\n```matlab\ndiary 'myDiaryFile.txt'\n\nfor i = 1:10\n\tdisp(exp(i))\nend\n\ndiary off\n```\n\n你就会得到一个`myDiaryFile.txt`文件，用于记录所有打印的结果。\n\n用处：追踪程序运行状况，运行到哪次迭代？运行到哪一步？配合其他函数，还可以记录何时运行等信息。\n\n## 3.4 格式化输出\n\n格式化字符串\n\n```matlab\nformatSpec = 'The array is %dx%d.';\nA1 = 2;\nA2 = 3;\nstr = sprintf(formatSpec,A1,A2)\n% str = \n% 'The array is 2x3.'\n\nfprint(formatSpec,A1,A2)\n% 'The array is 2x3.'\n```\n\n参考： https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html\n\n有什么用？多次运行一个函数，但是输入参数不同时，配合`diary`函数可生成结果日志\n\n![image-20231001164150891](../images/20240712/image-20231001164150891.png)\n\n解放双手，从自动运行做起，拒绝**手动保存**每次的运行结果。\n\n## 3.5 运行时间\n\n想要获取运行了多久？使用`tic`和`toc`函数统计代码运行时间。\n\n高级用法：使用多个tic测量时间\n\n```matlab\ntStart = tic;           % pair 2: tic\nn = 10;\nT = zeros(1,n);\nfor i = 1:n\n    A = rand(12000,4400);\n    B = rand(12000,4400);\n    tic         % pair 1: tic\n    C = A.*B;\n    T(i)= toc;  % pair 1: toc\nend\ntMul = sum(T) % tMul = 0.6037\ntEnd = toc(tStart) % tEnd = 11.6301\n```\n\n其他统计代码运行时长的方法：\n\n[t = cputime](https://ww2.mathworks.cn/help/releases/R2023b/matlab/ref/cputime.html?)\n\n[t = datetime](https://www.mathworks.com/help/releases/R2023b/matlab/ref/datetime.html?searchHighlight=datetime&s_tid=doc_srchtitle#d126e310370)\n\n## 3.6 多层嵌套\n\n看这样一个代码，每月每天你孤单会想起谁：\n\n```matlab\nfor month = 1:12  % 月\n\tfor day = 1:30 % 天\n\t\tif 孤单？\n\t\t\t你想起一个人\n\t\t\tif 想找个人来陪\n\t\t\t\t找！\n\t\t\tend\n\t\tend\n\tend\nend\n```\n\n上述代码的问题：嵌套太多了，一层一层的嵌套。（写代码的习惯，不影响执行效率，但是影响可读性）\n\n```matlab\nfor month = 1:12  % 月\n\tfor day = 1:30 % 天\n\t\tif ~ 孤单？ % 非孤单 \"~\"取反\n\t\t\tcontinue\n\t\tend\n\t\t\n\t\t你想起一个人\n\t\tif 想找个人来陪\n\t\t\t找！\n\t\tend\n\tend\nend\n```\n\n使用continue关键字跳转，避免嵌套，提升可读性\n\n## 3.7 Latex公式\n\nlatex是特别常用且提升效率的公式编辑方法，推荐大家使用！\n\n好处：输入公式时，手不再使用鼠标，全键盘操作\n\n可以使用的场景：\n\n- word\n- markdown\n- latex\n- mathtype\n- matlab\n- ...\n\n## 3.8 实时脚本做展示\n\n一般不用这个功能做开发，但是实时脚本是良好的展示工具\n\n类似于 python 的 jupyter notebook\n\n![image-20231006133646069](../images/20240712/image-20231006133646069.png)\n\n## 3.9 数值精度问题\n\n数值精度问题普遍存在于计算机语言中，我们不讨论产生数值精度的具体原因，只需要知道存在这样的问题。\n\n例如：\n\n```matlab\n0.1 + 0.2 == 0.3\n\n% ans =\n\n%  logical\n\n%   0\n\n```\n\n在for循环中，需要避免以下的情况\n\n```matlab\nfor i = 0.0:0.1:1.0\n    disp('-------------------')\n    for j = 0.0:0.1:1.0-i\n        k = 1.0 - i - j;\n        disp([i,j,k])\n    end\nend\n\n% -------------------\n%    0.7000         0    0.3000\n%    0.7000    0.1000    0.2000\n%    0.7000    0.2000    0.1000\n%    0.7000    0.3000   -0.0000\n```\n\n出现一个非常小的负数，极有可能导致bug\n\n```matlab\nfor i = 0:10\n    disp('-------------------')\n    for j = 0:(10-i)\n        k = 10 - i - j;\n        disp([i,j,k] / 10)\n    end\nend\n\n-------------------\n    0.7000         0    0.3000\n\n    0.7000    0.1000    0.2000\n\n    0.7000    0.2000    0.1000\n\n    0.7000    0.3000         0\n\n```\n\n\n\n## 3.10 在线Matlab\n\n电脑没有matlab？只要有许可证，就能使用matlab在线编程（https://ww2.mathworks.cn/products/matlab-online.html）。\n\n## 3.11 Markdown语言\n\n本文档就是使用的markdown编写的，这是一种文本标记语言，实现文本的不同格式、样式。\n\n# 4. 如何DEBUG\n\n## 4.1 断点\n\n调试程序是每个编程语言必备的操作，没有人能完美写完一个复杂的代码并且没有任何小错误。当这些错误直观发现不了时，使用断点追踪程序每步的运算有助于发现问题。\n\n![image-20231001165505931](../images/20240712/image-20231001165505931.png)\n\n## 4.2 条件断点\n\n例如在这个循环中，每次`j=3`时就报错，我们增加一个条件断点，当满足这个条件时，程序暂停。\n\n![image-20231001165725593](../images/20240712/image-20231001165725593.png)\n\n![image-20231001165858415](../images/20240712/image-20231001165858415.png)\n\n## 4.3 错误暂停\n\n![image-20231001165922621](../images/20240712/image-20231001165922621.png)\n\n建议把出现错误暂停勾选，这样程序会停止在出错的哪一行，有助于分析/复现问题。\n\n![image-20231001165952424](../images/20240712/image-20231001165952424.png)\n\n## 4.4 搜索问题\n\n当一个问题，自己不能解决的时候，我们通常会使用搜索引擎进行检索，如何获得问题的答案？\n\n例如：\n\n> 我想删除一个cell数组中空的元胞，保留下非空的元胞\n\n一般我会用 “语言 + 关键词 ”搜索\n\n- 搜索方法：`MATLAB cell删除空元胞`\n\n- 结果质量：\n  - Matlab中文论坛 / 知乎 / 博客园 \n  - CSDN（垃圾堆里找吃的，但不代表都是垃圾） / 简书\n  - 百度知道 （几乎驴唇不对马嘴） / 其他小网站\n\n![image-20231001170909421](../images/20240712/image-20231001170909421.png)\n\n## 4. 5 <font color=\"#dd0000\">向他人提问</font>\n\n向他人提问，包括同学、老师、网友等。\n\n为什么向他人提问很重要？正确的提问方式有助于提升双方沟通效率，快速发现问题。\n\n**错误的提问方式**\n\n1. 不会截图 用手机拍照的\n\n<img src=\"https://img-blog.csdnimg.cn/975ac90367e0403bb704c1785dd9c27b.jpg?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5b6h6aOOQk_lsJE=,size_20,color_FFFFFF,t_70,g_se,x_16\" alt=\"img\" style=\"zoom: 50%;\" />\n\n2. 截图截一半 只截图报错信息traceback， 不截图代码的\n\n   ![image-20231001171745717](../images/20240712/image-20231001171745717.png)\n\n3. 不截图前后文的\n\n   > 为什么我这句代码报错了？\n\n   ![image-20231001172136136](../images/20240712/image-20231001172136136.png)\n\n4. 自己不思考、不检索，直接问别人的。\n\n   > 我想删除一个cell数组中空的元胞，保留下非空的元胞，matlab怎么写？\n\n**正确的提问方式**（不仅适用于代码提问）\n\n- 尽可能详细说出你的问题\n\n- 提供代码（如果是截图，截图要全面）\n\n- 问题如何复现\n\n- 你已经做了什么操作，但是还是不行\n\n- 发送之前读一读你的提问\n\n  举例 1：\n\n  ![image-20231001172945916](../images/20240712/image-20231001172945916.png)\n\n  举例 2：![image-20231001173153802](../images/20240712/image-20231001173153802.png)\n\n## 4. 6 文档\n\n如果你知道matlab的某个函数的名字，但是不会写，那么可以在matlab右上角搜索文档，也可以在命令行中使用`help 'fun_name'`获得文档。\n\n![image-20231001173452560](../images/20240712/image-20231001173452560.png)\n\n此外，在命令行中输入`doc 'fun_name'`可以打开在线文档。\n\n```matlab\ndoc zeros\n```\n\n![image-20231001173620154](../images/20240712/image-20231001173620154.png)\n\n# 5. <font color=\"#dd0000\">外部功能</font>\n\n## 5.1 Python\n\n很多时候，我们发现某个功能只在python中有，matlab中没有或者不如python好用。\n\n这个时候，我们可以写一个python函数，然后让matlab调用这个py函数，再将结果处理成matlab可接收的类型即可。\n\n举例来说，Gurobi对Python支持远远比matlab好，建模也更加方便，我们可以使用matlab调用python，python调用gurobi来实现：\n\n首先，我们写一个python调用gurobi的函数`grbpy_v.py`\n\n```python\n# grbpy_v.py\nimport gurobipy as gp\nimport numpy as np\nimport math\n\ndef model(f, alpha, beta, gamma, mu, kappa):\n    # 集合\n    I = range(len(f))\n    P = range(len(alpha[0]))\n    N = range(len(gamma[0]))\n    M = range(len(beta[0]))\n\n    # 建模\n    model = gp.Model()\n\n    # 变量\n    v = model.addVars((i for i in I), vtype = gp.GRB.BINARY, name ='v')\n\n    # 目标\n    obj = gp.quicksum((f[i] - gp.quicksum(alpha[i,p] for p in P) \\\n                            - gp.quicksum(beta[i,m] - mu[i,m] for m in M)\\\n                            - gp.quicksum(gamma[i,n] - kappa[i,n] for n in N)) * v[i] for i in I) \\\n        - gp.quicksum(mu[i,m] for i in I for m in M) \\\n        - gp.quicksum(kappa[i,n] for i in I for n in N)\n    model.setObjective(obj, sense = gp.GRB.MINIMIZE)\n    \n    # 约束\n    # 无\n\n    # 求解\n    model.Params.OutputFlag = 0\n    model.Params.MIPGap = 0.01\n    model.optimize()\n\n    # 整理\n    loc = np.zeros([1,len(f)])\n    for i in I:\n        if math.isclose(v[i].X, 1):\n            loc[0,i] = 1\n\n    obj_val = model.getAttr('ObjVal')\n\n    return (loc, obj_val)\n\n```\n\n然后，我们写一个matlab脚本（函数）调用这个py函数\n\n```matlab\npy.importlib.reload(py.importlib.import_module('grbpy_v'));\n\nfix_ws_py = py.numpy.array(fixed_ws);\nalpha_py  = py.numpy.array(alpha);\nbeta_py   = py.numpy.array(beta);\nmu_py     = py.numpy.array(mu);\ngamma_py  = py.numpy.array(gamma);\nkappa_py  = py.numpy.array(kappa);\n\nres = py.grbpy_v.model(fix_ws_py, alpha_py, beta_py, gamma_py, mu_py, kappa_py);\n```\n\n注意上述存在类型转换，需要把matlab的矩阵转成python的numpy矩阵才可以使用。\n\n参考：[从 MATLAB 中调用 Python](https://www.mathworks.com/help/releases/R2023b/matlab/call-python-libraries.html?s_tid=doc_srchtitle)\n\n## 5. 2 Gurobi （运筹）\n\nGurobi是一款求解器，做运筹优化方面常常会用到，这里将介绍直接使用matlab调用gurobi，不借助其他软件或包。\n\n来源于Guorbi官方文档：\n\n```matlab\nfunction facility()\n\n% Copyright 2023, Gurobi Optimization, LLC\n%\n% Facility location: a company currently ships its product from 5 plants\n% to 4 warehouses. It is considering closing some plants to reduce\n% costs. What plant(s) should the company close, in order to minimize\n% transportation and fixed costs?\n%\n% Note that this example uses lists instead of dictionaries.  Since\n% it does not work with sparse data, lists are a reasonable option.\n%\n% Based on an example from Frontline Systems:\n%   http://www.solver.com/disfacility.htm\n% Used with permission.\n\n% define primitive data\nnPlants     = 5;\nnWarehouses = 4;\n% Warehouse demand in thousands of units\nDemand      = [15; 18; 14; 20];\n% Plant capacity in thousands of units\nCapacity    = [20; 22; 17; 19; 18];\n% Fixed costs for each plant\nFixedCosts  = [12000; 15000; 17000; 13000; 16000];\n% Transportation costs per thousand units\nTransCosts  = [\n    4000; 2000; 3000; 2500; 4500;\n    2500; 2600; 3400; 3000; 4000;\n    1200; 1800; 2600; 4100; 3000;\n    2200; 2600; 3100; 3700; 3200];\n\n% Index helper function\nflowidx = @(w, p) nPlants * w + p;\n\n% Build model\nmodel.modelname = 'facility';\nmodel.modelsense = 'min';\n\n% Set data for variables\nncol = nPlants + nPlants * nWarehouses;\nmodel.lb    = zeros(ncol, 1);\nmodel.ub    = [ones(nPlants, 1); inf(nPlants * nWarehouses, 1)];\nmodel.obj   = [FixedCosts; TransCosts];\nmodel.vtype = [repmat('B', nPlants, 1); repmat('C', nPlants * nWarehouses, 1)];\n\nfor p = 1:nPlants\n    model.varnames{p} = sprintf('Open%d', p);\nend\n\nfor w = 1:nWarehouses\n    for p = 1:nPlants\n        v = flowidx(w, p);\n        model.varnames{v} = sprintf('Trans%d,%d', w, p);\n    end\nend\n\n% Set data for constraints and matrix\nnrow = nPlants + nWarehouses;\nmodel.A     = sparse(nrow, ncol);\nmodel.rhs   = [zeros(nPlants, 1); Demand];\nmodel.sense = [repmat('<', nPlants, 1); repmat('=', nWarehouses, 1)];\n\n% Production constraints\nfor p = 1:nPlants\n    for w = 1:nWarehouses\n        model.A(p, p) = -Capacity(p);\n        model.A(p, flowidx(w, p)) = 1.0;\n    end\n    model.constrnames{p} = sprintf('Capacity%d', p);\nend\n\n% Demand constraints\nfor w = 1:nWarehouses\n    for p = 1:nPlants\n        model.A(nPlants+w, flowidx(w, p)) = 1.0;\n    end\n    model.constrnames{nPlants+w} = sprintf('Demand%d', w);\nend\n\n% Save model\ngurobi_write(model,'facility_m.lp');\n\n% Guess at the starting point: close the plant with the highest fixed\n% costs; open all others first open all plants\nmodel.start = [ones(nPlants, 1); inf(nPlants * nWarehouses, 1)];\n[~, idx] = max(FixedCosts);\nmodel.start(idx) = 0;\n\n% Set parameters\nparams.method = 2;\n\n% Optimize\nres = gurobi(model, params);\n\n% Print solution\nif strcmp(res.status, 'OPTIMAL')\n    fprintf('\\nTotal Costs: %g\\n', res.objval);\n    fprintf('solution:\\n');\n    for p = 1:nPlants\n        if res.x(p) > 0.99\n            fprintf('Plant %d open:\\n', p);\n        end\n        for w = 1:nWarehouses\n            if res.x(flowidx(w, p)) > 0.0001\n                fprintf('  Transport %g units to warehouse %d\\n', res.x(flowidx(w, p)), w);\n            end\n        end\n    end\nelse\n    fprintf('\\n No solution\\n');\nend\n\nend\n\n```\n\n想表达的是，gurobi对matlab很不友好：\n\n- 系数矩阵必须是自己算明白索引后，转换为一个稀疏矩阵。\n- 很难按照约束一条一条添加\n- 有些gurobi功能matlab不能使用\n\n同样模型，python的版本\n\n```python\n#!/usr/bin/env python3.7\n\n# Copyright 2023, Gurobi Optimization, LLC\n\n# Facility location: a company currently ships its product from 5 plants\n# to 4 warehouses. It is considering closing some plants to reduce\n# costs. What plant(s) should the company close, in order to minimize\n# transportation and fixed costs?\n#\n# Note that this example uses lists instead of dictionaries.  Since\n# it does not work with sparse data, lists are a reasonable option.\n#\n# Based on an example from Frontline Systems:\n#   http://www.solver.com/disfacility.htm\n# Used with permission.\n\nimport gurobipy as gp\nfrom gurobipy import GRB\n\n\n# Warehouse demand in thousands of units\ndemand = [15, 18, 14, 20]\n\n# Plant capacity in thousands of units\ncapacity = [20, 22, 17, 19, 18]\n\n# Fixed costs for each plant\nfixedCosts = [12000, 15000, 17000, 13000, 16000]\n\n# Transportation costs per thousand units\ntransCosts = [[4000, 2000, 3000, 2500, 4500],\n              [2500, 2600, 3400, 3000, 4000],\n              [1200, 1800, 2600, 4100, 3000],\n              [2200, 2600, 3100, 3700, 3200]]\n\n# Range of plants and warehouses\nplants = range(len(capacity))\nwarehouses = range(len(demand))\n\n# Model\nm = gp.Model(\"facility\")\n\n# Plant open decision variables: open[p] == 1 if plant p is open.\nopen = m.addVars(plants,\n                 vtype=GRB.BINARY,\n                 obj=fixedCosts,\n                 name=\"open\")\n\n# Transportation decision variables: transport[w,p] captures the\n# optimal quantity to transport to warehouse w from plant p\ntransport = m.addVars(warehouses, plants, obj=transCosts, name=\"trans\")\n\n# You could use Python looping constructs and m.addVar() to create\n# these decision variables instead.  The following would be equivalent\n# to the preceding two statements...\n#\n# open = []\n# for p in plants:\n#     open.append(m.addVar(vtype=GRB.BINARY,\n#                          obj=fixedCosts[p],\n#                          name=\"open[%d]\" % p))\n#\n# transport = []\n# for w in warehouses:\n#     transport.append([])\n#     for p in plants:\n#         transport[w].append(m.addVar(obj=transCosts[w][p],\n#                                      name=\"trans[%d,%d]\" % (w, p)))\n\n# The objective is to minimize the total fixed and variable costs\nm.ModelSense = GRB.MINIMIZE\n\n# Production constraints\n# Note that the right-hand limit sets the production to zero if the plant\n# is closed\nm.addConstrs(\n    (transport.sum('*', p) <= capacity[p]*open[p] for p in plants), \"Capacity\")\n\n# Using Python looping constructs, the preceding would be...\n#\n# for p in plants:\n#     m.addConstr(sum(transport[w][p] for w in warehouses)\n#                 <= capacity[p] * open[p], \"Capacity[%d]\" % p)\n\n# Demand constraints\nm.addConstrs(\n    (transport.sum(w) == demand[w] for w in warehouses),\n    \"Demand\")\n\n# ... and the preceding would be ...\n# for w in warehouses:\n#     m.addConstr(sum(transport[w][p] for p in plants) == demand[w],\n#                 \"Demand[%d]\" % w)\n\n# Save model\nm.write('facilityPY.lp')\n\n# Guess at the starting point: close the plant with the highest fixed costs;\n# open all others\n\n# First open all plants\nfor p in plants:\n    open[p].Start = 1.0\n\n# Now close the plant with the highest fixed cost\nprint('Initial guess:')\nmaxFixed = max(fixedCosts)\nfor p in plants:\n    if fixedCosts[p] == maxFixed:\n        open[p].Start = 0.0\n        print('Closing plant %s' % p)\n        break\nprint('')\n\n# Use barrier to solve root relaxation\nm.Params.Method = 2\n\n# Solve\nm.optimize()\n\n# Print solution\nprint('\\nTOTAL COSTS: %g' % m.ObjVal)\nprint('SOLUTION:')\nfor p in plants:\n    if open[p].X > 0.99:\n        print('Plant %s open' % p)\n        for w in warehouses:\n            if transport[w, p].X > 0:\n                print('  Transport %g units to warehouse %s' %\n                      (transport[w, p].X, w))\n    else:\n        print('Plant %s closed!' % p)\n\n```\n\n\n\n## 5.3 Yalmip （运筹）\n\nyalmip是一款基于matlab进行数学建模的包，或者说是一种基于matlab的建模语言，使用yalmip的好处是解决了matlab建模的痛点，并且可以调用多个求解器对模型进行求解。\n\n然而，求解器方面，如果用gurobi / COPT，则一般使用python建模。如果用cplex，则使用java。\n\n如果不会别的语言，必须使用matlab进行建模和求解的话，yalmip无疑是最好的选择。\n\n## 5.4 gramm（画图）\n\ngramm是基于matlab开发的一个绘图工具，可以画很多好看的图。\n\nmatlab的图一般都很丑，需要自己不断调试。而gramm默认的配色，基本可以直接使用。\n\n![image-20231001184526448](../images/20240712/image-20231001184526448.png)\n\n参考：\n\nhttps://www.mathworks.com/matlabcentral/fileexchange/54465-gramm-complete-data-visualization-toolbox-ggplot2-r-like\n\nhttps://github.com/piermorel/gramm\n\n# 6. One more thing\n\n科研常用工具列表，成为一个合格的板砖人（科研民工）\n\n| 名字               | 价格     | 用处                                                         |\n| ------------------ | -------- | ------------------------------------------------------------ |\n| Office三件套       | 学校提供 | 略                                                           |\n| Mathtype           | 收费     | 数学公式编辑（推荐搭配latex数学命令使用）                    |\n| Typora             | 收费     | markdown编辑器，本次分享使用markdown完成                     |\n| VScode             | 免费     | 地表最强编辑器，我用vscode开发python, latex, markdown        |\n| Notion             | 免费     | 个人知识库（上手很慢，但是可以很好规划你的生活）             |\n| Endnote            | 学校提供 | 个人文献库（直接插入国标引用格式到word）                     |\n| Calibre            | 免费     | 个人图书馆                                                   |\n| 百度云             | 功能收费 | 备份+同步（一年不到200块，同步文件+备份文件）                |\n| Office 365         | 收费     | 与Office年度版本不同，这是订阅制的office，享受更多功能+1T 云盘 |\n| Acrobat DC         | 收费     | PDF编辑器                                                    |\n| Latex              | 免费     | 写期刊论文使用，直接输出pdf                                  |\n| Overleaf / Slagger | 免费     | 在线latex                                                    |\n| Powertoys          | 免费     | Windows拓展工具（非常强大，保持唤醒、取色、分屏等等等）      |\n| Steam / Epic       | ?        | 玩                                                           |\n\n# 7. 结语\n\n1. 使用正版，获得更多的技术支持，工具箱，社区等。\n2. 使用新版，获得更多的功能，更快的运行，更美的界面。\n3. 如果想用matlab，那就**多写多练**。\n4. Matlab真的好用吗？好用不一定，但真的简单，个人认为比Python简单。\n5. 只进行数值计算则matlab不是唯一选择（python, java等都可以），matlab的精髓是工具箱和仿真。\n\n------\n\n感谢各位！\n\n","slug":"2024-07-12-Matlab程序开发经验分享","published":1,"updated":"2024-08-27T08:04:41.295Z","comments":1,"layout":"post","photos":[],"_id":"cm0epapyo0003hjm1ao0dgs8z","content":"<p>记录在学校的一次matlab课上的技术分享。</p>\n<p><strong>前言</strong>：本次分享主要内容是介绍一些常用的技术，目的是让大家了解遇到某种编程需求该怎么做，用什么方法解决什么问题。</p>\n<p><strong>假设</strong>：各位已经掌握matlab的基本方法，并且自己也会写一些简单代码了。</p>\n<h1 id=\"1-代码优化\"><a href=\"#1-代码优化\" class=\"headerlink\" title=\"1. 代码优化\"></a>1. 代码优化</h1><p><strong>Q：为什么我的代码这么慢？</strong></p>\n<p><strong>A：解释型语言就是比编译型语言慢 + 代码未优化</strong></p>\n<h2 id=\"1-1-预分配内存\"><a href=\"#1-1-预分配内存\" class=\"headerlink\" title=\"1. 1 预分配内存\"></a>1. 1 预分配内存</h2><p>在进行循环语句时，应当先声明变量所需空间的大小，再进行循环，避免每次循环向数组中增加数字。</p>\n<p><strong>不推荐写法</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">1000</span></span><br><span class=\"line\">\tmat(<span class=\"built_in\">i</span>,<span class=\"built_in\">i</span>) = <span class=\"built_in\">i</span>;</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% 历时 0.115061 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>推荐写法</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">mat_2 = <span class=\"built_in\">zeros</span>(<span class=\"number\">1000</span>); <span class=\"comment\">% 先把数组的大小声明，在内存中开辟一块空间</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">1000</span></span><br><span class=\"line\">\tmat_2(<span class=\"built_in\">i</span>,<span class=\"built_in\">i</span>) = <span class=\"built_in\">i</span>;</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% 历时 0.005585 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>为什么出现这样的差异？</strong></p>\n<p>反复调整数组的大小将导致花费额外的时间找到更大的、<strong>连续的</strong>内存空间。</p>\n<p><strong>所有类型的变量都需要这样做吗</strong></p>\n<p>不一定，cell类型则不需要，但是放在cell中的数据类型可能需要。cell数组内存不连续，但是每个cell要求连续内存。（这也是看情况的，cell在编译成mex文件时，同样需要初始化内存）</p>\n<p>参考链接：</p>\n<p><a href=\"https://ww2.mathworks.cn/help/matlab/matlab_prog/preallocating-arrays.html\">https://ww2.mathworks.cn/help/matlab/matlab_prog/preallocating-arrays.html</a></p>\n<p><a href=\"https://ww2.mathworks.cn/help/matlab/matlab_prog/techniques-for-improving-performance.html\">https://ww2.mathworks.cn/help/matlab/matlab_prog/techniques-for-improving-performance.html</a></p>\n<p><a href=\"https://ww2.mathworks.cn/help/matlab/matlab_prog/avoid-unnecessary-copies-of-data.html\">https://ww2.mathworks.cn/help/matlab/matlab_prog/avoid-unnecessary-copies-of-data.html</a></p>\n<p><a href=\"https://ww2.mathworks.cn/help/matlab/matlab_prog/strategies-for-efficient-use-of-memory.html\">https://ww2.mathworks.cn/help/matlab/matlab_prog/strategies-for-efficient-use-of-memory.html</a></p>\n<h2 id=\"1-2-向量化\"><a href=\"#1-2-向量化\" class=\"headerlink\" title=\"1. 2 向量化\"></a>1. 2 向量化</h2><p>官方定义：</p>\n<blockquote>\n<p>修正基于循环且面向标量的代码以使用 MATLAB 矩阵和向量运算的过程称为<em><strong>向量化</strong></em>。</p>\n</blockquote>\n<p>简单来说，就是替代for循环做一些简单操作，以提高运行速度、可读性、正确性。即，算法流程控制<code>for</code>循环，简单操作向量化。</p>\n<p><strong>向量化是matlab的一个重要特点，这在其他语言很少出现</strong></p>\n<p>向量化的语句通常有底层的支持，利用到了CPU指令集进行优化，因此速度较快。</p>\n<p>for循环遍历慢的原因是matlab为解释性语言。</p>\n<h3 id=\"求1至10000的每个数的正弦的和\"><a href=\"#求1至10000的每个数的正弦的和\" class=\"headerlink\" title=\"求1至10000的每个数的正弦的和\"></a>求1至10000的每个数的正弦的和</h3><p><strong>循环写法：</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">all_sum = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">1e4</span></span><br><span class=\"line\">\tall_sum = all_sum + <span class=\"built_in\">sin</span>(<span class=\"built_in\">i</span>);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;all_sum: &#x27;</span>, num2str(all_sum)])</span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% all_sum: 1.6339</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 0.038938 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>向量化写法：</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">all_sum = sum(<span class=\"built_in\">sin</span>(<span class=\"number\">1</span>:<span class=\"number\">1e4</span>));</span><br><span class=\"line\"><span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;all_sum: &#x27;</span>, num2str(all_sum)])</span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% all_sum: 1.6339</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 0.008211 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p>为什么<code>all_sum</code>这么小？</p>\n<h3 id=\"隐式扩展，求每个人每科成绩与平均值的差距\"><a href=\"#隐式扩展，求每个人每科成绩与平均值的差距\" class=\"headerlink\" title=\"隐式扩展，求每个人每科成绩与平均值的差距\"></a>隐式扩展，求每个人每科成绩与平均值的差距</h3><figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">% 每个人有三门课，</span></span><br><span class=\"line\">A = [<span class=\"number\">97</span> <span class=\"number\">89</span> <span class=\"number\">84</span>; </span><br><span class=\"line\">     <span class=\"number\">95</span> <span class=\"number\">82</span> <span class=\"number\">92</span>; </span><br><span class=\"line\">     <span class=\"number\">64</span> <span class=\"number\">80</span> <span class=\"number\">99</span>;</span><br><span class=\"line\">     <span class=\"number\">76</span> <span class=\"number\">77</span> <span class=\"number\">67</span>;</span><br><span class=\"line\">     <span class=\"number\">88</span> <span class=\"number\">59</span> <span class=\"number\">74</span>; </span><br><span class=\"line\">     <span class=\"number\">78</span> <span class=\"number\">66</span> <span class=\"number\">87</span>; </span><br><span class=\"line\">     <span class=\"number\">55</span> <span class=\"number\">93</span> <span class=\"number\">85</span>];\t\t<span class=\"comment\">% 每一列是一个人</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>循环写法</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mA = <span class=\"built_in\">mean</span>(A);\t\t\t<span class=\"comment\">% 求每列的平均值</span></span><br><span class=\"line\">B = <span class=\"built_in\">zeros</span>(<span class=\"built_in\">size</span>(A));\t\t<span class=\"comment\">% 记录每个人每门课的差距</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> n = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A,<span class=\"number\">2</span>)\t\t<span class=\"comment\">% 对每一列进行操作</span></span><br><span class=\"line\">    B(:,n) = A(:,n) - mA(n);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>向量化写法</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">devA = A - mean(A)</span><br></pre></td></tr></table></figure>\n\n<p>注意，在向量化写法中，<code>mean(A)</code>的结果是1c 3大小的。即使 <code>A</code> 是一个 7×3 矩阵，<code>mean(A)</code> 是一个 1×3 向量，MATLAB 也会隐式扩展该向量，就好像其大小与矩阵相同一样，并且该运算将作为正常的按元素减法运算来执行。（广播操作）</p>\n<h3 id=\"逻辑索引，线性索引，下标索引\"><a href=\"#逻辑索引，线性索引，下标索引\" class=\"headerlink\" title=\"逻辑索引，线性索引，下标索引\"></a>逻辑索引，线性索引，下标索引</h3><p><strong>介绍三种索引方式的区别</strong></p>\n<p>一个矩阵A ，寻找这个矩阵中大于500的数字的行列数</p>\n<p><strong>循环方法</strong>（单个循环，获得线性索引，双层循环，获得行列数）</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A = <span class=\"built_in\">magic</span>(<span class=\"number\">100</span>);</span><br><span class=\"line\">tic</span><br><span class=\"line\">sub = <span class=\"built_in\">zeros</span>(sum(A&gt;<span class=\"number\">500</span>, <span class=\"string\">&#x27;all&#x27;</span>), <span class=\"number\">2</span>);</span><br><span class=\"line\">count = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">100</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"number\">100</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> A(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>) &gt; <span class=\"number\">500</span></span><br><span class=\"line\">\t\t\tsub(count,:) = [<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>];</span><br><span class=\"line\">\t\t\tcount = count + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">end</span></span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br></pre></td></tr></table></figure>\n\n<p><strong>find方法</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A = magic(100);</span><br><span class=\"line\">tic</span><br><span class=\"line\">[row, col] = find(A&gt;500);</span><br><span class=\"line\">sub = [row, col];</span><br><span class=\"line\">toc</span><br></pre></td></tr></table></figure>\n\n<p><strong>处处用find真的合适吗？</strong></p>\n<p>求矩阵A中，所有大于500的数的和</p>\n<p><code>sum(A(find(A&gt;500)))</code>线性索引</p>\n<!-- ../images/20240712/image-20231001192302431.png -->\n<p><img src=\"/../images/20240712/image-20230930182045754.png\" alt=\"image-20230930182045754\"></p>\n<p><code>sum(A&gt;500))</code>这里直接使用了逻辑索引</p>\n<p><strong>注意：在for循环中，尽量不用注意：在for 循环中，尽量不用find，有些慢。如果不得不使用for获取满足条件的索引，先记录线性索引，然后用ind2sub()函数转化</strong></p>\n<h3 id=\"重复数组\"><a href=\"#重复数组\" class=\"headerlink\" title=\"重复数组\"></a>重复数组</h3><p>根据向量、矩阵创造大的矩阵</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A = <span class=\"built_in\">repmat</span>(<span class=\"number\">1</span>:<span class=\"number\">3</span>,<span class=\"number\">5</span>,<span class=\"number\">2</span>)</span><br><span class=\"line\">B = <span class=\"built_in\">repmat</span>([<span class=\"number\">1</span> <span class=\"number\">2</span>; <span class=\"number\">3</span> <span class=\"number\">4</span>],<span class=\"number\">2</span>,<span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% A =</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%     1     2     3     1     2     3</span></span><br><span class=\"line\"><span class=\"comment\">%     1     2     3     1     2     3</span></span><br><span class=\"line\"><span class=\"comment\">%     1     2     3     1     2     3</span></span><br><span class=\"line\"><span class=\"comment\">%     1     2     3     1     2     3</span></span><br><span class=\"line\"><span class=\"comment\">%     1     2     3     1     2     3</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% B =</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%     1     2     1     2</span></span><br><span class=\"line\"><span class=\"comment\">%     3     4     3     4</span></span><br><span class=\"line\"><span class=\"comment\">%     1     2     1     2</span></span><br><span class=\"line\"><span class=\"comment\">%     3     4     3     4</span></span><br></pre></td></tr></table></figure>\n\n<p>思考题：多个等间隔指针的轮盘赌如何向量化（随机遍历抽样，遗传算法中经常使用的一个选择方法）？</p>\n<p>参考链接：<a href=\"https://ww2.mathworks.cn/help/matlab/matlab_prog/vectorization.html\">https://ww2.mathworks.cn/help/matlab/matlab_prog/vectorization.html</a></p>\n<h2 id=\"1-3-冗余运算\"><a href=\"#1-3-冗余运算\" class=\"headerlink\" title=\"1. 3 冗余运算\"></a>1. 3 冗余运算</h2><p>消除for循环中的冗余运算有助于提升算法的性能。能放到外层的，就放到外层。</p>\n<p>给定一个矩阵A，要求A的每个数乘以当前行数，在加上当前列数，再加一个固定的数</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">1</span>) <span class=\"comment\">% 行</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">2</span>)</span><br><span class=\"line\">\t\t<span class=\"built_in\">fix</span> = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\ttmp = A(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>);</span><br><span class=\"line\">\t\ttmp = tmp * <span class=\"built_in\">i</span> + <span class=\"built_in\">j</span>;</span><br><span class=\"line\">\t\tA(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>) = tmp + <span class=\"built_in\">fix</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class=\"line\"><span class=\"comment\">% fix 提出</span></span><br><span class=\"line\"><span class=\"built_in\">fix</span> = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">1</span>) <span class=\"comment\">% 行</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">2</span>)</span><br><span class=\"line\">\t\ttmp = A(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>);</span><br><span class=\"line\">\t\ttmp = tmp * <span class=\"built_in\">i</span> + <span class=\"built_in\">j</span>;</span><br><span class=\"line\">\t\tA(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>) = tmp + <span class=\"built_in\">fix</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">fix</span> = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">1</span>) <span class=\"comment\">% 行</span></span><br><span class=\"line\">\tA(<span class=\"built_in\">i</span>,:) = A(<span class=\"built_in\">i</span>,:) * <span class=\"built_in\">i</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">2</span>)</span><br><span class=\"line\">\t\tA(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>) = A(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>) + <span class=\"built_in\">j</span> + <span class=\"built_in\">fix</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class=\"line\"><span class=\"comment\">% 向量化</span></span><br><span class=\"line\">A = (<span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">1</span>))&#x27; .* A + (<span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">2</span>)) + <span class=\"built_in\">fix</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"1-4-性能分析\"><a href=\"#1-4-性能分析\" class=\"headerlink\" title=\"1. 4 性能分析\"></a>1. 4 性能分析</h2><p><strong>我的代码怎么这么慢？想改，改什么呢？</strong></p>\n<p>这个时候，需要使用探查器进行代码性能分析</p>\n<p>比如对debug.m脚本（模拟禁忌搜索的过程）进行性能分析：</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">% debug.m</span></span><br><span class=\"line\"><span class=\"comment\">% 模拟禁忌搜索的过程</span></span><br><span class=\"line\">tic</span><br><span class=\"line\">tabu = <span class=\"built_in\">zeros</span>(<span class=\"number\">30</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">1e5</span></span><br><span class=\"line\">    rand_int = [randi(<span class=\"number\">15</span>), randi(<span class=\"number\">15</span>)];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">ismember</span>(rand_int, tabu, <span class=\"string\">&quot;rows&quot;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">continue</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        tabu = [rand_int; tabu(<span class=\"number\">1</span>:<span class=\"keyword\">end</span><span class=\"number\">-1</span>, :)];</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br></pre></td></tr></table></figure>\n\n<p><strong>Step 1. 打开探查器</strong></p>\n<p><img src=\"/../images/20240712/image-20230930192441679.png\" alt=\"image-20230930192441679\"></p>\n<p><strong>Step 2. 在探查器中运行代码</strong></p>\n<p><img src=\"/../images/20240712/image-20230930192625728.png\" alt=\"image-20230930192625728\"></p>\n<p><strong>Step 3. 点击函数名称 获得具体情况</strong></p>\n<p><img src=\"/../images/20240712/image-20230930192855816.png\" alt=\"image-20230930192855816\"></p>\n<p>发现原来是<code>ismember</code>函数运行太慢了，所以根据问题特性，我们自己写一个<code>my_ismember</code>函数，替换原有的<code>ismember</code>函数。</p>\n<p>原<code>ismember</code>函数耗时4.931秒，自己写的<code>my_ismember</code>函数耗时0.937秒。</p>\n<p><img src=\"/../images/20240712/image-20230930194758499.png\" alt=\"image-20230930194758499\"></p>\n<p>上述例子说明：</p>\n<ul>\n<li><p>不一定内置函数就足够好，一些函数内置函数为了支持各种数据类型、大小，还是很慢的</p>\n</li>\n<li><p>根据问题、数据结果特征进行重构</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">flag</span> = <span class=\"title\">my_ismember</span><span class=\"params\">(a, b)</span></span></span><br><span class=\"line\"><span class=\"comment\">% 判断a是否在b中</span></span><br><span class=\"line\"></span><br><span class=\"line\">validateattributes(a, &#123;<span class=\"string\">&#x27;numeric&#x27;</span>&#125;, &#123;<span class=\"string\">&#x27;size&#x27;</span>,[<span class=\"number\">1</span>,<span class=\"number\">2</span>]&#125;)</span><br><span class=\"line\">validateattributes(b, &#123;<span class=\"string\">&#x27;numeric&#x27;</span>&#125;, &#123;<span class=\"string\">&#x27;size&#x27;</span>,[<span class=\"built_in\">nan</span>,<span class=\"number\">2</span>]&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">col_1_flag = b(:, <span class=\"number\">1</span>) == a(<span class=\"number\">1</span>);</span><br><span class=\"line\">col_2_flag = b(:, <span class=\"number\">2</span>) == a(<span class=\"number\">2</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> any(col_1_flag &amp; col_2_flag)</span><br><span class=\"line\">    flag = <span class=\"built_in\">true</span>;</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">    flag = <span class=\"built_in\">false</span>;</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong> 探查器中运行的代码速度包括了统计时间，因此比一般方式下运行更慢。</p>\n<p>参考：<a href=\"https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html\">https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html</a></p>\n</li>\n</ul>\n<h2 id=\"1-5-使用更具效率的算法\"><a href=\"#1-5-使用更具效率的算法\" class=\"headerlink\" title=\"1. 5 使用更具效率的算法\"></a>1. 5 使用更具效率的算法</h2><p>有些时候，真正慢的是使用的算法的复杂度很高（<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>甚至<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>, 或者说是算法过于朴素），跟向量化等上述技术无关。这种慢根源于算法的复杂度，解决方法是换个思路重写。</p>\n<h3 id=\"双数之和\"><a href=\"#双数之和\" class=\"headerlink\" title=\"双数之和\"></a>双数之和</h3><p>给定一个整数数组 <code>nums</code> 和一个整数目标值 <code>target</code>，请你在该数组中找出 <strong>和为目标值</strong> <em><code>target</code></em> 的那 <strong>两个</strong> 整数，并返回它们的数组下标。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">% 输入：nums = [2,7,11,15], target = 9</span></span><br><span class=\"line\"><span class=\"comment\">% 输出：[0,1]</span></span><br><span class=\"line\"><span class=\"comment\">% 解释：因为 nums[0] + nums[1] == 9 ，返回 [0, 1] 。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 随机构造</span></span><br><span class=\"line\">rng(<span class=\"built_in\">pi</span>);</span><br><span class=\"line\">nums = [<span class=\"number\">2</span>,<span class=\"number\">7</span>,<span class=\"number\">11</span>,<span class=\"number\">15</span>];</span><br><span class=\"line\">rand_num = randperm(<span class=\"number\">5e4</span>) + <span class=\"number\">20</span>;</span><br><span class=\"line\">nums = [nums, randperm(<span class=\"number\">5e4</span>) + <span class=\"number\">20</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">nums = nums(randperm(<span class=\"built_in\">length</span>(nums))); <span class=\"comment\">% nums长度为50004 </span></span><br><span class=\"line\">target = <span class=\"number\">9</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">tic</span><br><span class=\"line\">two_sum(nums, target)</span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% ans =</span></span><br><span class=\"line\"><span class=\"comment\">%       36335       36975</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 4.324590 秒。</span></span><br><span class=\"line\"></span><br><span class=\"line\">tic</span><br><span class=\"line\">two_sum_hash(nums, target)</span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% ans = </span></span><br><span class=\"line\"><span class=\"comment\">%       36335       36975</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 0.020854 秒。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%  足足200倍速度差距</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>暴力枚举（朴素）算法</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">output</span> = <span class=\"title\">two_sum</span><span class=\"params\">(nums, target)</span></span></span><br><span class=\"line\"><span class=\"comment\">% O(N^2)</span></span><br><span class=\"line\">len_num = <span class=\"built_in\">length</span>(nums);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:len_num</span><br><span class=\"line\">    <span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:len_num</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">i</span> == <span class=\"built_in\">j</span></span><br><span class=\"line\">            <span class=\"keyword\">continue</span></span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> nums(<span class=\"built_in\">i</span>) + nums(<span class=\"built_in\">j</span>) == target</span><br><span class=\"line\">            output = [<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>];</span><br><span class=\"line\">            <span class=\"keyword\">return</span></span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>字典 - 空间换时间</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">output</span> = <span class=\"title\">two_sum_hash</span><span class=\"params\">(nums, target)</span></span></span><br><span class=\"line\"><span class=\"comment\">% 该代码使用了dictionary()， 仅支持2022b以上版本</span></span><br><span class=\"line\"><span class=\"comment\">% O(NlogN)</span></span><br><span class=\"line\">len_num = <span class=\"built_in\">length</span>(nums);</span><br><span class=\"line\">d = dictionary(nums, <span class=\"number\">1</span>:len_num);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:len_num</span><br><span class=\"line\">    val_1 = nums(<span class=\"built_in\">i</span>);</span><br><span class=\"line\">    val_2 = target - val_1;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> isKey(d, val_2) &amp;&amp; d(val_2) ~= <span class=\"built_in\">i</span></span><br><span class=\"line\">        output = [d(val_2), <span class=\"built_in\">i</span>];</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"2-工具箱\"><a href=\"#2-工具箱\" class=\"headerlink\" title=\"2. 工具箱\"></a>2. <font color=\"#dd0000\">工具箱</font></h1><h2 id=\"2-1-Coder\"><a href=\"#2-1-Coder\" class=\"headerlink\" title=\"2.1 Coder\"></a>2.1 Coder</h2><p>Matlab和python一样是一门解释性语言，因此运行速度不如编译型语言（C++等），因此一些复杂的函数运行起来相对较慢。</p>\n<p>不过，Matlab Coder提供了一种方法，使得我们可以将一个函数编译成C或C++或二进制文件，供Matlab使用。步骤如下：</p>\n<p>你需要一个Matlab  Coder工具箱。如果没有，则在附加功能中获取。在顶部APP中打开Coder。</p>\n<p><img src=\"/../images/20240712/image-20231001134101744.png\" alt=\"image-20231001134101744\"></p>\n<p><img src=\"/../images/20240712/image-20231001134208296.png\" alt=\"image-20231001134208296\"></p>\n<ul>\n<li><strong>进入Select环节</strong>：键入你想编译的函数，注意只能是函数，不能是脚本。这里以<code>lagrangian_relax</code>函数为例，然后点击next。<img src=\"/../images/20240712/image-20231001134303941.png\" alt=\"image-20231001134303941\"></li>\n<li><strong>进入 review环节</strong>：在这个环节，Coder会检查你的代码有无问题，这个步骤会检查<code>lagrangian_relax</code>函数调用的所有函数。<img src=\"/../images/20240712/image-20231001134944337.png\" alt=\"image-20231001134944337\"></li>\n</ul>\n<p>在底部出现了一条警告，此时应注意，警告和错误是不同的，程序可以有警告（前提是已知警告产生的原因和后果），错误则不同。错误将直接导致程序运行不通。</p>\n<p>解决完所有问题后，点Next。</p>\n<ul>\n<li><p><strong>进入Define环节：</strong>该环节定义了所有变量的类型&amp;大小。</p>\n<p><img src=\"/../images/20240712/image-20231001135319241.png\" alt=\"image-20231001135319241\"></p>\n<p>在上方的框中，输入调用<code>lagrangian_relax</code>函数的脚本，然后点<code>Autodefine Input Types</code>按钮，等程序运行，所有的变量的大小自动确定。<strong>但是</strong>，自动确定的变量大小类型是固定的，也就是说只能输入这种大小的数据，所以，对一些不确定大小的数据，需要手动将大小调整成inf。点Next，继续。</p>\n</li>\n<li><p><strong>进入 check环节</strong>：Coder会运行之前输入的脚本，检查是否有运行问题、编译问题等等。这一步可能会出现各种报错，这些报错的原因并不是<code>lagrangian_relax</code>函数的结果有问题，而是写脚本的习惯超出编译器可理解的范围，或者编译器认为写的不严谨，数据类型&#x2F;大小匹配等一系列问题。需要逐个修改，直至通过编译。</p>\n</li>\n</ul>\n<p><img src=\"/../images/20240712/image-20231001140304900.png\" alt=\"image-20231001140304900\"></p>\n<ul>\n<li><p><strong>进入 generate环节</strong>：如果仅仅想在matlab中调用编译好的二进制文件提升运行速度，那么选择mex即可，点Geneate等待生成。</p>\n<p><img src=\"/../images/20240712/image-20231001140519650.png\" alt=\"image-20231001140519650\"></p>\n</li>\n<li><p><strong>完成</strong><br><img src=\"/../images/20240712/image-20231001140532936.png\" alt=\"image-20231001140532936\"></p>\n</li>\n</ul>\n<p>接下来，我们就可以像使用一个普通函数一样使用这个mex文件了。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">lagrangian_relax_mex(data, super_cus, param); <span class=\"comment\">% 生成的mex文件</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% Iter:  25; LB:    32233.19; UB*:   42478.36; Cons: 2.000000; Gap:  24.12 % </span></span><br><span class=\"line\"><span class=\"comment\">% LR finish: max iteration</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 3.555206 秒。</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">tic</span><br><span class=\"line\">lagrangian_relax(data, super_cus, param); <span class=\"comment\">% 原来的函数</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% Iter:  25; LB:    32233.19; UB*:   42478.36; Cons: 2.000000; Gap:  24.12 % </span></span><br><span class=\"line\"><span class=\"comment\">% LR finish: max iteration</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 93.820573 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p>可以观察到，两种方法输出的结果是一样的，但是速度差了30倍。</p>\n<p><strong>Coder的缺点：</strong></p>\n<ul>\n<li><p>并不是所有内置函数都支持Coder的，例如dictionary就不支持。不支持的函数会在编译时报错。</p>\n</li>\n<li><p>Coder编译的文件来源于选择的C++编译器，很可能出现mex文件在另一台电脑上无法运行的情况。</p>\n</li>\n<li><p>Coder编译的文件的另一个问题是不能跨平台，mac&#x2F;win&#x2F;linux编译得到的文件时不同的。</p>\n</li>\n</ul>\n<p>参考链接：<a href=\"https://ww2.mathworks.cn/help/releases/R2020b/coder/gs/generating-mex-functions-from-matlab-code-at-the-command-line.html\">通过生成 MEX 函数加快 MATLAB 算法的执行速度</a></p>\n<p>​\t\t\t\t\t<a href=\"https://ww2.mathworks.cn/products/matlab-coder.html\">从 MATLAB 代码生成 C 和 C++ 代码</a></p>\n<p>​\t\t\t\t\t<a href=\"https://zhuanlan.zhihu.com/p/604283307\">MATLAB Coder入门到放弃</a></p>\n<p>​\t\t\t\t\t<a href=\"https://blog.csdn.net/qq_36584460/article/details/110791330\">https://blog.csdn.net/qq_36584460/article/details/110791330</a>\t</p>\n<p><strong>（实操环节），编译一个mex文件并运行</strong></p>\n<h2 id=\"2-2-parallel-computing-toolbox\"><a href=\"#2-2-parallel-computing-toolbox\" class=\"headerlink\" title=\"2. 2 parallel computing toolbox\"></a>2. 2 parallel computing toolbox</h2><p>前面提到过利用多核心进行并行计算，需要并行计算工具箱。</p>\n<blockquote>\n<p>该工具箱通过在本地运行的 worker（MATLAB 计算引擎）上执行应用程序，允许你充分利用多核台式机的处理能力。无需更改代码，即可在集群或云上运行同一个应用程序。还可以将该工具箱与 MATLAB Parallel Server 结合使用，以执行由于太大而无法装入单台机器内存的矩阵计算</p>\n</blockquote>\n<h3 id=\"并行for循环\"><a href=\"#并行for循环\" class=\"headerlink\" title=\"并行for循环\"></a>并行for循环</h3><figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">n = <span class=\"number\">200</span>;</span><br><span class=\"line\">A = <span class=\"number\">500</span>;</span><br><span class=\"line\">a = <span class=\"built_in\">zeros</span>(<span class=\"number\">1</span>,n);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:n</span><br><span class=\"line\">    a(<span class=\"built_in\">i</span>) = <span class=\"built_in\">max</span>(<span class=\"built_in\">abs</span>(eig(<span class=\"built_in\">rand</span>(A))));</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% 历时 37.256415 秒。</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">n = <span class=\"number\">200</span>;</span><br><span class=\"line\">A = <span class=\"number\">500</span>;</span><br><span class=\"line\">a = <span class=\"built_in\">zeros</span>(<span class=\"number\">1</span>,n);</span><br><span class=\"line\"><span class=\"keyword\">parfor</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:n</span><br><span class=\"line\">    a(<span class=\"built_in\">i</span>) = <span class=\"built_in\">max</span>(<span class=\"built_in\">abs</span>(eig(<span class=\"built_in\">rand</span>(A)))); <span class=\"comment\">% 最大 / 绝对 / 特征值 / 随机</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% 历时 8.028954 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p>使用场景：许多简单计算的循环，parfor将循环划分为组，以便每个线程可以执行一组。</p>\n<p><strong>但是，</strong>循环中一组循环的结果依赖前面某次循环的结果时，不能使用并行计算（归约<a href=\"https://ww2.mathworks.cn/help/parallel-computing/reduction-variable.html\">Reduction Variables</a>除外）。并行计算有一系列局限性，而且在一些情况下（例如，广播变量）并不能加速代码运行。</p>\n<p><strong>使用<code>parfor</code>的情况：</strong></p>\n<ul>\n<li>每次的for循环很慢（单个时间长）</li>\n<li>简单计算的多次循环（单个时间短但是数量多）</li>\n<li>多层for嵌套的外层使用parfor更具收益（<strong>思考：为什么？</strong>）</li>\n</ul>\n<p><strong>不推荐用<code>parfor</code>的情况：</strong></p>\n<ul>\n<li>已经将for向量化的情况（向量化比parfor收益更高）</li>\n<li>循环已经很快了（并行化的时间开销更高，包括初始化，分配等）</li>\n</ul>\n<p><strong>强烈反对的情况：</strong></p>\n<ul>\n<li>向量化 -&gt; for循环 -&gt; parfor循环 （反向优化）</li>\n</ul>\n<p><strong><code>for</code>转<code>parfor</code>的一个不可行举例</strong></p>\n<p><img src=\"/../images/20240712/image-20231001201801595.png\" alt=\"image-20231001201801595\"></p>\n<p>for转parfor一定程度上很复杂，有各式各样的规则限制、写法限制，这里只做一个简单介绍。关于什么时候用parfor，如何将for转为parfor，使用parfor的要求，常见问题等，参见<a href=\"https://ww2.mathworks.cn/help/parallel-computing/parallel-for-loops-parfor.html?s_tid=CRUX_lftnav\">parfor文档</a>。</p>\n<p>参考链接：<a href=\"https://ww2.mathworks.cn/products/parallel-computing.html\">在多核计算机、GPU 和集群上执行并行计算</a></p>\n<p><strong>补充：parfor可以和coder结合使用，生成的mex文件也是支持多核计算的</strong></p>\n<h2 id=\"2-3-Symbolic-Math-Toolbox\"><a href=\"#2-3-Symbolic-Math-Toolbox\" class=\"headerlink\" title=\"2. 3 Symbolic Math Toolbox\"></a>2. 3 Symbolic Math Toolbox</h2><p>符号计算工具箱，就是能计算数学公式的一个工具箱，变量不再是数值而是符号。因此可以求计算<strong>定积分</strong>和<strong>不定积分</strong>的<strong>解析解</strong>，计算符号表达式或函数的<strong>导数</strong>，并使用级数展开式逼近函数，等等。</p>\n<p>例如，求<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>∫</mo><mi>a</mi><mi>b</mi></msubsup><mi>sin</mi><mo>⁡</mo><mi>x</mi><mi>d</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\int_a^b \\sin x dx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.3998em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.044em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span><span style=\"top:-3.2579em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span></span>在<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mfrac><mi>π</mi><mn>2</mn></mfrac><mo separator=\"true\">,</mo><mfrac><mrow><mn>3</mn><mi>π</mi></mrow><mn>2</mn></mfrac><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[\\frac{\\pi}{2}, \\frac{3\\pi}{2}]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">]</span></span></span></span>上的积分</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">syms x</span><br><span class=\"line\">int(<span class=\"built_in\">sin</span>(x),<span class=\"built_in\">pi</span>/<span class=\"number\">2</span>,<span class=\"number\">3</span>*<span class=\"built_in\">pi</span>/<span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"comment\">% ans = 0</span></span><br></pre></td></tr></table></figure>\n\n<p>这只是一个简单的例子，表示我们可以使用matlab做这件事，具体应用：</p>\n<p><strong>某博弈论问题求纳什均衡点</strong></p>\n<p>解方程组：</p>\n<p><img src=\"/../images/20240712/image-20240712115425.png\" alt=\"image-20231001203458641\"></p>\n<p>解得四个解中的一个解为纳什均衡点。</p>\n<p><img src=\"/../images/20240712/image-20231001151417317.png\" alt=\"image-20231001151417317\"></p>\n<p><strong>纳什均衡点<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>E</mi><mn>4</mn></msub></mrow><annotation encoding=\"application/x-tex\">E_4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>的雅克比矩阵</strong></p>\n<p><img src=\"/../images/20240712/image-20231001151523651.png\" alt=\"image-20231001151523651\"></p>\n<p><strong>注：符号计算工具箱不支持coder</strong></p>\n<p>如何查看是否支持 coder？详见函数参考文档的底部支持列表</p>\n<h1 id=\"3-技巧经验\"><a href=\"#3-技巧经验\" class=\"headerlink\" title=\"3. 技巧经验\"></a>3. 技巧经验</h1><h2 id=\"3-1-使用结构体进行传参\"><a href=\"#3-1-使用结构体进行传参\" class=\"headerlink\" title=\"3. 1 使用结构体进行传参\"></a>3. 1 使用结构体进行传参</h2><p>假设你有一辆车，车长4米，平时跑72km&#x2F;h，车重1000kg，载重2000kg，现在你写了一个函数<code>f</code>用于估计油耗。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">consume</span> = <span class=\"title\">f</span><span class=\"params\">(len, velocity, weight, capacity)</span></span></span><br><span class=\"line\">\t...</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p>使用结构体封装一下</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vehicle = struct()</span><br><span class=\"line\">vehicle.len = <span class=\"number\">4</span>;</span><br><span class=\"line\">vehicle.velocity = <span class=\"number\">72</span>;</span><br><span class=\"line\">vehicle.weight = <span class=\"number\">1000</span>;</span><br><span class=\"line\">vehicle.capacity = <span class=\"number\">2000</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">consume</span> = <span class=\"title\">f</span><span class=\"params\">(vehicle)</span></span></span><br><span class=\"line\">\t...</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p>包括传出，也可以使用结构体，解决了参数记错的问题。</p>\n<p>consume &#x3D; [1, 2, 3, 4]</p>\n<p>consume. air &#x3D; 1; % 空气阻力产生的燃料消耗</p>\n<p>consume.weight &#x3D; 2; % 重量产生的消耗</p>\n<p>…</p>\n<p>给名字就不容易错了，比consume(1) consume(2) 这种要方便</p>\n<h2 id=\"3-2-使用句柄函数\"><a href=\"#3-2-使用句柄函数\" class=\"headerlink\" title=\"3.2 使用句柄函数@\"></a>3.2 使用句柄函数@</h2><h3 id=\"C-bsxfun-fun-A-B\"><a href=\"#C-bsxfun-fun-A-B\" class=\"headerlink\" title=\"C = bsxfun(fun,A,B)\"></a><code>C = bsxfun(fun,A,B)</code></h3><p>Binary Singleton Expansion Function</p>\n<p>对数组 <code>A</code> 和 <code>B</code> 应用函数句柄 <code>fun</code> 指定的按元素二元运算。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A = [<span class=\"number\">8</span>; <span class=\"number\">17</span>; <span class=\"number\">20</span>; <span class=\"number\">24</span>]</span><br><span class=\"line\">B = [<span class=\"number\">0</span> <span class=\"number\">10</span> <span class=\"number\">21</span>]</span><br><span class=\"line\">C = <span class=\"built_in\">bsxfun</span>(@gt,A,B)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% C = 4x3 logical array</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%    1   0   0</span></span><br><span class=\"line\"><span class=\"comment\">%    1   1   0</span></span><br><span class=\"line\"><span class=\"comment\">%    1   1   0</span></span><br><span class=\"line\"><span class=\"comment\">%    1   1   1</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>其中<code>@gt</code>的意思是大于”greater than”， 因此生成了隐式扩展结果。</p>\n<p>接下来，给定一个向量<code>a</code>和一个向量<code>b</code>，求<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>−</mo><msup><mi>e</mi><mi>b</mi></msup></mrow><annotation encoding=\"application/x-tex\">a-e^b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span></span></span></span>的所有组合的结果。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = [<span class=\"number\">1</span> <span class=\"number\">2</span> <span class=\"number\">3</span> <span class=\"number\">4</span>];</span><br><span class=\"line\">b = [<span class=\"number\">5</span>; <span class=\"number\">6</span>; <span class=\"number\">7</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 第一种方法</span></span><br><span class=\"line\">c = <span class=\"built_in\">zeros</span>(<span class=\"built_in\">length</span>(b), <span class=\"built_in\">length</span>(a));</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">length</span>(a)</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">length</span>(b)</span><br><span class=\"line\">\t\tc(<span class=\"built_in\">j</span>,<span class=\"built_in\">i</span>) = a(<span class=\"built_in\">i</span>) - <span class=\"built_in\">exp</span>(b(<span class=\"built_in\">j</span>));</span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"built_in\">disp</span>(c)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 第二种方法</span></span><br><span class=\"line\">f = @(a, b) a - <span class=\"built_in\">exp</span>(b);</span><br><span class=\"line\">c = <span class=\"built_in\">bsxfun</span>(f, a, b);</span><br><span class=\"line\"><span class=\"built_in\">disp</span>(c)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"A-cellfun-func-C\"><a href=\"#A-cellfun-func-C\" class=\"headerlink\" title=\"A = cellfun(func, C)\"></a><code>A = cellfun(func, C)</code></h3><p> 对元胞数组<code>C</code>的每个元胞进行操作。</p>\n<p>获取元胞数组中，每个元胞的大小</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C = cell(<span class=\"number\">3</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">C&#123;<span class=\"number\">1</span>,<span class=\"number\">1</span>&#125; = <span class=\"string\">&#x27;Sunday&#x27;</span>;</span><br><span class=\"line\">C&#123;<span class=\"number\">2</span>,<span class=\"number\">1</span>&#125; = <span class=\"built_in\">magic</span>(<span class=\"number\">3</span>);</span><br><span class=\"line\">C&#123;<span class=\"number\">3</span>,<span class=\"number\">1</span>&#125; = <span class=\"number\">1</span>:<span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 循环操作</span></span><br><span class=\"line\">A = <span class=\"built_in\">zeros</span>(<span class=\"built_in\">size</span>(C, <span class=\"number\">1</span>), <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(C, <span class=\"number\">1</span>)</span><br><span class=\"line\">\tA(<span class=\"built_in\">i</span>) = <span class=\"built_in\">length</span>(C&#123;<span class=\"built_in\">i</span>,<span class=\"number\">1</span>&#125;(:));</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"built_in\">disp</span>(A)</span><br><span class=\"line\"><span class=\"comment\">% [6; 9; 10]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% cellfun</span></span><br><span class=\"line\">A = <span class=\"built_in\">cellfun</span>(@(x) <span class=\"built_in\">length</span>(x(:)), C)</span><br><span class=\"line\"><span class=\"comment\">% [6; 9; 10]</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"A-structfun-func-S\"><a href=\"#A-structfun-func-S\" class=\"headerlink\" title=\"A = structfun(func, S)\"></a><code>A = structfun(func, S)</code></h3><p>对标量结构体的每个字段应用函数</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">S.f1 = <span class=\"number\">1</span>:<span class=\"number\">10</span>;</span><br><span class=\"line\">S.f2 = [<span class=\"number\">2</span>; <span class=\"number\">4</span>; <span class=\"number\">6</span>];</span><br><span class=\"line\">S.f3 = []</span><br><span class=\"line\"></span><br><span class=\"line\">A = structfun(@<span class=\"built_in\">mean</span>,S)</span><br><span class=\"line\"><span class=\"comment\">% A = 3×1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%     5.5000</span></span><br><span class=\"line\"><span class=\"comment\">%     4.0000</span></span><br><span class=\"line\"><span class=\"comment\">%        NaN</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-3-运行日志\"><a href=\"#3-3-运行日志\" class=\"headerlink\" title=\"3. 3 运行日志\"></a>3. 3 运行日志</h2><p>将命令行窗口文本记录到日志文件中</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">diary <span class=\"string\">&#x27;myDiaryFile.txt&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">10</span></span><br><span class=\"line\">\t<span class=\"built_in\">disp</span>(<span class=\"built_in\">exp</span>(<span class=\"built_in\">i</span>))</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\">diary off</span><br></pre></td></tr></table></figure>\n\n<p>你就会得到一个<code>myDiaryFile.txt</code>文件，用于记录所有打印的结果。</p>\n<p>用处：追踪程序运行状况，运行到哪次迭代？运行到哪一步？配合其他函数，还可以记录何时运行等信息。</p>\n<h2 id=\"3-4-格式化输出\"><a href=\"#3-4-格式化输出\" class=\"headerlink\" title=\"3.4 格式化输出\"></a>3.4 格式化输出</h2><p>格式化字符串</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">formatSpec = <span class=\"string\">&#x27;The array is %dx%d.&#x27;</span>;</span><br><span class=\"line\">A1 = <span class=\"number\">2</span>;</span><br><span class=\"line\">A2 = <span class=\"number\">3</span>;</span><br><span class=\"line\">str = sprintf(formatSpec,A1,A2)</span><br><span class=\"line\"><span class=\"comment\">% str = </span></span><br><span class=\"line\"><span class=\"comment\">% &#x27;The array is 2x3.&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">fprint(formatSpec,A1,A2)</span><br><span class=\"line\"><span class=\"comment\">% &#x27;The array is 2x3.&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p>参考： <a href=\"https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html\">https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html</a></p>\n<p>有什么用？多次运行一个函数，但是输入参数不同时，配合<code>diary</code>函数可生成结果日志</p>\n<p><img src=\"/../images/20240712/image-20231001164150891.png\" alt=\"image-20231001164150891\"></p>\n<p>解放双手，从自动运行做起，拒绝<strong>手动保存</strong>每次的运行结果。</p>\n<h2 id=\"3-5-运行时间\"><a href=\"#3-5-运行时间\" class=\"headerlink\" title=\"3.5 运行时间\"></a>3.5 运行时间</h2><p>想要获取运行了多久？使用<code>tic</code>和<code>toc</code>函数统计代码运行时间。</p>\n<p>高级用法：使用多个tic测量时间</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tStart = tic;           <span class=\"comment\">% pair 2: tic</span></span><br><span class=\"line\">n = <span class=\"number\">10</span>;</span><br><span class=\"line\">T = <span class=\"built_in\">zeros</span>(<span class=\"number\">1</span>,n);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:n</span><br><span class=\"line\">    A = <span class=\"built_in\">rand</span>(<span class=\"number\">12000</span>,<span class=\"number\">4400</span>);</span><br><span class=\"line\">    B = <span class=\"built_in\">rand</span>(<span class=\"number\">12000</span>,<span class=\"number\">4400</span>);</span><br><span class=\"line\">    tic         <span class=\"comment\">% pair 1: tic</span></span><br><span class=\"line\">    C = A.*B;</span><br><span class=\"line\">    T(<span class=\"built_in\">i</span>)= toc;  <span class=\"comment\">% pair 1: toc</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">tMul = sum(T) <span class=\"comment\">% tMul = 0.6037</span></span><br><span class=\"line\">tEnd = toc(tStart) <span class=\"comment\">% tEnd = 11.6301</span></span><br></pre></td></tr></table></figure>\n\n<p>其他统计代码运行时长的方法：</p>\n<p><a href=\"https://ww2.mathworks.cn/help/releases/R2023b/matlab/ref/cputime.html\">t &#x3D; cputime</a></p>\n<p><a href=\"https://www.mathworks.com/help/releases/R2023b/matlab/ref/datetime.html?searchHighlight=datetime&s_tid=doc_srchtitle#d126e310370\">t &#x3D; datetime</a></p>\n<h2 id=\"3-6-多层嵌套\"><a href=\"#3-6-多层嵌套\" class=\"headerlink\" title=\"3.6 多层嵌套\"></a>3.6 多层嵌套</h2><p>看这样一个代码，每月每天你孤单会想起谁：</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> month = <span class=\"number\">1</span>:<span class=\"number\">12</span>  <span class=\"comment\">% 月</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> day = <span class=\"number\">1</span>:<span class=\"number\">30</span> <span class=\"comment\">% 天</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> 孤单？</span><br><span class=\"line\">\t\t\t你想起一个人</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> 想找个人来陪</span><br><span class=\"line\">\t\t\t\t找！</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">end</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">end</span></span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p>上述代码的问题：嵌套太多了，一层一层的嵌套。（写代码的习惯，不影响执行效率，但是影响可读性）</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> month = <span class=\"number\">1</span>:<span class=\"number\">12</span>  <span class=\"comment\">% 月</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> day = <span class=\"number\">1</span>:<span class=\"number\">30</span> <span class=\"comment\">% 天</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> ~ 孤单？ <span class=\"comment\">% 非孤单 &quot;~&quot;取反</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">continue</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">end</span></span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t你想起一个人</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> 想找个人来陪</span><br><span class=\"line\">\t\t\t找！</span><br><span class=\"line\">\t\t<span class=\"keyword\">end</span></span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p>使用continue关键字跳转，避免嵌套，提升可读性</p>\n<h2 id=\"3-7-Latex公式\"><a href=\"#3-7-Latex公式\" class=\"headerlink\" title=\"3.7 Latex公式\"></a>3.7 Latex公式</h2><p>latex是特别常用且提升效率的公式编辑方法，推荐大家使用！</p>\n<p>好处：输入公式时，手不再使用鼠标，全键盘操作</p>\n<p>可以使用的场景：</p>\n<ul>\n<li>word</li>\n<li>markdown</li>\n<li>latex</li>\n<li>mathtype</li>\n<li>matlab</li>\n<li>…</li>\n</ul>\n<h2 id=\"3-8-实时脚本做展示\"><a href=\"#3-8-实时脚本做展示\" class=\"headerlink\" title=\"3.8 实时脚本做展示\"></a>3.8 实时脚本做展示</h2><p>一般不用这个功能做开发，但是实时脚本是良好的展示工具</p>\n<p>类似于 python 的 jupyter notebook</p>\n<p><img src=\"/../images/20240712/image-20231006133646069.png\" alt=\"image-20231006133646069\"></p>\n<h2 id=\"3-9-数值精度问题\"><a href=\"#3-9-数值精度问题\" class=\"headerlink\" title=\"3.9 数值精度问题\"></a>3.9 数值精度问题</h2><p>数值精度问题普遍存在于计算机语言中，我们不讨论产生数值精度的具体原因，只需要知道存在这样的问题。</p>\n<p>例如：</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">0.1</span> + <span class=\"number\">0.2</span> == <span class=\"number\">0.3</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% ans =</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%  logical</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%   0</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>在for循环中，需要避免以下的情况</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">0.0</span>:<span class=\"number\">0.1</span>:<span class=\"number\">1.0</span></span><br><span class=\"line\">    <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;-------------------&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">0.0</span>:<span class=\"number\">0.1</span>:<span class=\"number\">1.0</span>-<span class=\"built_in\">i</span></span><br><span class=\"line\">        k = <span class=\"number\">1.0</span> - <span class=\"built_in\">i</span> - <span class=\"built_in\">j</span>;</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>([<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>,k])</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% -------------------</span></span><br><span class=\"line\"><span class=\"comment\">%    0.7000         0    0.3000</span></span><br><span class=\"line\"><span class=\"comment\">%    0.7000    0.1000    0.2000</span></span><br><span class=\"line\"><span class=\"comment\">%    0.7000    0.2000    0.1000</span></span><br><span class=\"line\"><span class=\"comment\">%    0.7000    0.3000   -0.0000</span></span><br></pre></td></tr></table></figure>\n\n<p>出现一个非常小的负数，极有可能导致bug</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">0</span>:<span class=\"number\">10</span></span><br><span class=\"line\">    <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;-------------------&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">0</span>:(<span class=\"number\">10</span>-<span class=\"built_in\">i</span>)</span><br><span class=\"line\">        k = <span class=\"number\">10</span> - <span class=\"built_in\">i</span> - <span class=\"built_in\">j</span>;</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>([<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>,k] / <span class=\"number\">10</span>)</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\">-------------------</span><br><span class=\"line\">    <span class=\"number\">0.7000</span>         <span class=\"number\">0</span>    <span class=\"number\">0.3000</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"number\">0.7000</span>    <span class=\"number\">0.1000</span>    <span class=\"number\">0.2000</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"number\">0.7000</span>    <span class=\"number\">0.2000</span>    <span class=\"number\">0.1000</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"number\">0.7000</span>    <span class=\"number\">0.3000</span>         <span class=\"number\">0</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"3-10-在线Matlab\"><a href=\"#3-10-在线Matlab\" class=\"headerlink\" title=\"3.10 在线Matlab\"></a>3.10 在线Matlab</h2><p>电脑没有matlab？只要有许可证，就能使用matlab在线编程（<a href=\"https://ww2.mathworks.cn/products/matlab-online.html%EF%BC%89%E3%80%82\">https://ww2.mathworks.cn/products/matlab-online.html）。</a></p>\n<h2 id=\"3-11-Markdown语言\"><a href=\"#3-11-Markdown语言\" class=\"headerlink\" title=\"3.11 Markdown语言\"></a>3.11 Markdown语言</h2><p>本文档就是使用的markdown编写的，这是一种文本标记语言，实现文本的不同格式、样式。</p>\n<h1 id=\"4-如何DEBUG\"><a href=\"#4-如何DEBUG\" class=\"headerlink\" title=\"4. 如何DEBUG\"></a>4. 如何DEBUG</h1><h2 id=\"4-1-断点\"><a href=\"#4-1-断点\" class=\"headerlink\" title=\"4.1 断点\"></a>4.1 断点</h2><p>调试程序是每个编程语言必备的操作，没有人能完美写完一个复杂的代码并且没有任何小错误。当这些错误直观发现不了时，使用断点追踪程序每步的运算有助于发现问题。</p>\n<p><img src=\"/../images/20240712/image-20231001165505931.png\" alt=\"image-20231001165505931\"></p>\n<h2 id=\"4-2-条件断点\"><a href=\"#4-2-条件断点\" class=\"headerlink\" title=\"4.2 条件断点\"></a>4.2 条件断点</h2><p>例如在这个循环中，每次<code>j=3</code>时就报错，我们增加一个条件断点，当满足这个条件时，程序暂停。</p>\n<p><img src=\"/../images/20240712/image-20231001165725593.png\" alt=\"image-20231001165725593\"></p>\n<p><img src=\"/../images/20240712/image-20231001165858415.png\" alt=\"image-20231001165858415\"></p>\n<h2 id=\"4-3-错误暂停\"><a href=\"#4-3-错误暂停\" class=\"headerlink\" title=\"4.3 错误暂停\"></a>4.3 错误暂停</h2><p><img src=\"/../images/20240712/image-20231001165922621.png\" alt=\"image-20231001165922621\"></p>\n<p>建议把出现错误暂停勾选，这样程序会停止在出错的哪一行，有助于分析&#x2F;复现问题。</p>\n<p><img src=\"/../images/20240712/image-20231001165952424.png\" alt=\"image-20231001165952424\"></p>\n<h2 id=\"4-4-搜索问题\"><a href=\"#4-4-搜索问题\" class=\"headerlink\" title=\"4.4 搜索问题\"></a>4.4 搜索问题</h2><p>当一个问题，自己不能解决的时候，我们通常会使用搜索引擎进行检索，如何获得问题的答案？</p>\n<p>例如：</p>\n<blockquote>\n<p>我想删除一个cell数组中空的元胞，保留下非空的元胞</p>\n</blockquote>\n<p>一般我会用 “语言 + 关键词 ”搜索</p>\n<ul>\n<li><p>搜索方法：<code>MATLAB cell删除空元胞</code></p>\n</li>\n<li><p>结果质量：</p>\n<ul>\n<li>Matlab中文论坛 &#x2F; 知乎 &#x2F; 博客园 </li>\n<li>CSDN（垃圾堆里找吃的，但不代表都是垃圾） &#x2F; 简书</li>\n<li>百度知道 （几乎驴唇不对马嘴） &#x2F; 其他小网站</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"/../images/20240712/image-20231001170909421.png\" alt=\"image-20231001170909421\"></p>\n<h2 id=\"4-5-向他人提问\"><a href=\"#4-5-向他人提问\" class=\"headerlink\" title=\"4. 5 向他人提问\"></a>4. 5 <font color=\"#dd0000\">向他人提问</font></h2><p>向他人提问，包括同学、老师、网友等。</p>\n<p>为什么向他人提问很重要？正确的提问方式有助于提升双方沟通效率，快速发现问题。</p>\n<p><strong>错误的提问方式</strong></p>\n<ol>\n<li>不会截图 用手机拍照的</li>\n</ol>\n<img src=\"https://img-blog.csdnimg.cn/975ac90367e0403bb704c1785dd9c27b.jpg?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5b6h6aOOQk_lsJE=,size_20,color_FFFFFF,t_70,g_se,x_16\" alt=\"img\" style=\"zoom: 50%;\" />\n\n<ol start=\"2\">\n<li><p>截图截一半 只截图报错信息traceback， 不截图代码的</p>\n<p><img src=\"/../images/20240712/image-20231001171745717.png\" alt=\"image-20231001171745717\"></p>\n</li>\n<li><p>不截图前后文的</p>\n<blockquote>\n<p>为什么我这句代码报错了？</p>\n</blockquote>\n<p><img src=\"/../images/20240712/image-20231001172136136.png\" alt=\"image-20231001172136136\"></p>\n</li>\n<li><p>自己不思考、不检索，直接问别人的。</p>\n<blockquote>\n<p>我想删除一个cell数组中空的元胞，保留下非空的元胞，matlab怎么写？</p>\n</blockquote>\n</li>\n</ol>\n<p><strong>正确的提问方式</strong>（不仅适用于代码提问）</p>\n<ul>\n<li><p>尽可能详细说出你的问题</p>\n</li>\n<li><p>提供代码（如果是截图，截图要全面）</p>\n</li>\n<li><p>问题如何复现</p>\n</li>\n<li><p>你已经做了什么操作，但是还是不行</p>\n</li>\n<li><p>发送之前读一读你的提问</p>\n<p>举例 1：</p>\n<p><img src=\"/../images/20240712/image-20231001172945916.png\" alt=\"image-20231001172945916\"></p>\n<p>举例 2：<img src=\"/../images/20240712/image-20231001173153802.png\" alt=\"image-20231001173153802\"></p>\n</li>\n</ul>\n<h2 id=\"4-6-文档\"><a href=\"#4-6-文档\" class=\"headerlink\" title=\"4. 6 文档\"></a>4. 6 文档</h2><p>如果你知道matlab的某个函数的名字，但是不会写，那么可以在matlab右上角搜索文档，也可以在命令行中使用<code>help &#39;fun_name&#39;</code>获得文档。</p>\n<p><img src=\"/../images/20240712/image-20231001173452560.png\" alt=\"image-20231001173452560\"></p>\n<p>此外，在命令行中输入<code>doc &#39;fun_name&#39;</code>可以打开在线文档。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">doc <span class=\"built_in\">zeros</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/../images/20240712/image-20231001173620154.png\" alt=\"image-20231001173620154\"></p>\n<h1 id=\"5-外部功能\"><a href=\"#5-外部功能\" class=\"headerlink\" title=\"5. 外部功能\"></a>5. <font color=\"#dd0000\">外部功能</font></h1><h2 id=\"5-1-Python\"><a href=\"#5-1-Python\" class=\"headerlink\" title=\"5.1 Python\"></a>5.1 Python</h2><p>很多时候，我们发现某个功能只在python中有，matlab中没有或者不如python好用。</p>\n<p>这个时候，我们可以写一个python函数，然后让matlab调用这个py函数，再将结果处理成matlab可接收的类型即可。</p>\n<p>举例来说，Gurobi对Python支持远远比matlab好，建模也更加方便，我们可以使用matlab调用python，python调用gurobi来实现：</p>\n<p>首先，我们写一个python调用gurobi的函数<code>grbpy_v.py</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># grbpy_v.py</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> gurobipy <span class=\"keyword\">as</span> gp</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> math</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">model</span>(<span class=\"params\">f, alpha, beta, gamma, mu, kappa</span>):</span><br><span class=\"line\">    <span class=\"comment\"># 集合</span></span><br><span class=\"line\">    I = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(f))</span><br><span class=\"line\">    P = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(alpha[<span class=\"number\">0</span>]))</span><br><span class=\"line\">    N = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(gamma[<span class=\"number\">0</span>]))</span><br><span class=\"line\">    M = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(beta[<span class=\"number\">0</span>]))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 建模</span></span><br><span class=\"line\">    model = gp.Model()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 变量</span></span><br><span class=\"line\">    v = model.addVars((i <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> I), vtype = gp.GRB.BINARY, name =<span class=\"string\">&#x27;v&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 目标</span></span><br><span class=\"line\">    obj = gp.quicksum((f[i] - gp.quicksum(alpha[i,p] <span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> P) \\</span><br><span class=\"line\">                            - gp.quicksum(beta[i,m] - mu[i,m] <span class=\"keyword\">for</span> m <span class=\"keyword\">in</span> M)\\</span><br><span class=\"line\">                            - gp.quicksum(gamma[i,n] - kappa[i,n] <span class=\"keyword\">for</span> n <span class=\"keyword\">in</span> N)) * v[i] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> I) \\</span><br><span class=\"line\">        - gp.quicksum(mu[i,m] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> I <span class=\"keyword\">for</span> m <span class=\"keyword\">in</span> M) \\</span><br><span class=\"line\">        - gp.quicksum(kappa[i,n] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> I <span class=\"keyword\">for</span> n <span class=\"keyword\">in</span> N)</span><br><span class=\"line\">    model.setObjective(obj, sense = gp.GRB.MINIMIZE)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 约束</span></span><br><span class=\"line\">    <span class=\"comment\"># 无</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 求解</span></span><br><span class=\"line\">    model.Params.OutputFlag = <span class=\"number\">0</span></span><br><span class=\"line\">    model.Params.MIPGap = <span class=\"number\">0.01</span></span><br><span class=\"line\">    model.optimize()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 整理</span></span><br><span class=\"line\">    loc = np.zeros([<span class=\"number\">1</span>,<span class=\"built_in\">len</span>(f)])</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> I:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> math.isclose(v[i].X, <span class=\"number\">1</span>):</span><br><span class=\"line\">            loc[<span class=\"number\">0</span>,i] = <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    obj_val = model.getAttr(<span class=\"string\">&#x27;ObjVal&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> (loc, obj_val)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>然后，我们写一个matlab脚本（函数）调用这个py函数</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">py.importlib.reload(py.importlib.import_module(<span class=\"string\">&#x27;grbpy_v&#x27;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">fix_ws_py = py.numpy.array(fixed_ws);</span><br><span class=\"line\">alpha_py  = py.numpy.array(alpha);</span><br><span class=\"line\">beta_py   = py.numpy.array(<span class=\"built_in\">beta</span>);</span><br><span class=\"line\">mu_py     = py.numpy.array(mu);</span><br><span class=\"line\">gamma_py  = py.numpy.array(<span class=\"built_in\">gamma</span>);</span><br><span class=\"line\">kappa_py  = py.numpy.array(kappa);</span><br><span class=\"line\"></span><br><span class=\"line\">res = py.grbpy_v.model(fix_ws_py, alpha_py, beta_py, gamma_py, mu_py, kappa_py);</span><br></pre></td></tr></table></figure>\n\n<p>注意上述存在类型转换，需要把matlab的矩阵转成python的numpy矩阵才可以使用。</p>\n<p>参考：<a href=\"https://www.mathworks.com/help/releases/R2023b/matlab/call-python-libraries.html?s_tid=doc_srchtitle\">从 MATLAB 中调用 Python</a></p>\n<h2 id=\"5-2-Gurobi-（运筹）\"><a href=\"#5-2-Gurobi-（运筹）\" class=\"headerlink\" title=\"5. 2 Gurobi （运筹）\"></a>5. 2 Gurobi （运筹）</h2><p>Gurobi是一款求解器，做运筹优化方面常常会用到，这里将介绍直接使用matlab调用gurobi，不借助其他软件或包。</p>\n<p>来源于Guorbi官方文档：</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">facility</span><span class=\"params\">()</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Copyright 2023, Gurobi Optimization, LLC</span></span><br><span class=\"line\"><span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"comment\">% Facility location: a company currently ships its product from 5 plants</span></span><br><span class=\"line\"><span class=\"comment\">% to 4 warehouses. It is considering closing some plants to reduce</span></span><br><span class=\"line\"><span class=\"comment\">% costs. What plant(s) should the company close, in order to minimize</span></span><br><span class=\"line\"><span class=\"comment\">% transportation and fixed costs?</span></span><br><span class=\"line\"><span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"comment\">% Note that this example uses lists instead of dictionaries.  Since</span></span><br><span class=\"line\"><span class=\"comment\">% it does not work with sparse data, lists are a reasonable option.</span></span><br><span class=\"line\"><span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"comment\">% Based on an example from Frontline Systems:</span></span><br><span class=\"line\"><span class=\"comment\">%   http://www.solver.com/disfacility.htm</span></span><br><span class=\"line\"><span class=\"comment\">% Used with permission.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% define primitive data</span></span><br><span class=\"line\">nPlants     = <span class=\"number\">5</span>;</span><br><span class=\"line\">nWarehouses = <span class=\"number\">4</span>;</span><br><span class=\"line\"><span class=\"comment\">% Warehouse demand in thousands of units</span></span><br><span class=\"line\">Demand      = [<span class=\"number\">15</span>; <span class=\"number\">18</span>; <span class=\"number\">14</span>; <span class=\"number\">20</span>];</span><br><span class=\"line\"><span class=\"comment\">% Plant capacity in thousands of units</span></span><br><span class=\"line\">Capacity    = [<span class=\"number\">20</span>; <span class=\"number\">22</span>; <span class=\"number\">17</span>; <span class=\"number\">19</span>; <span class=\"number\">18</span>];</span><br><span class=\"line\"><span class=\"comment\">% Fixed costs for each plant</span></span><br><span class=\"line\">FixedCosts  = [<span class=\"number\">12000</span>; <span class=\"number\">15000</span>; <span class=\"number\">17000</span>; <span class=\"number\">13000</span>; <span class=\"number\">16000</span>];</span><br><span class=\"line\"><span class=\"comment\">% Transportation costs per thousand units</span></span><br><span class=\"line\">TransCosts  = [</span><br><span class=\"line\">    <span class=\"number\">4000</span>; <span class=\"number\">2000</span>; <span class=\"number\">3000</span>; <span class=\"number\">2500</span>; <span class=\"number\">4500</span>;</span><br><span class=\"line\">    <span class=\"number\">2500</span>; <span class=\"number\">2600</span>; <span class=\"number\">3400</span>; <span class=\"number\">3000</span>; <span class=\"number\">4000</span>;</span><br><span class=\"line\">    <span class=\"number\">1200</span>; <span class=\"number\">1800</span>; <span class=\"number\">2600</span>; <span class=\"number\">4100</span>; <span class=\"number\">3000</span>;</span><br><span class=\"line\">    <span class=\"number\">2200</span>; <span class=\"number\">2600</span>; <span class=\"number\">3100</span>; <span class=\"number\">3700</span>; <span class=\"number\">3200</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Index helper function</span></span><br><span class=\"line\">flowidx = @(w, p) nPlants * w + p;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Build model</span></span><br><span class=\"line\">model.modelname = <span class=\"string\">&#x27;facility&#x27;</span>;</span><br><span class=\"line\">model.modelsense = <span class=\"string\">&#x27;min&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Set data for variables</span></span><br><span class=\"line\">ncol = nPlants + nPlants * nWarehouses;</span><br><span class=\"line\">model.lb    = <span class=\"built_in\">zeros</span>(ncol, <span class=\"number\">1</span>);</span><br><span class=\"line\">model.ub    = [<span class=\"built_in\">ones</span>(nPlants, <span class=\"number\">1</span>); <span class=\"built_in\">inf</span>(nPlants * nWarehouses, <span class=\"number\">1</span>)];</span><br><span class=\"line\">model.obj   = [FixedCosts; TransCosts];</span><br><span class=\"line\">model.vtype = [<span class=\"built_in\">repmat</span>(<span class=\"string\">&#x27;B&#x27;</span>, nPlants, <span class=\"number\">1</span>); <span class=\"built_in\">repmat</span>(<span class=\"string\">&#x27;C&#x27;</span>, nPlants * nWarehouses, <span class=\"number\">1</span>)];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> p = <span class=\"number\">1</span>:nPlants</span><br><span class=\"line\">    model.varnames&#123;p&#125; = sprintf(<span class=\"string\">&#x27;Open%d&#x27;</span>, p);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> w = <span class=\"number\">1</span>:nWarehouses</span><br><span class=\"line\">    <span class=\"keyword\">for</span> p = <span class=\"number\">1</span>:nPlants</span><br><span class=\"line\">        v = flowidx(w, p);</span><br><span class=\"line\">        model.varnames&#123;v&#125; = sprintf(<span class=\"string\">&#x27;Trans%d,%d&#x27;</span>, w, p);</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Set data for constraints and matrix</span></span><br><span class=\"line\">nrow = nPlants + nWarehouses;</span><br><span class=\"line\">model.A     = sparse(nrow, ncol);</span><br><span class=\"line\">model.rhs   = [<span class=\"built_in\">zeros</span>(nPlants, <span class=\"number\">1</span>); Demand];</span><br><span class=\"line\">model.sense = [<span class=\"built_in\">repmat</span>(<span class=\"string\">&#x27;&lt;&#x27;</span>, nPlants, <span class=\"number\">1</span>); <span class=\"built_in\">repmat</span>(<span class=\"string\">&#x27;=&#x27;</span>, nWarehouses, <span class=\"number\">1</span>)];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Production constraints</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> p = <span class=\"number\">1</span>:nPlants</span><br><span class=\"line\">    <span class=\"keyword\">for</span> w = <span class=\"number\">1</span>:nWarehouses</span><br><span class=\"line\">        model.A(p, p) = -Capacity(p);</span><br><span class=\"line\">        model.A(p, flowidx(w, p)) = <span class=\"number\">1.0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\">    model.constrnames&#123;p&#125; = sprintf(<span class=\"string\">&#x27;Capacity%d&#x27;</span>, p);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Demand constraints</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> w = <span class=\"number\">1</span>:nWarehouses</span><br><span class=\"line\">    <span class=\"keyword\">for</span> p = <span class=\"number\">1</span>:nPlants</span><br><span class=\"line\">        model.A(nPlants+w, flowidx(w, p)) = <span class=\"number\">1.0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\">    model.constrnames&#123;nPlants+w&#125; = sprintf(<span class=\"string\">&#x27;Demand%d&#x27;</span>, w);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Save model</span></span><br><span class=\"line\">gurobi_write(model,<span class=\"string\">&#x27;facility_m.lp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Guess at the starting point: close the plant with the highest fixed</span></span><br><span class=\"line\"><span class=\"comment\">% costs; open all others first open all plants</span></span><br><span class=\"line\">model.start = [<span class=\"built_in\">ones</span>(nPlants, <span class=\"number\">1</span>); <span class=\"built_in\">inf</span>(nPlants * nWarehouses, <span class=\"number\">1</span>)];</span><br><span class=\"line\">[~, idx] = <span class=\"built_in\">max</span>(FixedCosts);</span><br><span class=\"line\">model.start(idx) = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Set parameters</span></span><br><span class=\"line\">params.method = <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Optimize</span></span><br><span class=\"line\">res = gurobi(model, params);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Print solution</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> strcmp(res.status, <span class=\"string\">&#x27;OPTIMAL&#x27;</span>)</span><br><span class=\"line\">    fprintf(<span class=\"string\">&#x27;\\nTotal Costs: %g\\n&#x27;</span>, res.objval);</span><br><span class=\"line\">    fprintf(<span class=\"string\">&#x27;solution:\\n&#x27;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> p = <span class=\"number\">1</span>:nPlants</span><br><span class=\"line\">        <span class=\"keyword\">if</span> res.x(p) &gt; <span class=\"number\">0.99</span></span><br><span class=\"line\">            fprintf(<span class=\"string\">&#x27;Plant %d open:\\n&#x27;</span>, p);</span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> w = <span class=\"number\">1</span>:nWarehouses</span><br><span class=\"line\">            <span class=\"keyword\">if</span> res.x(flowidx(w, p)) &gt; <span class=\"number\">0.0001</span></span><br><span class=\"line\">                fprintf(<span class=\"string\">&#x27;  Transport %g units to warehouse %d\\n&#x27;</span>, res.x(flowidx(w, p)), w);</span><br><span class=\"line\">            <span class=\"keyword\">end</span></span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">    fprintf(<span class=\"string\">&#x27;\\n No solution\\n&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>想表达的是，gurobi对matlab很不友好：</p>\n<ul>\n<li>系数矩阵必须是自己算明白索引后，转换为一个稀疏矩阵。</li>\n<li>很难按照约束一条一条添加</li>\n<li>有些gurobi功能matlab不能使用</li>\n</ul>\n<p>同样模型，python的版本</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python3.7</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Copyright 2023, Gurobi Optimization, LLC</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Facility location: a company currently ships its product from 5 plants</span></span><br><span class=\"line\"><span class=\"comment\"># to 4 warehouses. It is considering closing some plants to reduce</span></span><br><span class=\"line\"><span class=\"comment\"># costs. What plant(s) should the company close, in order to minimize</span></span><br><span class=\"line\"><span class=\"comment\"># transportation and fixed costs?</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># Note that this example uses lists instead of dictionaries.  Since</span></span><br><span class=\"line\"><span class=\"comment\"># it does not work with sparse data, lists are a reasonable option.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># Based on an example from Frontline Systems:</span></span><br><span class=\"line\"><span class=\"comment\">#   http://www.solver.com/disfacility.htm</span></span><br><span class=\"line\"><span class=\"comment\"># Used with permission.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> gurobipy <span class=\"keyword\">as</span> gp</span><br><span class=\"line\"><span class=\"keyword\">from</span> gurobipy <span class=\"keyword\">import</span> GRB</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Warehouse demand in thousands of units</span></span><br><span class=\"line\">demand = [<span class=\"number\">15</span>, <span class=\"number\">18</span>, <span class=\"number\">14</span>, <span class=\"number\">20</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Plant capacity in thousands of units</span></span><br><span class=\"line\">capacity = [<span class=\"number\">20</span>, <span class=\"number\">22</span>, <span class=\"number\">17</span>, <span class=\"number\">19</span>, <span class=\"number\">18</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Fixed costs for each plant</span></span><br><span class=\"line\">fixedCosts = [<span class=\"number\">12000</span>, <span class=\"number\">15000</span>, <span class=\"number\">17000</span>, <span class=\"number\">13000</span>, <span class=\"number\">16000</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Transportation costs per thousand units</span></span><br><span class=\"line\">transCosts = [[<span class=\"number\">4000</span>, <span class=\"number\">2000</span>, <span class=\"number\">3000</span>, <span class=\"number\">2500</span>, <span class=\"number\">4500</span>],</span><br><span class=\"line\">              [<span class=\"number\">2500</span>, <span class=\"number\">2600</span>, <span class=\"number\">3400</span>, <span class=\"number\">3000</span>, <span class=\"number\">4000</span>],</span><br><span class=\"line\">              [<span class=\"number\">1200</span>, <span class=\"number\">1800</span>, <span class=\"number\">2600</span>, <span class=\"number\">4100</span>, <span class=\"number\">3000</span>],</span><br><span class=\"line\">              [<span class=\"number\">2200</span>, <span class=\"number\">2600</span>, <span class=\"number\">3100</span>, <span class=\"number\">3700</span>, <span class=\"number\">3200</span>]]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Range of plants and warehouses</span></span><br><span class=\"line\">plants = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(capacity))</span><br><span class=\"line\">warehouses = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(demand))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Model</span></span><br><span class=\"line\">m = gp.Model(<span class=\"string\">&quot;facility&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Plant open decision variables: open[p] == 1 if plant p is open.</span></span><br><span class=\"line\"><span class=\"built_in\">open</span> = m.addVars(plants,</span><br><span class=\"line\">                 vtype=GRB.BINARY,</span><br><span class=\"line\">                 obj=fixedCosts,</span><br><span class=\"line\">                 name=<span class=\"string\">&quot;open&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Transportation decision variables: transport[w,p] captures the</span></span><br><span class=\"line\"><span class=\"comment\"># optimal quantity to transport to warehouse w from plant p</span></span><br><span class=\"line\">transport = m.addVars(warehouses, plants, obj=transCosts, name=<span class=\"string\">&quot;trans&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># You could use Python looping constructs and m.addVar() to create</span></span><br><span class=\"line\"><span class=\"comment\"># these decision variables instead.  The following would be equivalent</span></span><br><span class=\"line\"><span class=\"comment\"># to the preceding two statements...</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># open = []</span></span><br><span class=\"line\"><span class=\"comment\"># for p in plants:</span></span><br><span class=\"line\"><span class=\"comment\">#     open.append(m.addVar(vtype=GRB.BINARY,</span></span><br><span class=\"line\"><span class=\"comment\">#                          obj=fixedCosts[p],</span></span><br><span class=\"line\"><span class=\"comment\">#                          name=&quot;open[%d]&quot; % p))</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># transport = []</span></span><br><span class=\"line\"><span class=\"comment\"># for w in warehouses:</span></span><br><span class=\"line\"><span class=\"comment\">#     transport.append([])</span></span><br><span class=\"line\"><span class=\"comment\">#     for p in plants:</span></span><br><span class=\"line\"><span class=\"comment\">#         transport[w].append(m.addVar(obj=transCosts[w][p],</span></span><br><span class=\"line\"><span class=\"comment\">#                                      name=&quot;trans[%d,%d]&quot; % (w, p)))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The objective is to minimize the total fixed and variable costs</span></span><br><span class=\"line\">m.ModelSense = GRB.MINIMIZE</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Production constraints</span></span><br><span class=\"line\"><span class=\"comment\"># Note that the right-hand limit sets the production to zero if the plant</span></span><br><span class=\"line\"><span class=\"comment\"># is closed</span></span><br><span class=\"line\">m.addConstrs(</span><br><span class=\"line\">    (transport.<span class=\"built_in\">sum</span>(<span class=\"string\">&#x27;*&#x27;</span>, p) &lt;= capacity[p]*<span class=\"built_in\">open</span>[p] <span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> plants), <span class=\"string\">&quot;Capacity&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Using Python looping constructs, the preceding would be...</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># for p in plants:</span></span><br><span class=\"line\"><span class=\"comment\">#     m.addConstr(sum(transport[w][p] for w in warehouses)</span></span><br><span class=\"line\"><span class=\"comment\">#                 &lt;= capacity[p] * open[p], &quot;Capacity[%d]&quot; % p)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Demand constraints</span></span><br><span class=\"line\">m.addConstrs(</span><br><span class=\"line\">    (transport.<span class=\"built_in\">sum</span>(w) == demand[w] <span class=\"keyword\">for</span> w <span class=\"keyword\">in</span> warehouses),</span><br><span class=\"line\">    <span class=\"string\">&quot;Demand&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ... and the preceding would be ...</span></span><br><span class=\"line\"><span class=\"comment\"># for w in warehouses:</span></span><br><span class=\"line\"><span class=\"comment\">#     m.addConstr(sum(transport[w][p] for p in plants) == demand[w],</span></span><br><span class=\"line\"><span class=\"comment\">#                 &quot;Demand[%d]&quot; % w)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Save model</span></span><br><span class=\"line\">m.write(<span class=\"string\">&#x27;facilityPY.lp&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Guess at the starting point: close the plant with the highest fixed costs;</span></span><br><span class=\"line\"><span class=\"comment\"># open all others</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># First open all plants</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> plants:</span><br><span class=\"line\">    <span class=\"built_in\">open</span>[p].Start = <span class=\"number\">1.0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Now close the plant with the highest fixed cost</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Initial guess:&#x27;</span>)</span><br><span class=\"line\">maxFixed = <span class=\"built_in\">max</span>(fixedCosts)</span><br><span class=\"line\"><span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> plants:</span><br><span class=\"line\">    <span class=\"keyword\">if</span> fixedCosts[p] == maxFixed:</span><br><span class=\"line\">        <span class=\"built_in\">open</span>[p].Start = <span class=\"number\">0.0</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Closing plant %s&#x27;</span> % p)</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Use barrier to solve root relaxation</span></span><br><span class=\"line\">m.Params.Method = <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Solve</span></span><br><span class=\"line\">m.optimize()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Print solution</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\nTOTAL COSTS: %g&#x27;</span> % m.ObjVal)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;SOLUTION:&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> plants:</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">open</span>[p].X &gt; <span class=\"number\">0.99</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Plant %s open&#x27;</span> % p)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> w <span class=\"keyword\">in</span> warehouses:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> transport[w, p].X &gt; <span class=\"number\">0</span>:</span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;  Transport %g units to warehouse %s&#x27;</span> %</span><br><span class=\"line\">                      (transport[w, p].X, w))</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Plant %s closed!&#x27;</span> % p)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"5-3-Yalmip-（运筹）\"><a href=\"#5-3-Yalmip-（运筹）\" class=\"headerlink\" title=\"5.3 Yalmip （运筹）\"></a>5.3 Yalmip （运筹）</h2><p>yalmip是一款基于matlab进行数学建模的包，或者说是一种基于matlab的建模语言，使用yalmip的好处是解决了matlab建模的痛点，并且可以调用多个求解器对模型进行求解。</p>\n<p>然而，求解器方面，如果用gurobi &#x2F; COPT，则一般使用python建模。如果用cplex，则使用java。</p>\n<p>如果不会别的语言，必须使用matlab进行建模和求解的话，yalmip无疑是最好的选择。</p>\n<h2 id=\"5-4-gramm（画图）\"><a href=\"#5-4-gramm（画图）\" class=\"headerlink\" title=\"5.4 gramm（画图）\"></a>5.4 gramm（画图）</h2><p>gramm是基于matlab开发的一个绘图工具，可以画很多好看的图。</p>\n<p>matlab的图一般都很丑，需要自己不断调试。而gramm默认的配色，基本可以直接使用。</p>\n<p><img src=\"/../images/20240712/image-20231001184526448.png\" alt=\"image-20231001184526448\"></p>\n<p>参考：</p>\n<p><a href=\"https://www.mathworks.com/matlabcentral/fileexchange/54465-gramm-complete-data-visualization-toolbox-ggplot2-r-like\">https://www.mathworks.com/matlabcentral/fileexchange/54465-gramm-complete-data-visualization-toolbox-ggplot2-r-like</a></p>\n<p><a href=\"https://github.com/piermorel/gramm\">https://github.com/piermorel/gramm</a></p>\n<h1 id=\"6-One-more-thing\"><a href=\"#6-One-more-thing\" class=\"headerlink\" title=\"6. One more thing\"></a>6. One more thing</h1><p>科研常用工具列表，成为一个合格的板砖人（科研民工）</p>\n<table>\n<thead>\n<tr>\n<th>名字</th>\n<th>价格</th>\n<th>用处</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Office三件套</td>\n<td>学校提供</td>\n<td>略</td>\n</tr>\n<tr>\n<td>Mathtype</td>\n<td>收费</td>\n<td>数学公式编辑（推荐搭配latex数学命令使用）</td>\n</tr>\n<tr>\n<td>Typora</td>\n<td>收费</td>\n<td>markdown编辑器，本次分享使用markdown完成</td>\n</tr>\n<tr>\n<td>VScode</td>\n<td>免费</td>\n<td>地表最强编辑器，我用vscode开发python, latex, markdown</td>\n</tr>\n<tr>\n<td>Notion</td>\n<td>免费</td>\n<td>个人知识库（上手很慢，但是可以很好规划你的生活）</td>\n</tr>\n<tr>\n<td>Endnote</td>\n<td>学校提供</td>\n<td>个人文献库（直接插入国标引用格式到word）</td>\n</tr>\n<tr>\n<td>Calibre</td>\n<td>免费</td>\n<td>个人图书馆</td>\n</tr>\n<tr>\n<td>百度云</td>\n<td>功能收费</td>\n<td>备份+同步（一年不到200块，同步文件+备份文件）</td>\n</tr>\n<tr>\n<td>Office 365</td>\n<td>收费</td>\n<td>与Office年度版本不同，这是订阅制的office，享受更多功能+1T 云盘</td>\n</tr>\n<tr>\n<td>Acrobat DC</td>\n<td>收费</td>\n<td>PDF编辑器</td>\n</tr>\n<tr>\n<td>Latex</td>\n<td>免费</td>\n<td>写期刊论文使用，直接输出pdf</td>\n</tr>\n<tr>\n<td>Overleaf &#x2F; Slagger</td>\n<td>免费</td>\n<td>在线latex</td>\n</tr>\n<tr>\n<td>Powertoys</td>\n<td>免费</td>\n<td>Windows拓展工具（非常强大，保持唤醒、取色、分屏等等等）</td>\n</tr>\n<tr>\n<td>Steam &#x2F; Epic</td>\n<td>?</td>\n<td>玩</td>\n</tr>\n</tbody></table>\n<h1 id=\"7-结语\"><a href=\"#7-结语\" class=\"headerlink\" title=\"7. 结语\"></a>7. 结语</h1><ol>\n<li>使用正版，获得更多的技术支持，工具箱，社区等。</li>\n<li>使用新版，获得更多的功能，更快的运行，更美的界面。</li>\n<li>如果想用matlab，那就<strong>多写多练</strong>。</li>\n<li>Matlab真的好用吗？好用不一定，但真的简单，个人认为比Python简单。</li>\n<li>只进行数值计算则matlab不是唯一选择（python, java等都可以），matlab的精髓是工具箱和仿真。</li>\n</ol>\n<hr>\n<p>感谢各位！</p>\n","excerpt":"","more":"<p>记录在学校的一次matlab课上的技术分享。</p>\n<p><strong>前言</strong>：本次分享主要内容是介绍一些常用的技术，目的是让大家了解遇到某种编程需求该怎么做，用什么方法解决什么问题。</p>\n<p><strong>假设</strong>：各位已经掌握matlab的基本方法，并且自己也会写一些简单代码了。</p>\n<h1 id=\"1-代码优化\"><a href=\"#1-代码优化\" class=\"headerlink\" title=\"1. 代码优化\"></a>1. 代码优化</h1><p><strong>Q：为什么我的代码这么慢？</strong></p>\n<p><strong>A：解释型语言就是比编译型语言慢 + 代码未优化</strong></p>\n<h2 id=\"1-1-预分配内存\"><a href=\"#1-1-预分配内存\" class=\"headerlink\" title=\"1. 1 预分配内存\"></a>1. 1 预分配内存</h2><p>在进行循环语句时，应当先声明变量所需空间的大小，再进行循环，避免每次循环向数组中增加数字。</p>\n<p><strong>不推荐写法</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">1000</span></span><br><span class=\"line\">\tmat(<span class=\"built_in\">i</span>,<span class=\"built_in\">i</span>) = <span class=\"built_in\">i</span>;</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% 历时 0.115061 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>推荐写法</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">mat_2 = <span class=\"built_in\">zeros</span>(<span class=\"number\">1000</span>); <span class=\"comment\">% 先把数组的大小声明，在内存中开辟一块空间</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">1000</span></span><br><span class=\"line\">\tmat_2(<span class=\"built_in\">i</span>,<span class=\"built_in\">i</span>) = <span class=\"built_in\">i</span>;</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% 历时 0.005585 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>为什么出现这样的差异？</strong></p>\n<p>反复调整数组的大小将导致花费额外的时间找到更大的、<strong>连续的</strong>内存空间。</p>\n<p><strong>所有类型的变量都需要这样做吗</strong></p>\n<p>不一定，cell类型则不需要，但是放在cell中的数据类型可能需要。cell数组内存不连续，但是每个cell要求连续内存。（这也是看情况的，cell在编译成mex文件时，同样需要初始化内存）</p>\n<p>参考链接：</p>\n<p><a href=\"https://ww2.mathworks.cn/help/matlab/matlab_prog/preallocating-arrays.html\">https://ww2.mathworks.cn/help/matlab/matlab_prog/preallocating-arrays.html</a></p>\n<p><a href=\"https://ww2.mathworks.cn/help/matlab/matlab_prog/techniques-for-improving-performance.html\">https://ww2.mathworks.cn/help/matlab/matlab_prog/techniques-for-improving-performance.html</a></p>\n<p><a href=\"https://ww2.mathworks.cn/help/matlab/matlab_prog/avoid-unnecessary-copies-of-data.html\">https://ww2.mathworks.cn/help/matlab/matlab_prog/avoid-unnecessary-copies-of-data.html</a></p>\n<p><a href=\"https://ww2.mathworks.cn/help/matlab/matlab_prog/strategies-for-efficient-use-of-memory.html\">https://ww2.mathworks.cn/help/matlab/matlab_prog/strategies-for-efficient-use-of-memory.html</a></p>\n<h2 id=\"1-2-向量化\"><a href=\"#1-2-向量化\" class=\"headerlink\" title=\"1. 2 向量化\"></a>1. 2 向量化</h2><p>官方定义：</p>\n<blockquote>\n<p>修正基于循环且面向标量的代码以使用 MATLAB 矩阵和向量运算的过程称为<em><strong>向量化</strong></em>。</p>\n</blockquote>\n<p>简单来说，就是替代for循环做一些简单操作，以提高运行速度、可读性、正确性。即，算法流程控制<code>for</code>循环，简单操作向量化。</p>\n<p><strong>向量化是matlab的一个重要特点，这在其他语言很少出现</strong></p>\n<p>向量化的语句通常有底层的支持，利用到了CPU指令集进行优化，因此速度较快。</p>\n<p>for循环遍历慢的原因是matlab为解释性语言。</p>\n<h3 id=\"求1至10000的每个数的正弦的和\"><a href=\"#求1至10000的每个数的正弦的和\" class=\"headerlink\" title=\"求1至10000的每个数的正弦的和\"></a>求1至10000的每个数的正弦的和</h3><p><strong>循环写法：</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">all_sum = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">1e4</span></span><br><span class=\"line\">\tall_sum = all_sum + <span class=\"built_in\">sin</span>(<span class=\"built_in\">i</span>);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;all_sum: &#x27;</span>, num2str(all_sum)])</span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% all_sum: 1.6339</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 0.038938 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>向量化写法：</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">all_sum = sum(<span class=\"built_in\">sin</span>(<span class=\"number\">1</span>:<span class=\"number\">1e4</span>));</span><br><span class=\"line\"><span class=\"built_in\">disp</span>([<span class=\"string\">&#x27;all_sum: &#x27;</span>, num2str(all_sum)])</span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% all_sum: 1.6339</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 0.008211 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p>为什么<code>all_sum</code>这么小？</p>\n<h3 id=\"隐式扩展，求每个人每科成绩与平均值的差距\"><a href=\"#隐式扩展，求每个人每科成绩与平均值的差距\" class=\"headerlink\" title=\"隐式扩展，求每个人每科成绩与平均值的差距\"></a>隐式扩展，求每个人每科成绩与平均值的差距</h3><figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">% 每个人有三门课，</span></span><br><span class=\"line\">A = [<span class=\"number\">97</span> <span class=\"number\">89</span> <span class=\"number\">84</span>; </span><br><span class=\"line\">     <span class=\"number\">95</span> <span class=\"number\">82</span> <span class=\"number\">92</span>; </span><br><span class=\"line\">     <span class=\"number\">64</span> <span class=\"number\">80</span> <span class=\"number\">99</span>;</span><br><span class=\"line\">     <span class=\"number\">76</span> <span class=\"number\">77</span> <span class=\"number\">67</span>;</span><br><span class=\"line\">     <span class=\"number\">88</span> <span class=\"number\">59</span> <span class=\"number\">74</span>; </span><br><span class=\"line\">     <span class=\"number\">78</span> <span class=\"number\">66</span> <span class=\"number\">87</span>; </span><br><span class=\"line\">     <span class=\"number\">55</span> <span class=\"number\">93</span> <span class=\"number\">85</span>];\t\t<span class=\"comment\">% 每一列是一个人</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>循环写法</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mA = <span class=\"built_in\">mean</span>(A);\t\t\t<span class=\"comment\">% 求每列的平均值</span></span><br><span class=\"line\">B = <span class=\"built_in\">zeros</span>(<span class=\"built_in\">size</span>(A));\t\t<span class=\"comment\">% 记录每个人每门课的差距</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> n = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A,<span class=\"number\">2</span>)\t\t<span class=\"comment\">% 对每一列进行操作</span></span><br><span class=\"line\">    B(:,n) = A(:,n) - mA(n);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>向量化写法</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">devA = A - mean(A)</span><br></pre></td></tr></table></figure>\n\n<p>注意，在向量化写法中，<code>mean(A)</code>的结果是1c 3大小的。即使 <code>A</code> 是一个 7×3 矩阵，<code>mean(A)</code> 是一个 1×3 向量，MATLAB 也会隐式扩展该向量，就好像其大小与矩阵相同一样，并且该运算将作为正常的按元素减法运算来执行。（广播操作）</p>\n<h3 id=\"逻辑索引，线性索引，下标索引\"><a href=\"#逻辑索引，线性索引，下标索引\" class=\"headerlink\" title=\"逻辑索引，线性索引，下标索引\"></a>逻辑索引，线性索引，下标索引</h3><p><strong>介绍三种索引方式的区别</strong></p>\n<p>一个矩阵A ，寻找这个矩阵中大于500的数字的行列数</p>\n<p><strong>循环方法</strong>（单个循环，获得线性索引，双层循环，获得行列数）</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A = <span class=\"built_in\">magic</span>(<span class=\"number\">100</span>);</span><br><span class=\"line\">tic</span><br><span class=\"line\">sub = <span class=\"built_in\">zeros</span>(sum(A&gt;<span class=\"number\">500</span>, <span class=\"string\">&#x27;all&#x27;</span>), <span class=\"number\">2</span>);</span><br><span class=\"line\">count = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">100</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"number\">100</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> A(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>) &gt; <span class=\"number\">500</span></span><br><span class=\"line\">\t\t\tsub(count,:) = [<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>];</span><br><span class=\"line\">\t\t\tcount = count + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">end</span></span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br></pre></td></tr></table></figure>\n\n<p><strong>find方法</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A = magic(100);</span><br><span class=\"line\">tic</span><br><span class=\"line\">[row, col] = find(A&gt;500);</span><br><span class=\"line\">sub = [row, col];</span><br><span class=\"line\">toc</span><br></pre></td></tr></table></figure>\n\n<p><strong>处处用find真的合适吗？</strong></p>\n<p>求矩阵A中，所有大于500的数的和</p>\n<p><code>sum(A(find(A&gt;500)))</code>线性索引</p>\n<!-- ../images/20240712/image-20231001192302431.png -->\n<p><img src=\"/../images/20240712/image-20230930182045754.png\" alt=\"image-20230930182045754\"></p>\n<p><code>sum(A&gt;500))</code>这里直接使用了逻辑索引</p>\n<p><strong>注意：在for循环中，尽量不用注意：在for 循环中，尽量不用find，有些慢。如果不得不使用for获取满足条件的索引，先记录线性索引，然后用ind2sub()函数转化</strong></p>\n<h3 id=\"重复数组\"><a href=\"#重复数组\" class=\"headerlink\" title=\"重复数组\"></a>重复数组</h3><p>根据向量、矩阵创造大的矩阵</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A = <span class=\"built_in\">repmat</span>(<span class=\"number\">1</span>:<span class=\"number\">3</span>,<span class=\"number\">5</span>,<span class=\"number\">2</span>)</span><br><span class=\"line\">B = <span class=\"built_in\">repmat</span>([<span class=\"number\">1</span> <span class=\"number\">2</span>; <span class=\"number\">3</span> <span class=\"number\">4</span>],<span class=\"number\">2</span>,<span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% A =</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%     1     2     3     1     2     3</span></span><br><span class=\"line\"><span class=\"comment\">%     1     2     3     1     2     3</span></span><br><span class=\"line\"><span class=\"comment\">%     1     2     3     1     2     3</span></span><br><span class=\"line\"><span class=\"comment\">%     1     2     3     1     2     3</span></span><br><span class=\"line\"><span class=\"comment\">%     1     2     3     1     2     3</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% B =</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%     1     2     1     2</span></span><br><span class=\"line\"><span class=\"comment\">%     3     4     3     4</span></span><br><span class=\"line\"><span class=\"comment\">%     1     2     1     2</span></span><br><span class=\"line\"><span class=\"comment\">%     3     4     3     4</span></span><br></pre></td></tr></table></figure>\n\n<p>思考题：多个等间隔指针的轮盘赌如何向量化（随机遍历抽样，遗传算法中经常使用的一个选择方法）？</p>\n<p>参考链接：<a href=\"https://ww2.mathworks.cn/help/matlab/matlab_prog/vectorization.html\">https://ww2.mathworks.cn/help/matlab/matlab_prog/vectorization.html</a></p>\n<h2 id=\"1-3-冗余运算\"><a href=\"#1-3-冗余运算\" class=\"headerlink\" title=\"1. 3 冗余运算\"></a>1. 3 冗余运算</h2><p>消除for循环中的冗余运算有助于提升算法的性能。能放到外层的，就放到外层。</p>\n<p>给定一个矩阵A，要求A的每个数乘以当前行数，在加上当前列数，再加一个固定的数</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">1</span>) <span class=\"comment\">% 行</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">2</span>)</span><br><span class=\"line\">\t\t<span class=\"built_in\">fix</span> = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\ttmp = A(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>);</span><br><span class=\"line\">\t\ttmp = tmp * <span class=\"built_in\">i</span> + <span class=\"built_in\">j</span>;</span><br><span class=\"line\">\t\tA(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>) = tmp + <span class=\"built_in\">fix</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class=\"line\"><span class=\"comment\">% fix 提出</span></span><br><span class=\"line\"><span class=\"built_in\">fix</span> = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">1</span>) <span class=\"comment\">% 行</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">2</span>)</span><br><span class=\"line\">\t\ttmp = A(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>);</span><br><span class=\"line\">\t\ttmp = tmp * <span class=\"built_in\">i</span> + <span class=\"built_in\">j</span>;</span><br><span class=\"line\">\t\tA(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>) = tmp + <span class=\"built_in\">fix</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">fix</span> = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">1</span>) <span class=\"comment\">% 行</span></span><br><span class=\"line\">\tA(<span class=\"built_in\">i</span>,:) = A(<span class=\"built_in\">i</span>,:) * <span class=\"built_in\">i</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">2</span>)</span><br><span class=\"line\">\t\tA(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>) = A(<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>) + <span class=\"built_in\">j</span> + <span class=\"built_in\">fix</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span><br><span class=\"line\"><span class=\"comment\">% 向量化</span></span><br><span class=\"line\">A = (<span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">1</span>))&#x27; .* A + (<span class=\"number\">1</span>:<span class=\"built_in\">size</span>(A, <span class=\"number\">2</span>)) + <span class=\"built_in\">fix</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"1-4-性能分析\"><a href=\"#1-4-性能分析\" class=\"headerlink\" title=\"1. 4 性能分析\"></a>1. 4 性能分析</h2><p><strong>我的代码怎么这么慢？想改，改什么呢？</strong></p>\n<p>这个时候，需要使用探查器进行代码性能分析</p>\n<p>比如对debug.m脚本（模拟禁忌搜索的过程）进行性能分析：</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">% debug.m</span></span><br><span class=\"line\"><span class=\"comment\">% 模拟禁忌搜索的过程</span></span><br><span class=\"line\">tic</span><br><span class=\"line\">tabu = <span class=\"built_in\">zeros</span>(<span class=\"number\">30</span>, <span class=\"number\">2</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">1e5</span></span><br><span class=\"line\">    rand_int = [randi(<span class=\"number\">15</span>), randi(<span class=\"number\">15</span>)];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">ismember</span>(rand_int, tabu, <span class=\"string\">&quot;rows&quot;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">continue</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        tabu = [rand_int; tabu(<span class=\"number\">1</span>:<span class=\"keyword\">end</span><span class=\"number\">-1</span>, :)];</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br></pre></td></tr></table></figure>\n\n<p><strong>Step 1. 打开探查器</strong></p>\n<p><img src=\"/../images/20240712/image-20230930192441679.png\" alt=\"image-20230930192441679\"></p>\n<p><strong>Step 2. 在探查器中运行代码</strong></p>\n<p><img src=\"/../images/20240712/image-20230930192625728.png\" alt=\"image-20230930192625728\"></p>\n<p><strong>Step 3. 点击函数名称 获得具体情况</strong></p>\n<p><img src=\"/../images/20240712/image-20230930192855816.png\" alt=\"image-20230930192855816\"></p>\n<p>发现原来是<code>ismember</code>函数运行太慢了，所以根据问题特性，我们自己写一个<code>my_ismember</code>函数，替换原有的<code>ismember</code>函数。</p>\n<p>原<code>ismember</code>函数耗时4.931秒，自己写的<code>my_ismember</code>函数耗时0.937秒。</p>\n<p><img src=\"/../images/20240712/image-20230930194758499.png\" alt=\"image-20230930194758499\"></p>\n<p>上述例子说明：</p>\n<ul>\n<li><p>不一定内置函数就足够好，一些函数内置函数为了支持各种数据类型、大小，还是很慢的</p>\n</li>\n<li><p>根据问题、数据结果特征进行重构</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">flag</span> = <span class=\"title\">my_ismember</span><span class=\"params\">(a, b)</span></span></span><br><span class=\"line\"><span class=\"comment\">% 判断a是否在b中</span></span><br><span class=\"line\"></span><br><span class=\"line\">validateattributes(a, &#123;<span class=\"string\">&#x27;numeric&#x27;</span>&#125;, &#123;<span class=\"string\">&#x27;size&#x27;</span>,[<span class=\"number\">1</span>,<span class=\"number\">2</span>]&#125;)</span><br><span class=\"line\">validateattributes(b, &#123;<span class=\"string\">&#x27;numeric&#x27;</span>&#125;, &#123;<span class=\"string\">&#x27;size&#x27;</span>,[<span class=\"built_in\">nan</span>,<span class=\"number\">2</span>]&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">col_1_flag = b(:, <span class=\"number\">1</span>) == a(<span class=\"number\">1</span>);</span><br><span class=\"line\">col_2_flag = b(:, <span class=\"number\">2</span>) == a(<span class=\"number\">2</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> any(col_1_flag &amp; col_2_flag)</span><br><span class=\"line\">    flag = <span class=\"built_in\">true</span>;</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">    flag = <span class=\"built_in\">false</span>;</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>注意：</strong> 探查器中运行的代码速度包括了统计时间，因此比一般方式下运行更慢。</p>\n<p>参考：<a href=\"https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html\">https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html</a></p>\n</li>\n</ul>\n<h2 id=\"1-5-使用更具效率的算法\"><a href=\"#1-5-使用更具效率的算法\" class=\"headerlink\" title=\"1. 5 使用更具效率的算法\"></a>1. 5 使用更具效率的算法</h2><p>有些时候，真正慢的是使用的算法的复杂度很高（<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>甚至<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(n^3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>, 或者说是算法过于朴素），跟向量化等上述技术无关。这种慢根源于算法的复杂度，解决方法是换个思路重写。</p>\n<h3 id=\"双数之和\"><a href=\"#双数之和\" class=\"headerlink\" title=\"双数之和\"></a>双数之和</h3><p>给定一个整数数组 <code>nums</code> 和一个整数目标值 <code>target</code>，请你在该数组中找出 <strong>和为目标值</strong> <em><code>target</code></em> 的那 <strong>两个</strong> 整数，并返回它们的数组下标。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">% 输入：nums = [2,7,11,15], target = 9</span></span><br><span class=\"line\"><span class=\"comment\">% 输出：[0,1]</span></span><br><span class=\"line\"><span class=\"comment\">% 解释：因为 nums[0] + nums[1] == 9 ，返回 [0, 1] 。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 随机构造</span></span><br><span class=\"line\">rng(<span class=\"built_in\">pi</span>);</span><br><span class=\"line\">nums = [<span class=\"number\">2</span>,<span class=\"number\">7</span>,<span class=\"number\">11</span>,<span class=\"number\">15</span>];</span><br><span class=\"line\">rand_num = randperm(<span class=\"number\">5e4</span>) + <span class=\"number\">20</span>;</span><br><span class=\"line\">nums = [nums, randperm(<span class=\"number\">5e4</span>) + <span class=\"number\">20</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">nums = nums(randperm(<span class=\"built_in\">length</span>(nums))); <span class=\"comment\">% nums长度为50004 </span></span><br><span class=\"line\">target = <span class=\"number\">9</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">tic</span><br><span class=\"line\">two_sum(nums, target)</span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% ans =</span></span><br><span class=\"line\"><span class=\"comment\">%       36335       36975</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 4.324590 秒。</span></span><br><span class=\"line\"></span><br><span class=\"line\">tic</span><br><span class=\"line\">two_sum_hash(nums, target)</span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% ans = </span></span><br><span class=\"line\"><span class=\"comment\">%       36335       36975</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 0.020854 秒。</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%  足足200倍速度差距</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>暴力枚举（朴素）算法</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">output</span> = <span class=\"title\">two_sum</span><span class=\"params\">(nums, target)</span></span></span><br><span class=\"line\"><span class=\"comment\">% O(N^2)</span></span><br><span class=\"line\">len_num = <span class=\"built_in\">length</span>(nums);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:len_num</span><br><span class=\"line\">    <span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:len_num</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">i</span> == <span class=\"built_in\">j</span></span><br><span class=\"line\">            <span class=\"keyword\">continue</span></span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> nums(<span class=\"built_in\">i</span>) + nums(<span class=\"built_in\">j</span>) == target</span><br><span class=\"line\">            output = [<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>];</span><br><span class=\"line\">            <span class=\"keyword\">return</span></span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>字典 - 空间换时间</strong></p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">output</span> = <span class=\"title\">two_sum_hash</span><span class=\"params\">(nums, target)</span></span></span><br><span class=\"line\"><span class=\"comment\">% 该代码使用了dictionary()， 仅支持2022b以上版本</span></span><br><span class=\"line\"><span class=\"comment\">% O(NlogN)</span></span><br><span class=\"line\">len_num = <span class=\"built_in\">length</span>(nums);</span><br><span class=\"line\">d = dictionary(nums, <span class=\"number\">1</span>:len_num);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:len_num</span><br><span class=\"line\">    val_1 = nums(<span class=\"built_in\">i</span>);</span><br><span class=\"line\">    val_2 = target - val_1;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> isKey(d, val_2) &amp;&amp; d(val_2) ~= <span class=\"built_in\">i</span></span><br><span class=\"line\">        output = [d(val_2), <span class=\"built_in\">i</span>];</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"2-工具箱\"><a href=\"#2-工具箱\" class=\"headerlink\" title=\"2. 工具箱\"></a>2. <font color=\"#dd0000\">工具箱</font></h1><h2 id=\"2-1-Coder\"><a href=\"#2-1-Coder\" class=\"headerlink\" title=\"2.1 Coder\"></a>2.1 Coder</h2><p>Matlab和python一样是一门解释性语言，因此运行速度不如编译型语言（C++等），因此一些复杂的函数运行起来相对较慢。</p>\n<p>不过，Matlab Coder提供了一种方法，使得我们可以将一个函数编译成C或C++或二进制文件，供Matlab使用。步骤如下：</p>\n<p>你需要一个Matlab  Coder工具箱。如果没有，则在附加功能中获取。在顶部APP中打开Coder。</p>\n<p><img src=\"/../images/20240712/image-20231001134101744.png\" alt=\"image-20231001134101744\"></p>\n<p><img src=\"/../images/20240712/image-20231001134208296.png\" alt=\"image-20231001134208296\"></p>\n<ul>\n<li><strong>进入Select环节</strong>：键入你想编译的函数，注意只能是函数，不能是脚本。这里以<code>lagrangian_relax</code>函数为例，然后点击next。<img src=\"/../images/20240712/image-20231001134303941.png\" alt=\"image-20231001134303941\"></li>\n<li><strong>进入 review环节</strong>：在这个环节，Coder会检查你的代码有无问题，这个步骤会检查<code>lagrangian_relax</code>函数调用的所有函数。<img src=\"/../images/20240712/image-20231001134944337.png\" alt=\"image-20231001134944337\"></li>\n</ul>\n<p>在底部出现了一条警告，此时应注意，警告和错误是不同的，程序可以有警告（前提是已知警告产生的原因和后果），错误则不同。错误将直接导致程序运行不通。</p>\n<p>解决完所有问题后，点Next。</p>\n<ul>\n<li><p><strong>进入Define环节：</strong>该环节定义了所有变量的类型&amp;大小。</p>\n<p><img src=\"/../images/20240712/image-20231001135319241.png\" alt=\"image-20231001135319241\"></p>\n<p>在上方的框中，输入调用<code>lagrangian_relax</code>函数的脚本，然后点<code>Autodefine Input Types</code>按钮，等程序运行，所有的变量的大小自动确定。<strong>但是</strong>，自动确定的变量大小类型是固定的，也就是说只能输入这种大小的数据，所以，对一些不确定大小的数据，需要手动将大小调整成inf。点Next，继续。</p>\n</li>\n<li><p><strong>进入 check环节</strong>：Coder会运行之前输入的脚本，检查是否有运行问题、编译问题等等。这一步可能会出现各种报错，这些报错的原因并不是<code>lagrangian_relax</code>函数的结果有问题，而是写脚本的习惯超出编译器可理解的范围，或者编译器认为写的不严谨，数据类型&#x2F;大小匹配等一系列问题。需要逐个修改，直至通过编译。</p>\n</li>\n</ul>\n<p><img src=\"/../images/20240712/image-20231001140304900.png\" alt=\"image-20231001140304900\"></p>\n<ul>\n<li><p><strong>进入 generate环节</strong>：如果仅仅想在matlab中调用编译好的二进制文件提升运行速度，那么选择mex即可，点Geneate等待生成。</p>\n<p><img src=\"/../images/20240712/image-20231001140519650.png\" alt=\"image-20231001140519650\"></p>\n</li>\n<li><p><strong>完成</strong><br><img src=\"/../images/20240712/image-20231001140532936.png\" alt=\"image-20231001140532936\"></p>\n</li>\n</ul>\n<p>接下来，我们就可以像使用一个普通函数一样使用这个mex文件了。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">lagrangian_relax_mex(data, super_cus, param); <span class=\"comment\">% 生成的mex文件</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% Iter:  25; LB:    32233.19; UB*:   42478.36; Cons: 2.000000; Gap:  24.12 % </span></span><br><span class=\"line\"><span class=\"comment\">% LR finish: max iteration</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 3.555206 秒。</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">tic</span><br><span class=\"line\">lagrangian_relax(data, super_cus, param); <span class=\"comment\">% 原来的函数</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% Iter:  25; LB:    32233.19; UB*:   42478.36; Cons: 2.000000; Gap:  24.12 % </span></span><br><span class=\"line\"><span class=\"comment\">% LR finish: max iteration</span></span><br><span class=\"line\"><span class=\"comment\">% 历时 93.820573 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p>可以观察到，两种方法输出的结果是一样的，但是速度差了30倍。</p>\n<p><strong>Coder的缺点：</strong></p>\n<ul>\n<li><p>并不是所有内置函数都支持Coder的，例如dictionary就不支持。不支持的函数会在编译时报错。</p>\n</li>\n<li><p>Coder编译的文件来源于选择的C++编译器，很可能出现mex文件在另一台电脑上无法运行的情况。</p>\n</li>\n<li><p>Coder编译的文件的另一个问题是不能跨平台，mac&#x2F;win&#x2F;linux编译得到的文件时不同的。</p>\n</li>\n</ul>\n<p>参考链接：<a href=\"https://ww2.mathworks.cn/help/releases/R2020b/coder/gs/generating-mex-functions-from-matlab-code-at-the-command-line.html\">通过生成 MEX 函数加快 MATLAB 算法的执行速度</a></p>\n<p>​\t\t\t\t\t<a href=\"https://ww2.mathworks.cn/products/matlab-coder.html\">从 MATLAB 代码生成 C 和 C++ 代码</a></p>\n<p>​\t\t\t\t\t<a href=\"https://zhuanlan.zhihu.com/p/604283307\">MATLAB Coder入门到放弃</a></p>\n<p>​\t\t\t\t\t<a href=\"https://blog.csdn.net/qq_36584460/article/details/110791330\">https://blog.csdn.net/qq_36584460/article/details/110791330</a>\t</p>\n<p><strong>（实操环节），编译一个mex文件并运行</strong></p>\n<h2 id=\"2-2-parallel-computing-toolbox\"><a href=\"#2-2-parallel-computing-toolbox\" class=\"headerlink\" title=\"2. 2 parallel computing toolbox\"></a>2. 2 parallel computing toolbox</h2><p>前面提到过利用多核心进行并行计算，需要并行计算工具箱。</p>\n<blockquote>\n<p>该工具箱通过在本地运行的 worker（MATLAB 计算引擎）上执行应用程序，允许你充分利用多核台式机的处理能力。无需更改代码，即可在集群或云上运行同一个应用程序。还可以将该工具箱与 MATLAB Parallel Server 结合使用，以执行由于太大而无法装入单台机器内存的矩阵计算</p>\n</blockquote>\n<h3 id=\"并行for循环\"><a href=\"#并行for循环\" class=\"headerlink\" title=\"并行for循环\"></a>并行for循环</h3><figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">n = <span class=\"number\">200</span>;</span><br><span class=\"line\">A = <span class=\"number\">500</span>;</span><br><span class=\"line\">a = <span class=\"built_in\">zeros</span>(<span class=\"number\">1</span>,n);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:n</span><br><span class=\"line\">    a(<span class=\"built_in\">i</span>) = <span class=\"built_in\">max</span>(<span class=\"built_in\">abs</span>(eig(<span class=\"built_in\">rand</span>(A))));</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% 历时 37.256415 秒。</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tic</span><br><span class=\"line\">n = <span class=\"number\">200</span>;</span><br><span class=\"line\">A = <span class=\"number\">500</span>;</span><br><span class=\"line\">a = <span class=\"built_in\">zeros</span>(<span class=\"number\">1</span>,n);</span><br><span class=\"line\"><span class=\"keyword\">parfor</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:n</span><br><span class=\"line\">    a(<span class=\"built_in\">i</span>) = <span class=\"built_in\">max</span>(<span class=\"built_in\">abs</span>(eig(<span class=\"built_in\">rand</span>(A)))); <span class=\"comment\">% 最大 / 绝对 / 特征值 / 随机</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">toc</span><br><span class=\"line\"><span class=\"comment\">% 历时 8.028954 秒。</span></span><br></pre></td></tr></table></figure>\n\n<p>使用场景：许多简单计算的循环，parfor将循环划分为组，以便每个线程可以执行一组。</p>\n<p><strong>但是，</strong>循环中一组循环的结果依赖前面某次循环的结果时，不能使用并行计算（归约<a href=\"https://ww2.mathworks.cn/help/parallel-computing/reduction-variable.html\">Reduction Variables</a>除外）。并行计算有一系列局限性，而且在一些情况下（例如，广播变量）并不能加速代码运行。</p>\n<p><strong>使用<code>parfor</code>的情况：</strong></p>\n<ul>\n<li>每次的for循环很慢（单个时间长）</li>\n<li>简单计算的多次循环（单个时间短但是数量多）</li>\n<li>多层for嵌套的外层使用parfor更具收益（<strong>思考：为什么？</strong>）</li>\n</ul>\n<p><strong>不推荐用<code>parfor</code>的情况：</strong></p>\n<ul>\n<li>已经将for向量化的情况（向量化比parfor收益更高）</li>\n<li>循环已经很快了（并行化的时间开销更高，包括初始化，分配等）</li>\n</ul>\n<p><strong>强烈反对的情况：</strong></p>\n<ul>\n<li>向量化 -&gt; for循环 -&gt; parfor循环 （反向优化）</li>\n</ul>\n<p><strong><code>for</code>转<code>parfor</code>的一个不可行举例</strong></p>\n<p><img src=\"/../images/20240712/image-20231001201801595.png\" alt=\"image-20231001201801595\"></p>\n<p>for转parfor一定程度上很复杂，有各式各样的规则限制、写法限制，这里只做一个简单介绍。关于什么时候用parfor，如何将for转为parfor，使用parfor的要求，常见问题等，参见<a href=\"https://ww2.mathworks.cn/help/parallel-computing/parallel-for-loops-parfor.html?s_tid=CRUX_lftnav\">parfor文档</a>。</p>\n<p>参考链接：<a href=\"https://ww2.mathworks.cn/products/parallel-computing.html\">在多核计算机、GPU 和集群上执行并行计算</a></p>\n<p><strong>补充：parfor可以和coder结合使用，生成的mex文件也是支持多核计算的</strong></p>\n<h2 id=\"2-3-Symbolic-Math-Toolbox\"><a href=\"#2-3-Symbolic-Math-Toolbox\" class=\"headerlink\" title=\"2. 3 Symbolic Math Toolbox\"></a>2. 3 Symbolic Math Toolbox</h2><p>符号计算工具箱，就是能计算数学公式的一个工具箱，变量不再是数值而是符号。因此可以求计算<strong>定积分</strong>和<strong>不定积分</strong>的<strong>解析解</strong>，计算符号表达式或函数的<strong>导数</strong>，并使用级数展开式逼近函数，等等。</p>\n<p>例如，求<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>∫</mo><mi>a</mi><mi>b</mi></msubsup><mi>sin</mi><mo>⁡</mo><mi>x</mi><mi>d</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\int_a^b \\sin x dx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.3998em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.044em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span><span style=\"top:-3.2579em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span></span>在<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mfrac><mi>π</mi><mn>2</mn></mfrac><mo separator=\"true\">,</mo><mfrac><mrow><mn>3</mn><mi>π</mi></mrow><mn>2</mn></mfrac><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[\\frac{\\pi}{2}, \\frac{3\\pi}{2}]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6954em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">]</span></span></span></span>上的积分</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">syms x</span><br><span class=\"line\">int(<span class=\"built_in\">sin</span>(x),<span class=\"built_in\">pi</span>/<span class=\"number\">2</span>,<span class=\"number\">3</span>*<span class=\"built_in\">pi</span>/<span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"comment\">% ans = 0</span></span><br></pre></td></tr></table></figure>\n\n<p>这只是一个简单的例子，表示我们可以使用matlab做这件事，具体应用：</p>\n<p><strong>某博弈论问题求纳什均衡点</strong></p>\n<p>解方程组：</p>\n<p><img src=\"/../images/20240712/image-20240712115425.png\" alt=\"image-20231001203458641\"></p>\n<p>解得四个解中的一个解为纳什均衡点。</p>\n<p><img src=\"/../images/20240712/image-20231001151417317.png\" alt=\"image-20231001151417317\"></p>\n<p><strong>纳什均衡点<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>E</mi><mn>4</mn></msub></mrow><annotation encoding=\"application/x-tex\">E_4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>的雅克比矩阵</strong></p>\n<p><img src=\"/../images/20240712/image-20231001151523651.png\" alt=\"image-20231001151523651\"></p>\n<p><strong>注：符号计算工具箱不支持coder</strong></p>\n<p>如何查看是否支持 coder？详见函数参考文档的底部支持列表</p>\n<h1 id=\"3-技巧经验\"><a href=\"#3-技巧经验\" class=\"headerlink\" title=\"3. 技巧经验\"></a>3. 技巧经验</h1><h2 id=\"3-1-使用结构体进行传参\"><a href=\"#3-1-使用结构体进行传参\" class=\"headerlink\" title=\"3. 1 使用结构体进行传参\"></a>3. 1 使用结构体进行传参</h2><p>假设你有一辆车，车长4米，平时跑72km&#x2F;h，车重1000kg，载重2000kg，现在你写了一个函数<code>f</code>用于估计油耗。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">consume</span> = <span class=\"title\">f</span><span class=\"params\">(len, velocity, weight, capacity)</span></span></span><br><span class=\"line\">\t...</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p>使用结构体封装一下</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vehicle = struct()</span><br><span class=\"line\">vehicle.len = <span class=\"number\">4</span>;</span><br><span class=\"line\">vehicle.velocity = <span class=\"number\">72</span>;</span><br><span class=\"line\">vehicle.weight = <span class=\"number\">1000</span>;</span><br><span class=\"line\">vehicle.capacity = <span class=\"number\">2000</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">consume</span> = <span class=\"title\">f</span><span class=\"params\">(vehicle)</span></span></span><br><span class=\"line\">\t...</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p>包括传出，也可以使用结构体，解决了参数记错的问题。</p>\n<p>consume &#x3D; [1, 2, 3, 4]</p>\n<p>consume. air &#x3D; 1; % 空气阻力产生的燃料消耗</p>\n<p>consume.weight &#x3D; 2; % 重量产生的消耗</p>\n<p>…</p>\n<p>给名字就不容易错了，比consume(1) consume(2) 这种要方便</p>\n<h2 id=\"3-2-使用句柄函数\"><a href=\"#3-2-使用句柄函数\" class=\"headerlink\" title=\"3.2 使用句柄函数@\"></a>3.2 使用句柄函数@</h2><h3 id=\"C-bsxfun-fun-A-B\"><a href=\"#C-bsxfun-fun-A-B\" class=\"headerlink\" title=\"C = bsxfun(fun,A,B)\"></a><code>C = bsxfun(fun,A,B)</code></h3><p>Binary Singleton Expansion Function</p>\n<p>对数组 <code>A</code> 和 <code>B</code> 应用函数句柄 <code>fun</code> 指定的按元素二元运算。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">A = [<span class=\"number\">8</span>; <span class=\"number\">17</span>; <span class=\"number\">20</span>; <span class=\"number\">24</span>]</span><br><span class=\"line\">B = [<span class=\"number\">0</span> <span class=\"number\">10</span> <span class=\"number\">21</span>]</span><br><span class=\"line\">C = <span class=\"built_in\">bsxfun</span>(@gt,A,B)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% C = 4x3 logical array</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%    1   0   0</span></span><br><span class=\"line\"><span class=\"comment\">%    1   1   0</span></span><br><span class=\"line\"><span class=\"comment\">%    1   1   0</span></span><br><span class=\"line\"><span class=\"comment\">%    1   1   1</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>其中<code>@gt</code>的意思是大于”greater than”， 因此生成了隐式扩展结果。</p>\n<p>接下来，给定一个向量<code>a</code>和一个向量<code>b</code>，求<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>−</mo><msup><mi>e</mi><mi>b</mi></msup></mrow><annotation encoding=\"application/x-tex\">a-e^b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span></span></span></span>的所有组合的结果。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a = [<span class=\"number\">1</span> <span class=\"number\">2</span> <span class=\"number\">3</span> <span class=\"number\">4</span>];</span><br><span class=\"line\">b = [<span class=\"number\">5</span>; <span class=\"number\">6</span>; <span class=\"number\">7</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 第一种方法</span></span><br><span class=\"line\">c = <span class=\"built_in\">zeros</span>(<span class=\"built_in\">length</span>(b), <span class=\"built_in\">length</span>(a));</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">length</span>(a)</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">1</span>:<span class=\"built_in\">length</span>(b)</span><br><span class=\"line\">\t\tc(<span class=\"built_in\">j</span>,<span class=\"built_in\">i</span>) = a(<span class=\"built_in\">i</span>) - <span class=\"built_in\">exp</span>(b(<span class=\"built_in\">j</span>));</span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"built_in\">disp</span>(c)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 第二种方法</span></span><br><span class=\"line\">f = @(a, b) a - <span class=\"built_in\">exp</span>(b);</span><br><span class=\"line\">c = <span class=\"built_in\">bsxfun</span>(f, a, b);</span><br><span class=\"line\"><span class=\"built_in\">disp</span>(c)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"A-cellfun-func-C\"><a href=\"#A-cellfun-func-C\" class=\"headerlink\" title=\"A = cellfun(func, C)\"></a><code>A = cellfun(func, C)</code></h3><p> 对元胞数组<code>C</code>的每个元胞进行操作。</p>\n<p>获取元胞数组中，每个元胞的大小</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C = cell(<span class=\"number\">3</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">C&#123;<span class=\"number\">1</span>,<span class=\"number\">1</span>&#125; = <span class=\"string\">&#x27;Sunday&#x27;</span>;</span><br><span class=\"line\">C&#123;<span class=\"number\">2</span>,<span class=\"number\">1</span>&#125; = <span class=\"built_in\">magic</span>(<span class=\"number\">3</span>);</span><br><span class=\"line\">C&#123;<span class=\"number\">3</span>,<span class=\"number\">1</span>&#125; = <span class=\"number\">1</span>:<span class=\"number\">10</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% 循环操作</span></span><br><span class=\"line\">A = <span class=\"built_in\">zeros</span>(<span class=\"built_in\">size</span>(C, <span class=\"number\">1</span>), <span class=\"number\">1</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"built_in\">size</span>(C, <span class=\"number\">1</span>)</span><br><span class=\"line\">\tA(<span class=\"built_in\">i</span>) = <span class=\"built_in\">length</span>(C&#123;<span class=\"built_in\">i</span>,<span class=\"number\">1</span>&#125;(:));</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"built_in\">disp</span>(A)</span><br><span class=\"line\"><span class=\"comment\">% [6; 9; 10]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% cellfun</span></span><br><span class=\"line\">A = <span class=\"built_in\">cellfun</span>(@(x) <span class=\"built_in\">length</span>(x(:)), C)</span><br><span class=\"line\"><span class=\"comment\">% [6; 9; 10]</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"A-structfun-func-S\"><a href=\"#A-structfun-func-S\" class=\"headerlink\" title=\"A = structfun(func, S)\"></a><code>A = structfun(func, S)</code></h3><p>对标量结构体的每个字段应用函数</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">S.f1 = <span class=\"number\">1</span>:<span class=\"number\">10</span>;</span><br><span class=\"line\">S.f2 = [<span class=\"number\">2</span>; <span class=\"number\">4</span>; <span class=\"number\">6</span>];</span><br><span class=\"line\">S.f3 = []</span><br><span class=\"line\"></span><br><span class=\"line\">A = structfun(@<span class=\"built_in\">mean</span>,S)</span><br><span class=\"line\"><span class=\"comment\">% A = 3×1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%     5.5000</span></span><br><span class=\"line\"><span class=\"comment\">%     4.0000</span></span><br><span class=\"line\"><span class=\"comment\">%        NaN</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-3-运行日志\"><a href=\"#3-3-运行日志\" class=\"headerlink\" title=\"3. 3 运行日志\"></a>3. 3 运行日志</h2><p>将命令行窗口文本记录到日志文件中</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">diary <span class=\"string\">&#x27;myDiaryFile.txt&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:<span class=\"number\">10</span></span><br><span class=\"line\">\t<span class=\"built_in\">disp</span>(<span class=\"built_in\">exp</span>(<span class=\"built_in\">i</span>))</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\">diary off</span><br></pre></td></tr></table></figure>\n\n<p>你就会得到一个<code>myDiaryFile.txt</code>文件，用于记录所有打印的结果。</p>\n<p>用处：追踪程序运行状况，运行到哪次迭代？运行到哪一步？配合其他函数，还可以记录何时运行等信息。</p>\n<h2 id=\"3-4-格式化输出\"><a href=\"#3-4-格式化输出\" class=\"headerlink\" title=\"3.4 格式化输出\"></a>3.4 格式化输出</h2><p>格式化字符串</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">formatSpec = <span class=\"string\">&#x27;The array is %dx%d.&#x27;</span>;</span><br><span class=\"line\">A1 = <span class=\"number\">2</span>;</span><br><span class=\"line\">A2 = <span class=\"number\">3</span>;</span><br><span class=\"line\">str = sprintf(formatSpec,A1,A2)</span><br><span class=\"line\"><span class=\"comment\">% str = </span></span><br><span class=\"line\"><span class=\"comment\">% &#x27;The array is 2x3.&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">fprint(formatSpec,A1,A2)</span><br><span class=\"line\"><span class=\"comment\">% &#x27;The array is 2x3.&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<p>参考： <a href=\"https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html\">https://www.mathworks.com/help/releases/R2023b/matlab/matlab_prog/profiling-for-improving-performance.html</a></p>\n<p>有什么用？多次运行一个函数，但是输入参数不同时，配合<code>diary</code>函数可生成结果日志</p>\n<p><img src=\"/../images/20240712/image-20231001164150891.png\" alt=\"image-20231001164150891\"></p>\n<p>解放双手，从自动运行做起，拒绝<strong>手动保存</strong>每次的运行结果。</p>\n<h2 id=\"3-5-运行时间\"><a href=\"#3-5-运行时间\" class=\"headerlink\" title=\"3.5 运行时间\"></a>3.5 运行时间</h2><p>想要获取运行了多久？使用<code>tic</code>和<code>toc</code>函数统计代码运行时间。</p>\n<p>高级用法：使用多个tic测量时间</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tStart = tic;           <span class=\"comment\">% pair 2: tic</span></span><br><span class=\"line\">n = <span class=\"number\">10</span>;</span><br><span class=\"line\">T = <span class=\"built_in\">zeros</span>(<span class=\"number\">1</span>,n);</span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">1</span>:n</span><br><span class=\"line\">    A = <span class=\"built_in\">rand</span>(<span class=\"number\">12000</span>,<span class=\"number\">4400</span>);</span><br><span class=\"line\">    B = <span class=\"built_in\">rand</span>(<span class=\"number\">12000</span>,<span class=\"number\">4400</span>);</span><br><span class=\"line\">    tic         <span class=\"comment\">% pair 1: tic</span></span><br><span class=\"line\">    C = A.*B;</span><br><span class=\"line\">    T(<span class=\"built_in\">i</span>)= toc;  <span class=\"comment\">% pair 1: toc</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\">tMul = sum(T) <span class=\"comment\">% tMul = 0.6037</span></span><br><span class=\"line\">tEnd = toc(tStart) <span class=\"comment\">% tEnd = 11.6301</span></span><br></pre></td></tr></table></figure>\n\n<p>其他统计代码运行时长的方法：</p>\n<p><a href=\"https://ww2.mathworks.cn/help/releases/R2023b/matlab/ref/cputime.html\">t &#x3D; cputime</a></p>\n<p><a href=\"https://www.mathworks.com/help/releases/R2023b/matlab/ref/datetime.html?searchHighlight=datetime&s_tid=doc_srchtitle#d126e310370\">t &#x3D; datetime</a></p>\n<h2 id=\"3-6-多层嵌套\"><a href=\"#3-6-多层嵌套\" class=\"headerlink\" title=\"3.6 多层嵌套\"></a>3.6 多层嵌套</h2><p>看这样一个代码，每月每天你孤单会想起谁：</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> month = <span class=\"number\">1</span>:<span class=\"number\">12</span>  <span class=\"comment\">% 月</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> day = <span class=\"number\">1</span>:<span class=\"number\">30</span> <span class=\"comment\">% 天</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> 孤单？</span><br><span class=\"line\">\t\t\t你想起一个人</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> 想找个人来陪</span><br><span class=\"line\">\t\t\t\t找！</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">end</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">end</span></span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p>上述代码的问题：嵌套太多了，一层一层的嵌套。（写代码的习惯，不影响执行效率，但是影响可读性）</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> month = <span class=\"number\">1</span>:<span class=\"number\">12</span>  <span class=\"comment\">% 月</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> day = <span class=\"number\">1</span>:<span class=\"number\">30</span> <span class=\"comment\">% 天</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> ~ 孤单？ <span class=\"comment\">% 非孤单 &quot;~&quot;取反</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">continue</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">end</span></span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t你想起一个人</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> 想找个人来陪</span><br><span class=\"line\">\t\t\t找！</span><br><span class=\"line\">\t\t<span class=\"keyword\">end</span></span><br><span class=\"line\">\t<span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br></pre></td></tr></table></figure>\n\n<p>使用continue关键字跳转，避免嵌套，提升可读性</p>\n<h2 id=\"3-7-Latex公式\"><a href=\"#3-7-Latex公式\" class=\"headerlink\" title=\"3.7 Latex公式\"></a>3.7 Latex公式</h2><p>latex是特别常用且提升效率的公式编辑方法，推荐大家使用！</p>\n<p>好处：输入公式时，手不再使用鼠标，全键盘操作</p>\n<p>可以使用的场景：</p>\n<ul>\n<li>word</li>\n<li>markdown</li>\n<li>latex</li>\n<li>mathtype</li>\n<li>matlab</li>\n<li>…</li>\n</ul>\n<h2 id=\"3-8-实时脚本做展示\"><a href=\"#3-8-实时脚本做展示\" class=\"headerlink\" title=\"3.8 实时脚本做展示\"></a>3.8 实时脚本做展示</h2><p>一般不用这个功能做开发，但是实时脚本是良好的展示工具</p>\n<p>类似于 python 的 jupyter notebook</p>\n<p><img src=\"/../images/20240712/image-20231006133646069.png\" alt=\"image-20231006133646069\"></p>\n<h2 id=\"3-9-数值精度问题\"><a href=\"#3-9-数值精度问题\" class=\"headerlink\" title=\"3.9 数值精度问题\"></a>3.9 数值精度问题</h2><p>数值精度问题普遍存在于计算机语言中，我们不讨论产生数值精度的具体原因，只需要知道存在这样的问题。</p>\n<p>例如：</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">0.1</span> + <span class=\"number\">0.2</span> == <span class=\"number\">0.3</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% ans =</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%  logical</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">%   0</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>在for循环中，需要避免以下的情况</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">0.0</span>:<span class=\"number\">0.1</span>:<span class=\"number\">1.0</span></span><br><span class=\"line\">    <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;-------------------&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">0.0</span>:<span class=\"number\">0.1</span>:<span class=\"number\">1.0</span>-<span class=\"built_in\">i</span></span><br><span class=\"line\">        k = <span class=\"number\">1.0</span> - <span class=\"built_in\">i</span> - <span class=\"built_in\">j</span>;</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>([<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>,k])</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% -------------------</span></span><br><span class=\"line\"><span class=\"comment\">%    0.7000         0    0.3000</span></span><br><span class=\"line\"><span class=\"comment\">%    0.7000    0.1000    0.2000</span></span><br><span class=\"line\"><span class=\"comment\">%    0.7000    0.2000    0.1000</span></span><br><span class=\"line\"><span class=\"comment\">%    0.7000    0.3000   -0.0000</span></span><br></pre></td></tr></table></figure>\n\n<p>出现一个非常小的负数，极有可能导致bug</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"built_in\">i</span> = <span class=\"number\">0</span>:<span class=\"number\">10</span></span><br><span class=\"line\">    <span class=\"built_in\">disp</span>(<span class=\"string\">&#x27;-------------------&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> <span class=\"built_in\">j</span> = <span class=\"number\">0</span>:(<span class=\"number\">10</span>-<span class=\"built_in\">i</span>)</span><br><span class=\"line\">        k = <span class=\"number\">10</span> - <span class=\"built_in\">i</span> - <span class=\"built_in\">j</span>;</span><br><span class=\"line\">        <span class=\"built_in\">disp</span>([<span class=\"built_in\">i</span>,<span class=\"built_in\">j</span>,k] / <span class=\"number\">10</span>)</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\">-------------------</span><br><span class=\"line\">    <span class=\"number\">0.7000</span>         <span class=\"number\">0</span>    <span class=\"number\">0.3000</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"number\">0.7000</span>    <span class=\"number\">0.1000</span>    <span class=\"number\">0.2000</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"number\">0.7000</span>    <span class=\"number\">0.2000</span>    <span class=\"number\">0.1000</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"number\">0.7000</span>    <span class=\"number\">0.3000</span>         <span class=\"number\">0</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"3-10-在线Matlab\"><a href=\"#3-10-在线Matlab\" class=\"headerlink\" title=\"3.10 在线Matlab\"></a>3.10 在线Matlab</h2><p>电脑没有matlab？只要有许可证，就能使用matlab在线编程（<a href=\"https://ww2.mathworks.cn/products/matlab-online.html%EF%BC%89%E3%80%82\">https://ww2.mathworks.cn/products/matlab-online.html）。</a></p>\n<h2 id=\"3-11-Markdown语言\"><a href=\"#3-11-Markdown语言\" class=\"headerlink\" title=\"3.11 Markdown语言\"></a>3.11 Markdown语言</h2><p>本文档就是使用的markdown编写的，这是一种文本标记语言，实现文本的不同格式、样式。</p>\n<h1 id=\"4-如何DEBUG\"><a href=\"#4-如何DEBUG\" class=\"headerlink\" title=\"4. 如何DEBUG\"></a>4. 如何DEBUG</h1><h2 id=\"4-1-断点\"><a href=\"#4-1-断点\" class=\"headerlink\" title=\"4.1 断点\"></a>4.1 断点</h2><p>调试程序是每个编程语言必备的操作，没有人能完美写完一个复杂的代码并且没有任何小错误。当这些错误直观发现不了时，使用断点追踪程序每步的运算有助于发现问题。</p>\n<p><img src=\"/../images/20240712/image-20231001165505931.png\" alt=\"image-20231001165505931\"></p>\n<h2 id=\"4-2-条件断点\"><a href=\"#4-2-条件断点\" class=\"headerlink\" title=\"4.2 条件断点\"></a>4.2 条件断点</h2><p>例如在这个循环中，每次<code>j=3</code>时就报错，我们增加一个条件断点，当满足这个条件时，程序暂停。</p>\n<p><img src=\"/../images/20240712/image-20231001165725593.png\" alt=\"image-20231001165725593\"></p>\n<p><img src=\"/../images/20240712/image-20231001165858415.png\" alt=\"image-20231001165858415\"></p>\n<h2 id=\"4-3-错误暂停\"><a href=\"#4-3-错误暂停\" class=\"headerlink\" title=\"4.3 错误暂停\"></a>4.3 错误暂停</h2><p><img src=\"/../images/20240712/image-20231001165922621.png\" alt=\"image-20231001165922621\"></p>\n<p>建议把出现错误暂停勾选，这样程序会停止在出错的哪一行，有助于分析&#x2F;复现问题。</p>\n<p><img src=\"/../images/20240712/image-20231001165952424.png\" alt=\"image-20231001165952424\"></p>\n<h2 id=\"4-4-搜索问题\"><a href=\"#4-4-搜索问题\" class=\"headerlink\" title=\"4.4 搜索问题\"></a>4.4 搜索问题</h2><p>当一个问题，自己不能解决的时候，我们通常会使用搜索引擎进行检索，如何获得问题的答案？</p>\n<p>例如：</p>\n<blockquote>\n<p>我想删除一个cell数组中空的元胞，保留下非空的元胞</p>\n</blockquote>\n<p>一般我会用 “语言 + 关键词 ”搜索</p>\n<ul>\n<li><p>搜索方法：<code>MATLAB cell删除空元胞</code></p>\n</li>\n<li><p>结果质量：</p>\n<ul>\n<li>Matlab中文论坛 &#x2F; 知乎 &#x2F; 博客园 </li>\n<li>CSDN（垃圾堆里找吃的，但不代表都是垃圾） &#x2F; 简书</li>\n<li>百度知道 （几乎驴唇不对马嘴） &#x2F; 其他小网站</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"/../images/20240712/image-20231001170909421.png\" alt=\"image-20231001170909421\"></p>\n<h2 id=\"4-5-向他人提问\"><a href=\"#4-5-向他人提问\" class=\"headerlink\" title=\"4. 5 向他人提问\"></a>4. 5 <font color=\"#dd0000\">向他人提问</font></h2><p>向他人提问，包括同学、老师、网友等。</p>\n<p>为什么向他人提问很重要？正确的提问方式有助于提升双方沟通效率，快速发现问题。</p>\n<p><strong>错误的提问方式</strong></p>\n<ol>\n<li>不会截图 用手机拍照的</li>\n</ol>\n<img src=\"https://img-blog.csdnimg.cn/975ac90367e0403bb704c1785dd9c27b.jpg?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5b6h6aOOQk_lsJE=,size_20,color_FFFFFF,t_70,g_se,x_16\" alt=\"img\" style=\"zoom: 50%;\" />\n\n<ol start=\"2\">\n<li><p>截图截一半 只截图报错信息traceback， 不截图代码的</p>\n<p><img src=\"/../images/20240712/image-20231001171745717.png\" alt=\"image-20231001171745717\"></p>\n</li>\n<li><p>不截图前后文的</p>\n<blockquote>\n<p>为什么我这句代码报错了？</p>\n</blockquote>\n<p><img src=\"/../images/20240712/image-20231001172136136.png\" alt=\"image-20231001172136136\"></p>\n</li>\n<li><p>自己不思考、不检索，直接问别人的。</p>\n<blockquote>\n<p>我想删除一个cell数组中空的元胞，保留下非空的元胞，matlab怎么写？</p>\n</blockquote>\n</li>\n</ol>\n<p><strong>正确的提问方式</strong>（不仅适用于代码提问）</p>\n<ul>\n<li><p>尽可能详细说出你的问题</p>\n</li>\n<li><p>提供代码（如果是截图，截图要全面）</p>\n</li>\n<li><p>问题如何复现</p>\n</li>\n<li><p>你已经做了什么操作，但是还是不行</p>\n</li>\n<li><p>发送之前读一读你的提问</p>\n<p>举例 1：</p>\n<p><img src=\"/../images/20240712/image-20231001172945916.png\" alt=\"image-20231001172945916\"></p>\n<p>举例 2：<img src=\"/../images/20240712/image-20231001173153802.png\" alt=\"image-20231001173153802\"></p>\n</li>\n</ul>\n<h2 id=\"4-6-文档\"><a href=\"#4-6-文档\" class=\"headerlink\" title=\"4. 6 文档\"></a>4. 6 文档</h2><p>如果你知道matlab的某个函数的名字，但是不会写，那么可以在matlab右上角搜索文档，也可以在命令行中使用<code>help &#39;fun_name&#39;</code>获得文档。</p>\n<p><img src=\"/../images/20240712/image-20231001173452560.png\" alt=\"image-20231001173452560\"></p>\n<p>此外，在命令行中输入<code>doc &#39;fun_name&#39;</code>可以打开在线文档。</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">doc <span class=\"built_in\">zeros</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/../images/20240712/image-20231001173620154.png\" alt=\"image-20231001173620154\"></p>\n<h1 id=\"5-外部功能\"><a href=\"#5-外部功能\" class=\"headerlink\" title=\"5. 外部功能\"></a>5. <font color=\"#dd0000\">外部功能</font></h1><h2 id=\"5-1-Python\"><a href=\"#5-1-Python\" class=\"headerlink\" title=\"5.1 Python\"></a>5.1 Python</h2><p>很多时候，我们发现某个功能只在python中有，matlab中没有或者不如python好用。</p>\n<p>这个时候，我们可以写一个python函数，然后让matlab调用这个py函数，再将结果处理成matlab可接收的类型即可。</p>\n<p>举例来说，Gurobi对Python支持远远比matlab好，建模也更加方便，我们可以使用matlab调用python，python调用gurobi来实现：</p>\n<p>首先，我们写一个python调用gurobi的函数<code>grbpy_v.py</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># grbpy_v.py</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> gurobipy <span class=\"keyword\">as</span> gp</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> math</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">model</span>(<span class=\"params\">f, alpha, beta, gamma, mu, kappa</span>):</span><br><span class=\"line\">    <span class=\"comment\"># 集合</span></span><br><span class=\"line\">    I = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(f))</span><br><span class=\"line\">    P = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(alpha[<span class=\"number\">0</span>]))</span><br><span class=\"line\">    N = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(gamma[<span class=\"number\">0</span>]))</span><br><span class=\"line\">    M = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(beta[<span class=\"number\">0</span>]))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 建模</span></span><br><span class=\"line\">    model = gp.Model()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 变量</span></span><br><span class=\"line\">    v = model.addVars((i <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> I), vtype = gp.GRB.BINARY, name =<span class=\"string\">&#x27;v&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 目标</span></span><br><span class=\"line\">    obj = gp.quicksum((f[i] - gp.quicksum(alpha[i,p] <span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> P) \\</span><br><span class=\"line\">                            - gp.quicksum(beta[i,m] - mu[i,m] <span class=\"keyword\">for</span> m <span class=\"keyword\">in</span> M)\\</span><br><span class=\"line\">                            - gp.quicksum(gamma[i,n] - kappa[i,n] <span class=\"keyword\">for</span> n <span class=\"keyword\">in</span> N)) * v[i] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> I) \\</span><br><span class=\"line\">        - gp.quicksum(mu[i,m] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> I <span class=\"keyword\">for</span> m <span class=\"keyword\">in</span> M) \\</span><br><span class=\"line\">        - gp.quicksum(kappa[i,n] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> I <span class=\"keyword\">for</span> n <span class=\"keyword\">in</span> N)</span><br><span class=\"line\">    model.setObjective(obj, sense = gp.GRB.MINIMIZE)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># 约束</span></span><br><span class=\"line\">    <span class=\"comment\"># 无</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 求解</span></span><br><span class=\"line\">    model.Params.OutputFlag = <span class=\"number\">0</span></span><br><span class=\"line\">    model.Params.MIPGap = <span class=\"number\">0.01</span></span><br><span class=\"line\">    model.optimize()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 整理</span></span><br><span class=\"line\">    loc = np.zeros([<span class=\"number\">1</span>,<span class=\"built_in\">len</span>(f)])</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> I:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> math.isclose(v[i].X, <span class=\"number\">1</span>):</span><br><span class=\"line\">            loc[<span class=\"number\">0</span>,i] = <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">    obj_val = model.getAttr(<span class=\"string\">&#x27;ObjVal&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> (loc, obj_val)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>然后，我们写一个matlab脚本（函数）调用这个py函数</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">py.importlib.reload(py.importlib.import_module(<span class=\"string\">&#x27;grbpy_v&#x27;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">fix_ws_py = py.numpy.array(fixed_ws);</span><br><span class=\"line\">alpha_py  = py.numpy.array(alpha);</span><br><span class=\"line\">beta_py   = py.numpy.array(<span class=\"built_in\">beta</span>);</span><br><span class=\"line\">mu_py     = py.numpy.array(mu);</span><br><span class=\"line\">gamma_py  = py.numpy.array(<span class=\"built_in\">gamma</span>);</span><br><span class=\"line\">kappa_py  = py.numpy.array(kappa);</span><br><span class=\"line\"></span><br><span class=\"line\">res = py.grbpy_v.model(fix_ws_py, alpha_py, beta_py, gamma_py, mu_py, kappa_py);</span><br></pre></td></tr></table></figure>\n\n<p>注意上述存在类型转换，需要把matlab的矩阵转成python的numpy矩阵才可以使用。</p>\n<p>参考：<a href=\"https://www.mathworks.com/help/releases/R2023b/matlab/call-python-libraries.html?s_tid=doc_srchtitle\">从 MATLAB 中调用 Python</a></p>\n<h2 id=\"5-2-Gurobi-（运筹）\"><a href=\"#5-2-Gurobi-（运筹）\" class=\"headerlink\" title=\"5. 2 Gurobi （运筹）\"></a>5. 2 Gurobi （运筹）</h2><p>Gurobi是一款求解器，做运筹优化方面常常会用到，这里将介绍直接使用matlab调用gurobi，不借助其他软件或包。</p>\n<p>来源于Guorbi官方文档：</p>\n<figure class=\"highlight matlab\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">facility</span><span class=\"params\">()</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Copyright 2023, Gurobi Optimization, LLC</span></span><br><span class=\"line\"><span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"comment\">% Facility location: a company currently ships its product from 5 plants</span></span><br><span class=\"line\"><span class=\"comment\">% to 4 warehouses. It is considering closing some plants to reduce</span></span><br><span class=\"line\"><span class=\"comment\">% costs. What plant(s) should the company close, in order to minimize</span></span><br><span class=\"line\"><span class=\"comment\">% transportation and fixed costs?</span></span><br><span class=\"line\"><span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"comment\">% Note that this example uses lists instead of dictionaries.  Since</span></span><br><span class=\"line\"><span class=\"comment\">% it does not work with sparse data, lists are a reasonable option.</span></span><br><span class=\"line\"><span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"comment\">% Based on an example from Frontline Systems:</span></span><br><span class=\"line\"><span class=\"comment\">%   http://www.solver.com/disfacility.htm</span></span><br><span class=\"line\"><span class=\"comment\">% Used with permission.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% define primitive data</span></span><br><span class=\"line\">nPlants     = <span class=\"number\">5</span>;</span><br><span class=\"line\">nWarehouses = <span class=\"number\">4</span>;</span><br><span class=\"line\"><span class=\"comment\">% Warehouse demand in thousands of units</span></span><br><span class=\"line\">Demand      = [<span class=\"number\">15</span>; <span class=\"number\">18</span>; <span class=\"number\">14</span>; <span class=\"number\">20</span>];</span><br><span class=\"line\"><span class=\"comment\">% Plant capacity in thousands of units</span></span><br><span class=\"line\">Capacity    = [<span class=\"number\">20</span>; <span class=\"number\">22</span>; <span class=\"number\">17</span>; <span class=\"number\">19</span>; <span class=\"number\">18</span>];</span><br><span class=\"line\"><span class=\"comment\">% Fixed costs for each plant</span></span><br><span class=\"line\">FixedCosts  = [<span class=\"number\">12000</span>; <span class=\"number\">15000</span>; <span class=\"number\">17000</span>; <span class=\"number\">13000</span>; <span class=\"number\">16000</span>];</span><br><span class=\"line\"><span class=\"comment\">% Transportation costs per thousand units</span></span><br><span class=\"line\">TransCosts  = [</span><br><span class=\"line\">    <span class=\"number\">4000</span>; <span class=\"number\">2000</span>; <span class=\"number\">3000</span>; <span class=\"number\">2500</span>; <span class=\"number\">4500</span>;</span><br><span class=\"line\">    <span class=\"number\">2500</span>; <span class=\"number\">2600</span>; <span class=\"number\">3400</span>; <span class=\"number\">3000</span>; <span class=\"number\">4000</span>;</span><br><span class=\"line\">    <span class=\"number\">1200</span>; <span class=\"number\">1800</span>; <span class=\"number\">2600</span>; <span class=\"number\">4100</span>; <span class=\"number\">3000</span>;</span><br><span class=\"line\">    <span class=\"number\">2200</span>; <span class=\"number\">2600</span>; <span class=\"number\">3100</span>; <span class=\"number\">3700</span>; <span class=\"number\">3200</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Index helper function</span></span><br><span class=\"line\">flowidx = @(w, p) nPlants * w + p;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Build model</span></span><br><span class=\"line\">model.modelname = <span class=\"string\">&#x27;facility&#x27;</span>;</span><br><span class=\"line\">model.modelsense = <span class=\"string\">&#x27;min&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Set data for variables</span></span><br><span class=\"line\">ncol = nPlants + nPlants * nWarehouses;</span><br><span class=\"line\">model.lb    = <span class=\"built_in\">zeros</span>(ncol, <span class=\"number\">1</span>);</span><br><span class=\"line\">model.ub    = [<span class=\"built_in\">ones</span>(nPlants, <span class=\"number\">1</span>); <span class=\"built_in\">inf</span>(nPlants * nWarehouses, <span class=\"number\">1</span>)];</span><br><span class=\"line\">model.obj   = [FixedCosts; TransCosts];</span><br><span class=\"line\">model.vtype = [<span class=\"built_in\">repmat</span>(<span class=\"string\">&#x27;B&#x27;</span>, nPlants, <span class=\"number\">1</span>); <span class=\"built_in\">repmat</span>(<span class=\"string\">&#x27;C&#x27;</span>, nPlants * nWarehouses, <span class=\"number\">1</span>)];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> p = <span class=\"number\">1</span>:nPlants</span><br><span class=\"line\">    model.varnames&#123;p&#125; = sprintf(<span class=\"string\">&#x27;Open%d&#x27;</span>, p);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> w = <span class=\"number\">1</span>:nWarehouses</span><br><span class=\"line\">    <span class=\"keyword\">for</span> p = <span class=\"number\">1</span>:nPlants</span><br><span class=\"line\">        v = flowidx(w, p);</span><br><span class=\"line\">        model.varnames&#123;v&#125; = sprintf(<span class=\"string\">&#x27;Trans%d,%d&#x27;</span>, w, p);</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Set data for constraints and matrix</span></span><br><span class=\"line\">nrow = nPlants + nWarehouses;</span><br><span class=\"line\">model.A     = sparse(nrow, ncol);</span><br><span class=\"line\">model.rhs   = [<span class=\"built_in\">zeros</span>(nPlants, <span class=\"number\">1</span>); Demand];</span><br><span class=\"line\">model.sense = [<span class=\"built_in\">repmat</span>(<span class=\"string\">&#x27;&lt;&#x27;</span>, nPlants, <span class=\"number\">1</span>); <span class=\"built_in\">repmat</span>(<span class=\"string\">&#x27;=&#x27;</span>, nWarehouses, <span class=\"number\">1</span>)];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Production constraints</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> p = <span class=\"number\">1</span>:nPlants</span><br><span class=\"line\">    <span class=\"keyword\">for</span> w = <span class=\"number\">1</span>:nWarehouses</span><br><span class=\"line\">        model.A(p, p) = -Capacity(p);</span><br><span class=\"line\">        model.A(p, flowidx(w, p)) = <span class=\"number\">1.0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\">    model.constrnames&#123;p&#125; = sprintf(<span class=\"string\">&#x27;Capacity%d&#x27;</span>, p);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Demand constraints</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> w = <span class=\"number\">1</span>:nWarehouses</span><br><span class=\"line\">    <span class=\"keyword\">for</span> p = <span class=\"number\">1</span>:nPlants</span><br><span class=\"line\">        model.A(nPlants+w, flowidx(w, p)) = <span class=\"number\">1.0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\">    model.constrnames&#123;nPlants+w&#125; = sprintf(<span class=\"string\">&#x27;Demand%d&#x27;</span>, w);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Save model</span></span><br><span class=\"line\">gurobi_write(model,<span class=\"string\">&#x27;facility_m.lp&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Guess at the starting point: close the plant with the highest fixed</span></span><br><span class=\"line\"><span class=\"comment\">% costs; open all others first open all plants</span></span><br><span class=\"line\">model.start = [<span class=\"built_in\">ones</span>(nPlants, <span class=\"number\">1</span>); <span class=\"built_in\">inf</span>(nPlants * nWarehouses, <span class=\"number\">1</span>)];</span><br><span class=\"line\">[~, idx] = <span class=\"built_in\">max</span>(FixedCosts);</span><br><span class=\"line\">model.start(idx) = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Set parameters</span></span><br><span class=\"line\">params.method = <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Optimize</span></span><br><span class=\"line\">res = gurobi(model, params);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">% Print solution</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> strcmp(res.status, <span class=\"string\">&#x27;OPTIMAL&#x27;</span>)</span><br><span class=\"line\">    fprintf(<span class=\"string\">&#x27;\\nTotal Costs: %g\\n&#x27;</span>, res.objval);</span><br><span class=\"line\">    fprintf(<span class=\"string\">&#x27;solution:\\n&#x27;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> p = <span class=\"number\">1</span>:nPlants</span><br><span class=\"line\">        <span class=\"keyword\">if</span> res.x(p) &gt; <span class=\"number\">0.99</span></span><br><span class=\"line\">            fprintf(<span class=\"string\">&#x27;Plant %d open:\\n&#x27;</span>, p);</span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> w = <span class=\"number\">1</span>:nWarehouses</span><br><span class=\"line\">            <span class=\"keyword\">if</span> res.x(flowidx(w, p)) &gt; <span class=\"number\">0.0001</span></span><br><span class=\"line\">                fprintf(<span class=\"string\">&#x27;  Transport %g units to warehouse %d\\n&#x27;</span>, res.x(flowidx(w, p)), w);</span><br><span class=\"line\">            <span class=\"keyword\">end</span></span><br><span class=\"line\">        <span class=\"keyword\">end</span></span><br><span class=\"line\">    <span class=\"keyword\">end</span></span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">    fprintf(<span class=\"string\">&#x27;\\n No solution\\n&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">end</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>想表达的是，gurobi对matlab很不友好：</p>\n<ul>\n<li>系数矩阵必须是自己算明白索引后，转换为一个稀疏矩阵。</li>\n<li>很难按照约束一条一条添加</li>\n<li>有些gurobi功能matlab不能使用</li>\n</ul>\n<p>同样模型，python的版本</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/bin/env python3.7</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Copyright 2023, Gurobi Optimization, LLC</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Facility location: a company currently ships its product from 5 plants</span></span><br><span class=\"line\"><span class=\"comment\"># to 4 warehouses. It is considering closing some plants to reduce</span></span><br><span class=\"line\"><span class=\"comment\"># costs. What plant(s) should the company close, in order to minimize</span></span><br><span class=\"line\"><span class=\"comment\"># transportation and fixed costs?</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># Note that this example uses lists instead of dictionaries.  Since</span></span><br><span class=\"line\"><span class=\"comment\"># it does not work with sparse data, lists are a reasonable option.</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># Based on an example from Frontline Systems:</span></span><br><span class=\"line\"><span class=\"comment\">#   http://www.solver.com/disfacility.htm</span></span><br><span class=\"line\"><span class=\"comment\"># Used with permission.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> gurobipy <span class=\"keyword\">as</span> gp</span><br><span class=\"line\"><span class=\"keyword\">from</span> gurobipy <span class=\"keyword\">import</span> GRB</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Warehouse demand in thousands of units</span></span><br><span class=\"line\">demand = [<span class=\"number\">15</span>, <span class=\"number\">18</span>, <span class=\"number\">14</span>, <span class=\"number\">20</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Plant capacity in thousands of units</span></span><br><span class=\"line\">capacity = [<span class=\"number\">20</span>, <span class=\"number\">22</span>, <span class=\"number\">17</span>, <span class=\"number\">19</span>, <span class=\"number\">18</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Fixed costs for each plant</span></span><br><span class=\"line\">fixedCosts = [<span class=\"number\">12000</span>, <span class=\"number\">15000</span>, <span class=\"number\">17000</span>, <span class=\"number\">13000</span>, <span class=\"number\">16000</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Transportation costs per thousand units</span></span><br><span class=\"line\">transCosts = [[<span class=\"number\">4000</span>, <span class=\"number\">2000</span>, <span class=\"number\">3000</span>, <span class=\"number\">2500</span>, <span class=\"number\">4500</span>],</span><br><span class=\"line\">              [<span class=\"number\">2500</span>, <span class=\"number\">2600</span>, <span class=\"number\">3400</span>, <span class=\"number\">3000</span>, <span class=\"number\">4000</span>],</span><br><span class=\"line\">              [<span class=\"number\">1200</span>, <span class=\"number\">1800</span>, <span class=\"number\">2600</span>, <span class=\"number\">4100</span>, <span class=\"number\">3000</span>],</span><br><span class=\"line\">              [<span class=\"number\">2200</span>, <span class=\"number\">2600</span>, <span class=\"number\">3100</span>, <span class=\"number\">3700</span>, <span class=\"number\">3200</span>]]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Range of plants and warehouses</span></span><br><span class=\"line\">plants = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(capacity))</span><br><span class=\"line\">warehouses = <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(demand))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Model</span></span><br><span class=\"line\">m = gp.Model(<span class=\"string\">&quot;facility&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Plant open decision variables: open[p] == 1 if plant p is open.</span></span><br><span class=\"line\"><span class=\"built_in\">open</span> = m.addVars(plants,</span><br><span class=\"line\">                 vtype=GRB.BINARY,</span><br><span class=\"line\">                 obj=fixedCosts,</span><br><span class=\"line\">                 name=<span class=\"string\">&quot;open&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Transportation decision variables: transport[w,p] captures the</span></span><br><span class=\"line\"><span class=\"comment\"># optimal quantity to transport to warehouse w from plant p</span></span><br><span class=\"line\">transport = m.addVars(warehouses, plants, obj=transCosts, name=<span class=\"string\">&quot;trans&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># You could use Python looping constructs and m.addVar() to create</span></span><br><span class=\"line\"><span class=\"comment\"># these decision variables instead.  The following would be equivalent</span></span><br><span class=\"line\"><span class=\"comment\"># to the preceding two statements...</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># open = []</span></span><br><span class=\"line\"><span class=\"comment\"># for p in plants:</span></span><br><span class=\"line\"><span class=\"comment\">#     open.append(m.addVar(vtype=GRB.BINARY,</span></span><br><span class=\"line\"><span class=\"comment\">#                          obj=fixedCosts[p],</span></span><br><span class=\"line\"><span class=\"comment\">#                          name=&quot;open[%d]&quot; % p))</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># transport = []</span></span><br><span class=\"line\"><span class=\"comment\"># for w in warehouses:</span></span><br><span class=\"line\"><span class=\"comment\">#     transport.append([])</span></span><br><span class=\"line\"><span class=\"comment\">#     for p in plants:</span></span><br><span class=\"line\"><span class=\"comment\">#         transport[w].append(m.addVar(obj=transCosts[w][p],</span></span><br><span class=\"line\"><span class=\"comment\">#                                      name=&quot;trans[%d,%d]&quot; % (w, p)))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The objective is to minimize the total fixed and variable costs</span></span><br><span class=\"line\">m.ModelSense = GRB.MINIMIZE</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Production constraints</span></span><br><span class=\"line\"><span class=\"comment\"># Note that the right-hand limit sets the production to zero if the plant</span></span><br><span class=\"line\"><span class=\"comment\"># is closed</span></span><br><span class=\"line\">m.addConstrs(</span><br><span class=\"line\">    (transport.<span class=\"built_in\">sum</span>(<span class=\"string\">&#x27;*&#x27;</span>, p) &lt;= capacity[p]*<span class=\"built_in\">open</span>[p] <span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> plants), <span class=\"string\">&quot;Capacity&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Using Python looping constructs, the preceding would be...</span></span><br><span class=\"line\"><span class=\"comment\">#</span></span><br><span class=\"line\"><span class=\"comment\"># for p in plants:</span></span><br><span class=\"line\"><span class=\"comment\">#     m.addConstr(sum(transport[w][p] for w in warehouses)</span></span><br><span class=\"line\"><span class=\"comment\">#                 &lt;= capacity[p] * open[p], &quot;Capacity[%d]&quot; % p)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Demand constraints</span></span><br><span class=\"line\">m.addConstrs(</span><br><span class=\"line\">    (transport.<span class=\"built_in\">sum</span>(w) == demand[w] <span class=\"keyword\">for</span> w <span class=\"keyword\">in</span> warehouses),</span><br><span class=\"line\">    <span class=\"string\">&quot;Demand&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ... and the preceding would be ...</span></span><br><span class=\"line\"><span class=\"comment\"># for w in warehouses:</span></span><br><span class=\"line\"><span class=\"comment\">#     m.addConstr(sum(transport[w][p] for p in plants) == demand[w],</span></span><br><span class=\"line\"><span class=\"comment\">#                 &quot;Demand[%d]&quot; % w)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Save model</span></span><br><span class=\"line\">m.write(<span class=\"string\">&#x27;facilityPY.lp&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Guess at the starting point: close the plant with the highest fixed costs;</span></span><br><span class=\"line\"><span class=\"comment\"># open all others</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># First open all plants</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> plants:</span><br><span class=\"line\">    <span class=\"built_in\">open</span>[p].Start = <span class=\"number\">1.0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Now close the plant with the highest fixed cost</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Initial guess:&#x27;</span>)</span><br><span class=\"line\">maxFixed = <span class=\"built_in\">max</span>(fixedCosts)</span><br><span class=\"line\"><span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> plants:</span><br><span class=\"line\">    <span class=\"keyword\">if</span> fixedCosts[p] == maxFixed:</span><br><span class=\"line\">        <span class=\"built_in\">open</span>[p].Start = <span class=\"number\">0.0</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Closing plant %s&#x27;</span> % p)</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Use barrier to solve root relaxation</span></span><br><span class=\"line\">m.Params.Method = <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Solve</span></span><br><span class=\"line\">m.optimize()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Print solution</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\nTOTAL COSTS: %g&#x27;</span> % m.ObjVal)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;SOLUTION:&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> p <span class=\"keyword\">in</span> plants:</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">open</span>[p].X &gt; <span class=\"number\">0.99</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Plant %s open&#x27;</span> % p)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> w <span class=\"keyword\">in</span> warehouses:</span><br><span class=\"line\">            <span class=\"keyword\">if</span> transport[w, p].X &gt; <span class=\"number\">0</span>:</span><br><span class=\"line\">                <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;  Transport %g units to warehouse %s&#x27;</span> %</span><br><span class=\"line\">                      (transport[w, p].X, w))</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Plant %s closed!&#x27;</span> % p)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"5-3-Yalmip-（运筹）\"><a href=\"#5-3-Yalmip-（运筹）\" class=\"headerlink\" title=\"5.3 Yalmip （运筹）\"></a>5.3 Yalmip （运筹）</h2><p>yalmip是一款基于matlab进行数学建模的包，或者说是一种基于matlab的建模语言，使用yalmip的好处是解决了matlab建模的痛点，并且可以调用多个求解器对模型进行求解。</p>\n<p>然而，求解器方面，如果用gurobi &#x2F; COPT，则一般使用python建模。如果用cplex，则使用java。</p>\n<p>如果不会别的语言，必须使用matlab进行建模和求解的话，yalmip无疑是最好的选择。</p>\n<h2 id=\"5-4-gramm（画图）\"><a href=\"#5-4-gramm（画图）\" class=\"headerlink\" title=\"5.4 gramm（画图）\"></a>5.4 gramm（画图）</h2><p>gramm是基于matlab开发的一个绘图工具，可以画很多好看的图。</p>\n<p>matlab的图一般都很丑，需要自己不断调试。而gramm默认的配色，基本可以直接使用。</p>\n<p><img src=\"/../images/20240712/image-20231001184526448.png\" alt=\"image-20231001184526448\"></p>\n<p>参考：</p>\n<p><a href=\"https://www.mathworks.com/matlabcentral/fileexchange/54465-gramm-complete-data-visualization-toolbox-ggplot2-r-like\">https://www.mathworks.com/matlabcentral/fileexchange/54465-gramm-complete-data-visualization-toolbox-ggplot2-r-like</a></p>\n<p><a href=\"https://github.com/piermorel/gramm\">https://github.com/piermorel/gramm</a></p>\n<h1 id=\"6-One-more-thing\"><a href=\"#6-One-more-thing\" class=\"headerlink\" title=\"6. One more thing\"></a>6. One more thing</h1><p>科研常用工具列表，成为一个合格的板砖人（科研民工）</p>\n<table>\n<thead>\n<tr>\n<th>名字</th>\n<th>价格</th>\n<th>用处</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Office三件套</td>\n<td>学校提供</td>\n<td>略</td>\n</tr>\n<tr>\n<td>Mathtype</td>\n<td>收费</td>\n<td>数学公式编辑（推荐搭配latex数学命令使用）</td>\n</tr>\n<tr>\n<td>Typora</td>\n<td>收费</td>\n<td>markdown编辑器，本次分享使用markdown完成</td>\n</tr>\n<tr>\n<td>VScode</td>\n<td>免费</td>\n<td>地表最强编辑器，我用vscode开发python, latex, markdown</td>\n</tr>\n<tr>\n<td>Notion</td>\n<td>免费</td>\n<td>个人知识库（上手很慢，但是可以很好规划你的生活）</td>\n</tr>\n<tr>\n<td>Endnote</td>\n<td>学校提供</td>\n<td>个人文献库（直接插入国标引用格式到word）</td>\n</tr>\n<tr>\n<td>Calibre</td>\n<td>免费</td>\n<td>个人图书馆</td>\n</tr>\n<tr>\n<td>百度云</td>\n<td>功能收费</td>\n<td>备份+同步（一年不到200块，同步文件+备份文件）</td>\n</tr>\n<tr>\n<td>Office 365</td>\n<td>收费</td>\n<td>与Office年度版本不同，这是订阅制的office，享受更多功能+1T 云盘</td>\n</tr>\n<tr>\n<td>Acrobat DC</td>\n<td>收费</td>\n<td>PDF编辑器</td>\n</tr>\n<tr>\n<td>Latex</td>\n<td>免费</td>\n<td>写期刊论文使用，直接输出pdf</td>\n</tr>\n<tr>\n<td>Overleaf &#x2F; Slagger</td>\n<td>免费</td>\n<td>在线latex</td>\n</tr>\n<tr>\n<td>Powertoys</td>\n<td>免费</td>\n<td>Windows拓展工具（非常强大，保持唤醒、取色、分屏等等等）</td>\n</tr>\n<tr>\n<td>Steam &#x2F; Epic</td>\n<td>?</td>\n<td>玩</td>\n</tr>\n</tbody></table>\n<h1 id=\"7-结语\"><a href=\"#7-结语\" class=\"headerlink\" title=\"7. 结语\"></a>7. 结语</h1><ol>\n<li>使用正版，获得更多的技术支持，工具箱，社区等。</li>\n<li>使用新版，获得更多的功能，更快的运行，更美的界面。</li>\n<li>如果想用matlab，那就<strong>多写多练</strong>。</li>\n<li>Matlab真的好用吗？好用不一定，但真的简单，个人认为比Python简单。</li>\n<li>只进行数值计算则matlab不是唯一选择（python, java等都可以），matlab的精髓是工具箱和仿真。</li>\n</ol>\n<hr>\n<p>感谢各位！</p>\n"},{"title":"运筹写作的数学定理、命题等相关术语和应用","date":"2024-08-17T16:07:00.000Z","_content":"\n**前言**：在运筹论文中，总会出现一些Proposition, Theorem, 等类似的模型相关术语，\n理解这些术语的内涵有助于揣测作者写作的着重点，更有助于理解文章的内容。\n\n# 术语、含义\n| 术语        | 含义 | 用途                                   |\n| ----------- | ---- | -------------------------------------- |\n| Definition  | 定义 | 定义一个词的含义                       |\n| Theorem     | 定理 | 已经被证明的是正确的内容               |\n| Proposition | 命题 | 不那么重要，但是又有点意思的正确的陈述 |\n| Lemma       | 引理 | 用于证明其他内容的正确陈述             |\n| Corollary   | 推论 | 从定理或命题中推导的正确陈述           |\n| Proof       | 证明 | 解释写的东西为什么是正确的             |\n| Conjecture  | 猜想 | 认为是正确的，但是没证出来的陈述       |\n| Axiom       | 公理 | 关于数学的基本假设                     |\n| Note        | 注释 | 澄清没有解释清楚的事情                  |\n| Remark      | 评述 | 强调\\讨论\\评论其他的概念或见解           |\n\n# 个人理解\n上述的术语在应用类型的运筹文章中，比较常见的有Definition、Theorem、Proposition、Lemma、Proof。\n通常在模型或问题提出后，为了增加文章的理论深度，提出一些关于模型的有意思的、略带深度的性质，并提供证明Proof。\n个人觉得Theorem是一个严肃的内容，其定义是“已经被证明的正确的内容“，但是在文章中证明出来了，\n就算的上是”已经被证明“了。\n\nLemma、Proposition、Theorem的边界并不是清晰的，所以怎么用都行。\n但是重要性的排序个人认为是：Theorem > Proposition > Lemma。\n\nRemark一般在证明最后，强调一下和其他人的不同，或者强调有意义的事情。","source":"_posts/2024-08-18-写作.md","raw":"---\ntitle: 运筹写作的数学定理、命题等相关术语和应用\ntag: 写作\ndate: 2024-08-18 00:07:00\n---\n\n**前言**：在运筹论文中，总会出现一些Proposition, Theorem, 等类似的模型相关术语，\n理解这些术语的内涵有助于揣测作者写作的着重点，更有助于理解文章的内容。\n\n# 术语、含义\n| 术语        | 含义 | 用途                                   |\n| ----------- | ---- | -------------------------------------- |\n| Definition  | 定义 | 定义一个词的含义                       |\n| Theorem     | 定理 | 已经被证明的是正确的内容               |\n| Proposition | 命题 | 不那么重要，但是又有点意思的正确的陈述 |\n| Lemma       | 引理 | 用于证明其他内容的正确陈述             |\n| Corollary   | 推论 | 从定理或命题中推导的正确陈述           |\n| Proof       | 证明 | 解释写的东西为什么是正确的             |\n| Conjecture  | 猜想 | 认为是正确的，但是没证出来的陈述       |\n| Axiom       | 公理 | 关于数学的基本假设                     |\n| Note        | 注释 | 澄清没有解释清楚的事情                  |\n| Remark      | 评述 | 强调\\讨论\\评论其他的概念或见解           |\n\n# 个人理解\n上述的术语在应用类型的运筹文章中，比较常见的有Definition、Theorem、Proposition、Lemma、Proof。\n通常在模型或问题提出后，为了增加文章的理论深度，提出一些关于模型的有意思的、略带深度的性质，并提供证明Proof。\n个人觉得Theorem是一个严肃的内容，其定义是“已经被证明的正确的内容“，但是在文章中证明出来了，\n就算的上是”已经被证明“了。\n\nLemma、Proposition、Theorem的边界并不是清晰的，所以怎么用都行。\n但是重要性的排序个人认为是：Theorem > Proposition > Lemma。\n\nRemark一般在证明最后，强调一下和其他人的不同，或者强调有意义的事情。","slug":"2024-08-18-写作","published":1,"updated":"2024-08-27T04:01:01.315Z","comments":1,"layout":"post","photos":[],"_id":"cm0epapyo0004hjm17gxs4joa","content":"<p><strong>前言</strong>：在运筹论文中，总会出现一些Proposition, Theorem, 等类似的模型相关术语，<br>理解这些术语的内涵有助于揣测作者写作的着重点，更有助于理解文章的内容。</p>\n<h1 id=\"术语、含义\"><a href=\"#术语、含义\" class=\"headerlink\" title=\"术语、含义\"></a>术语、含义</h1><table>\n<thead>\n<tr>\n<th>术语</th>\n<th>含义</th>\n<th>用途</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Definition</td>\n<td>定义</td>\n<td>定义一个词的含义</td>\n</tr>\n<tr>\n<td>Theorem</td>\n<td>定理</td>\n<td>已经被证明的是正确的内容</td>\n</tr>\n<tr>\n<td>Proposition</td>\n<td>命题</td>\n<td>不那么重要，但是又有点意思的正确的陈述</td>\n</tr>\n<tr>\n<td>Lemma</td>\n<td>引理</td>\n<td>用于证明其他内容的正确陈述</td>\n</tr>\n<tr>\n<td>Corollary</td>\n<td>推论</td>\n<td>从定理或命题中推导的正确陈述</td>\n</tr>\n<tr>\n<td>Proof</td>\n<td>证明</td>\n<td>解释写的东西为什么是正确的</td>\n</tr>\n<tr>\n<td>Conjecture</td>\n<td>猜想</td>\n<td>认为是正确的，但是没证出来的陈述</td>\n</tr>\n<tr>\n<td>Axiom</td>\n<td>公理</td>\n<td>关于数学的基本假设</td>\n</tr>\n<tr>\n<td>Note</td>\n<td>注释</td>\n<td>澄清没有解释清楚的事情</td>\n</tr>\n<tr>\n<td>Remark</td>\n<td>评述</td>\n<td>强调\\讨论\\评论其他的概念或见解</td>\n</tr>\n</tbody></table>\n<h1 id=\"个人理解\"><a href=\"#个人理解\" class=\"headerlink\" title=\"个人理解\"></a>个人理解</h1><p>上述的术语在应用类型的运筹文章中，比较常见的有Definition、Theorem、Proposition、Lemma、Proof。<br>通常在模型或问题提出后，为了增加文章的理论深度，提出一些关于模型的有意思的、略带深度的性质，并提供证明Proof。<br>个人觉得Theorem是一个严肃的内容，其定义是“已经被证明的正确的内容“，但是在文章中证明出来了，<br>就算的上是”已经被证明“了。</p>\n<p>Lemma、Proposition、Theorem的边界并不是清晰的，所以怎么用都行。<br>但是重要性的排序个人认为是：Theorem &gt; Proposition &gt; Lemma。</p>\n<p>Remark一般在证明最后，强调一下和其他人的不同，或者强调有意义的事情。</p>\n","excerpt":"","more":"<p><strong>前言</strong>：在运筹论文中，总会出现一些Proposition, Theorem, 等类似的模型相关术语，<br>理解这些术语的内涵有助于揣测作者写作的着重点，更有助于理解文章的内容。</p>\n<h1 id=\"术语、含义\"><a href=\"#术语、含义\" class=\"headerlink\" title=\"术语、含义\"></a>术语、含义</h1><table>\n<thead>\n<tr>\n<th>术语</th>\n<th>含义</th>\n<th>用途</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Definition</td>\n<td>定义</td>\n<td>定义一个词的含义</td>\n</tr>\n<tr>\n<td>Theorem</td>\n<td>定理</td>\n<td>已经被证明的是正确的内容</td>\n</tr>\n<tr>\n<td>Proposition</td>\n<td>命题</td>\n<td>不那么重要，但是又有点意思的正确的陈述</td>\n</tr>\n<tr>\n<td>Lemma</td>\n<td>引理</td>\n<td>用于证明其他内容的正确陈述</td>\n</tr>\n<tr>\n<td>Corollary</td>\n<td>推论</td>\n<td>从定理或命题中推导的正确陈述</td>\n</tr>\n<tr>\n<td>Proof</td>\n<td>证明</td>\n<td>解释写的东西为什么是正确的</td>\n</tr>\n<tr>\n<td>Conjecture</td>\n<td>猜想</td>\n<td>认为是正确的，但是没证出来的陈述</td>\n</tr>\n<tr>\n<td>Axiom</td>\n<td>公理</td>\n<td>关于数学的基本假设</td>\n</tr>\n<tr>\n<td>Note</td>\n<td>注释</td>\n<td>澄清没有解释清楚的事情</td>\n</tr>\n<tr>\n<td>Remark</td>\n<td>评述</td>\n<td>强调\\讨论\\评论其他的概念或见解</td>\n</tr>\n</tbody></table>\n<h1 id=\"个人理解\"><a href=\"#个人理解\" class=\"headerlink\" title=\"个人理解\"></a>个人理解</h1><p>上述的术语在应用类型的运筹文章中，比较常见的有Definition、Theorem、Proposition、Lemma、Proof。<br>通常在模型或问题提出后，为了增加文章的理论深度，提出一些关于模型的有意思的、略带深度的性质，并提供证明Proof。<br>个人觉得Theorem是一个严肃的内容，其定义是“已经被证明的正确的内容“，但是在文章中证明出来了，<br>就算的上是”已经被证明“了。</p>\n<p>Lemma、Proposition、Theorem的边界并不是清晰的，所以怎么用都行。<br>但是重要性的排序个人认为是：Theorem &gt; Proposition &gt; Lemma。</p>\n<p>Remark一般在证明最后，强调一下和其他人的不同，或者强调有意义的事情。</p>\n"},{"title":"爱思唯尔期刊Latex模板elsarticle使用心得经验","date":"2024-08-24T13:07:00.000Z","_content":"<!-- {% katex %} \\int_a^b \\sin x dx{% endkatex %} -->\n\nLaTex是科研写作中常见的排版工具。爱思唯尔期刊提供了Latex模板，使用该模板可简化在投稿过程中关于稿件的排版过程，在编译过后就能得到期刊认可的排版格式。\n\n不少期刊都已经采用了“Your paper your way”的投稿方式，即根据作者的喜好的排版方式提交稿件，在接收后排版成期刊的要求的格式即可，但也提供了Latex模板。\n关于爱思唯尔期刊的Latex模板，详见https://www.elsevier.com/researcher/author/policies-and-guidelines/latex-instructions\n\n尽管**内容大于形式，红楼梦手抄一万遍也是经典，我的博客打印出来也只是我的博客**，\n但我们使用Latex模板将给审稿人表达一种专业且认真的态度，也可以简化写作、排版、公式输入及编号、交叉引用的流程。\n\n请注意：<u>阅读本文需要一定Latex使用经验，且本文只针对爱思唯尔期刊Latex模板elsarticle有效。</u>\n\n# 1. 使用的宏包介绍\n\n```latex\n% \\usepackage[numbers]{natbib}\n% \\usepackage[authoryear,longnamesfirst]{natbib}\n\\usepackage[authoryear]{natbib}\n```\n该宏包是elsarticle自带的引用格式的宏包，一般我选择使用第三个`[authoryear]`参数。\n\n```latex\n\\usepackage{lineno}\n```\n`lineno`是行号宏包，投稿时如需加行号则使用此宏包。\n然而，该宏包对于模板的双列布局可用，但是支持性一般。\n此外**不推荐使用双列模板**，除非没有长公式或者长图、长表等等，\nelsarticle的双列模板虽然好看，但是给排版（尤其是跨列图、表、公式）带来诸多困难。\n\n```latex\n\\usepackage{threeparttable} \n```\n`threeparttable`可以实现表格以及表格下方的注释，十分好用。\n\n```latex\n\\usepackage[ruled,linesnumbered]{algorithm2e} \n```\n`algorithm2e`是算法伪代码的常用宏包。\n\n```latex\n\\usepackage{subcaption}\n```\n`subcaption` 可以实现子图\n\n```latex\n\\usepackage[nameinlink,capitalize]{cleveref} \n```\n`cleveref` 实现交叉引用带label名字，比如`Section 1`, 而不是使用`\\ref`仅引用一个数字。\n**该宏包最好放在所有宏包命令的最后**\n\n```latex\n\\usepackage{pdflscape} % 单页横置\n```\n`pdflscape`是某页横置的包，支持pdf旋转，比`landscape`更好一些。\n`landscape`编译出来后，pdf内容是横置的，但是页面仍是竖置，而`pdflscape`的页面也是横置的。\n\n```latex\n\\usepackage{midpage} % 页面垂直居中内容\n```\n`midpage`配合`pdflscape`使用，可以使用横置的内容位于页面的垂直方向的中心（垂直居中）。\n再配合横向居中`\\centering`使用，就是页面的正中心。\n\n\n```latex\n\\usepackage{afterpage} % 减少横向排版某页前后的空白页\n```\n`afterpage`配合`pdflscape`使用，可避免`pdflscape`使用前后文章出现大面积空白（因为`pdflscape`在哪里使用就在哪里分页）。\n\n# 2. 实践例子\nMinimal Working Example (MWE) 是Latex是一个精简到最小长度的.tex文件。是一个可以运行的，最简短的tex文件。\n以下例子均基于`MWE`或者elsarticle的`cas-sc-sample.tex`文件进行展示。\n文本填充使用了`lipsum`宏包生成随机文本\n\n## 行号 `lineno`\n展示行号使用了lineno宏包，代码如下：\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{lineno}\n\n\\begin{document}\n\\let\\WriteBookmarks\\relax\n\\def\\floatpagepagefraction{1}\n\\def\\textpagefraction{.001}\n\n\\title [mode = title]{This is a title}                      \n\\author[1]{Name}[]\n\n\\begin{abstract}\n  Null.\n\\end{abstract}\n\n\\begin{keywords}\n  Null\n\\end{keywords}\n\n\\maketitle\n\n\\linenumbers\n\\section{Introduction}\n\\lipsum[1]\n\n\\end{document}\n```\n`\\linenumbers`命令放在节标题前面就可以生成行号了，结果如下：\n\n![行号生成](../images/20240824/2024-08-27-14-21-28.png)\n\n## 表格注释`threeparttable`\n在表格展示结果的过程中总会有需要在表格下方注释的情况，使用`threeparttable`宏包可满足该需求。\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{threeparttable}\n\n\\begin{document}\n\\let\\WriteBookmarks\\relax\n\\def\\floatpagepagefraction{1}\n\\def\\textpagefraction{.001}\n\n\\title [mode = title]{This is a title}                      \n\\author[1]{Name}[]\n\n\\begin{abstract}\n  Null.\n\\end{abstract}\n\n\\begin{keywords}\n  Null\n\\end{keywords}\n\n\\maketitle\n\n\\section{Introduction}\n\\lipsum[1]\n\n\\begin{table}[width=0.4\\textwidth, pos=thb]\n\\scriptsize\n\\tabcolsep=2.5pt\n\\renewcommand\\arraystretch{1.5}\n\\centering\n\\caption{Table notes}\n\\label{tb:review}%\n\\begin{threeparttable}\n  \\begin{tabular*}{\\tblwidth}{lcclccl}\n    \\toprule\n    Ref. & \\multicolumn{2}{c}{Omnichannel concept} & \\multicolumn{2}{l}{Customer} & \\multicolumn{1}{l}{Store}  \\\\\n    \\midrule\n    O\\tnote{a} & F  & S & M  & P & S  & L,C   \\\\\n    C & R  & S & M\\tnote{*}  & C & H  & L,R   \\\\\n    O & R  & S & M  & C & H  & L,R\\tnote{$\\dagger$} \\\\\n    \\bottomrule\n  \\end{tabular*}%\n\n  \\begin{tablenotes}\n    \\scriptsize\n    \\item[a] table note a \n    \\item[*] asterisk\n    \\item[$\\dagger$] dagger\n  \\end{tablenotes}\n\\end{threeparttable}\n\\end{table}\n\n\\end{document}\n```\n这会生成一个带有注释的表格。\n\n![表格注释](../images/20240824/tablenote.png)\n\n## 伪代码\n请参考Overleaf的伪代码包，写的非常详细。\nhttps://www.overleaf.com/learn/latex/Algorithms\n\n## 子图 `subcaption`\n使用子图，只需要引用`subcaption`宏包即可，子图换行使用`\\\\`即可。\n\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{subcaption}\n\n\\begin{document}\n\\let\\WriteBookmarks\\relax\n\\def\\floatpagepagefraction{1}\n\\def\\textpagefraction{.001}\n\n\\title [mode = title]{This is a title}                      \n\\author[1]{Name}[]\n\n\\begin{abstract}\n  Null.\n\\end{abstract}\n\n\\begin{keywords}\n  Null\n\\end{keywords}\n\n\\maketitle\n\n\\section{Introduction}\n\\lipsum[1]\n\n\\begin{figure}[pos = htb]\n  \\centering\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 1}\n    \\label{subfig:routes}\n  \\end{subfigure}\n  \\hfill\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 2}\n    \\label{subfig:cycle}\n  \\end{subfigure}\n  \\hfill\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 3}\n    \\label{subfig:aggregate}\n  \\end{subfigure}\n  \\\\\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 4}\n    \\label{subfig:assign}\n  \\end{subfigure}\n  \\hspace{0.15\\textwidth}\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 5}\n    \\label{subfig:newroute}\n  \\end{subfigure}\n  \\caption{\\label{fig:aggr} Subfigures}\n\\end{figure}\n\n\\end{document}\n```\n这会生成一个两行子图，第一行有3张，第二行有2张。\n![表格注释](../images/20240824/subfigure.png)\n\n## 交叉引用 `cleveref`\n交叉引用是Latex一个重要的功能，自带的`\\ref`功能只能引用数字，生成出来的效果并不好看，比如“Section <span style=\"color:blue;\">1.1 </span>”, 而不是期刊常见的“<span style=\"color:blue;\">Section 1.1 </span>”。使用`cleveref`宏包解决这个问题。\n\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{subcaption}\n\\usepackage[nameinlink,capitalize]{cleveref}\n\n\n\\begin{document}\n\\let\\WriteBookmarks\\relax\n\\def\\floatpagepagefraction{1}\n\\def\\textpagefraction{.001}\n\n\\title [mode = title]{This is a title}                      \n\\author[1]{Name}[]\n\n\\begin{abstract}\n  Null.\n\\end{abstract}\n\n\\begin{keywords}\n  Null\n\\end{keywords}\n\n\\maketitle\n\n\\section{Introduction}\n\\Cref{subfig:assign} is in \\Cref{fig:aggr}. \n\n\\begin{figure}[pos = htb]\n  \\centering\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 1}\n    \\label{subfig:routes}\n  \\end{subfigure}\n  \\hfill\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 2}\n    \\label{subfig:cycle}\n  \\end{subfigure}\n  \\hfill\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 3}\n    \\label{subfig:aggregate}\n  \\end{subfigure}\n  \\\\\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 4}\n    \\label{subfig:assign}\n  \\end{subfigure}\n  \\hspace{0.15\\textwidth}\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 5}\n    \\label{subfig:newroute}\n  \\end{subfigure}\n  \\caption{\\label{fig:aggr} Subfigures}\n\\end{figure}\n\n\\end{document}\n```\n这会生成一个带引用类型的交叉引用格式。\n![ref](../images/20240824/cleveref.png)\n\n## 横置某页 `pdflscape` `midpage` `afterpage`\n横置一个pdf页码可以解决某个表格或者图太长的问题，使用`pdflscape`可以将某一页横置，以放下这些图表。\n基础使用方法如下：\n\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{subcaption}\n\\usepackage{pdflscape} \n\\usepackage[nameinlink,capitalize]{cleveref}\n\n\\begin{document}\n\\let\\WriteBookmarks\\relax\n\\def\\floatpagepagefraction{1}\n\\def\\textpagefraction{.001}\n\n\\title [mode = title]{This is a title}                      \n\\author[1]{Name}[]\n\n\\begin{abstract}\n  Null.\n\\end{abstract}\n\n\\begin{keywords}\n  Null\n\\end{keywords}\n\n\\maketitle\n\n\\section{Introduction}\n\\Cref{subfig:assign} is in \\Cref{fig:aggr}. \n\n\\begin{landscape}\n  \\begin{figure}[pos = htb]\n    \\centering\n    \\begin{subfigure}{0.3\\textwidth}\n      \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n      \\caption{subfigure 1}\n      \\label{subfig:routes}\n    \\end{subfigure}\n    \\hfill\n    \\begin{subfigure}{0.3\\textwidth}\n      \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n      \\caption{subfigure 2}\n      \\label{subfig:cycle}\n    \\end{subfigure}\n    \\hfill\n    \\begin{subfigure}{0.3\\textwidth}\n      \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n      \\caption{subfigure 3}\n      \\label{subfig:aggregate}\n    \\end{subfigure}\n    \\\\\n    \\begin{subfigure}{0.3\\textwidth}\n      \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n      \\caption{subfigure 4}\n      \\label{subfig:assign}\n    \\end{subfigure}\n    \\hspace{0.15\\textwidth}\n    \\begin{subfigure}{0.3\\textwidth}\n      \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n      \\caption{subfigure 5}\n      \\label{subfig:newroute}\n    \\end{subfigure}\n    \\caption{\\label{fig:aggr} Subfigures}\n  \\end{figure}\n\\end{landscape}\n\\end{document}\n```\n这会得到一个横置的页面,注意到这个页面是横置的，所有的内容在页面的上方，下一步是把这些图片垂直居中。\n![landscape](../images/20240824/landscape.png)\n只需要在`landscape`和`figure`环境之间套一层`midpage`环境即可。\n\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{subcaption}\n\\usepackage{pdflscape} \n\\usepackage{midpage}\n\n\\begin{document}\n\n\\begin{landscape}\n  \\begin{midpage}\n    \\begin{figure}[pos = htb]\n      ... 图表代码\n    \\end{figure}\n  \\end{midpage}\n\\end{landscape}\n\n\\end{document}\n```\n得到居中的插图：\n![landscape](../images/20240824/landscape_center.png)\n\n但是，横置页前后的文字会因为横置页突然打断，出现大面积空白。这时还需要`afterpage`宏包，使得横置页平滑插入到文字中，用`\\afterpage{}`命令把`landscape`环境包裹起来。\n\n\n\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{subcaption}\n\\usepackage{pdflscape} \n\\usepackage{midpage}\n\n\\begin{document}\n\\afterpage{\n  \\begin{landscape}\n    \\begin{midpage}\n      \\begin{figure}[pos = htb]\n        ... 图表代码\n      \\end{figure}\n    \\end{midpage}\n  \\end{landscape}\n}\n\\end{document}\n```\n生成的效果如图，可见横置页丝滑插入段落中，没有产生大面积空白\n\n![landscape](../images/20240824/landscape_after.png)\n\n## 禁止分页\n使用`\\nopagebreak`表示禁止在此处断页。\n\n此外，还可以使用\n```latex\n\\usepackage{parskip}\n\\AddToHook{env/samepage/begin}{%\n\\AddToHook{para/before}{\\nopagebreak}%\n\\AddToHook{para/after}{\\nopagebreak}%\n}\n\n\\begin{samepage}\n在一页的第一段\n\n在一页的第二段\n\\end{samepage}\n```\n另两个段落出现在同一页。\n\n## 公式间距微调\n参考这篇文章https://tex.stackexchange.com/questions/74353/what-commands-are-there-for-horizontal-spacing\n下面的源代码将在字母ab之间产生不同大小的横向间距。\n\n```latex\n\\documentclass{article}\n\n\\usepackage[margin=1in]{geometry}% Just for this example\n\\setlength{\\parindent}{0pt}% Just for this example\n\n\\begin{document}\n\nThere are a number of horizontal spacing macros for LaTeX:\n\n\\begin{tabular}{lp{5cm}}\n  \\verb|a\\,b|                     & a\\,b \\quad $a\\, b$ \\\\\n  \\verb|a\\thinspace b|            & a\\thinspace b \\quad $a\\thinspace b$ \\\\\n  \\verb|a\\!b|                     & a\\!b \\quad $a\\!b$ \\\\\n  \\verb|a\\negthinspace b|         & a\\negthinspace b \\quad $a\\negthinspace b$ \\\\\n  \\verb|a\\:b|                     & a\\:b \\quad $a\\:b$ \\\\\n  \\verb|a\\>b|                     & a\\>b \\quad $a\\>b$ \\\\\n  \\verb|a\\medspace b|             & a\\medspace b \\quad $a\\medspace b$ \\\\\n  \\verb|a\\negmedspace b|          & a\\negmedspace b \\quad $a\\negmedspace b$ \\\\\n  \\verb|a\\;b|                     & a\\;b \\quad $a\\;b$ \\\\\n  \\verb|a\\thickspace b|           & a\\thickspace b \\quad $a\\thickspace b$ \\\\\n  \\verb|a\\negthickspace b|        & a\\negthickspace b \\quad $a\\negthickspace b$ \\\\\n  \\verb|$a\\mkern\\thinmuskip b$|   & $a\\mkern\\thinmuskip b$ (similar to \\verb|\\,|) \\\\\n  \\verb|$a\\mkern-\\thinmuskip b$|  & $a\\mkern-\\thinmuskip b$ (similar to \\verb|\\!|) \\\\\n  \\verb|$a\\mkern\\medmuskip b$|    & $a\\mkern\\medmuskip b$ (similar to \\verb|\\:| or \\verb|\\>|) \\\\\n  \\verb|$a\\mkern-\\medmuskip b$|   & $a\\mkern-\\medmuskip b$ (similar to \\verb|\\negmedspace|) \\\\\n  \\verb|$a\\mkern\\thickmuskip b$|  & $a\\mkern\\thickmuskip b$ (similar to \\verb|\\;|) \\\\\n  \\verb|$a\\mkern-\\thickmuskip b$| & $a\\mkern-\\thickmuskip b$ (similar to \\verb|\\negthickspace|) \\\\\n  \\verb|a\\enspace b|              & a\\enspace b \\\\\n  \\verb|$a\\enspace b$|            & $a\\enspace b$ \\\\\n  \\verb|a\\quad b|                 & a\\quad b \\\\\n  \\verb|$a\\quad b$|               & $a\\quad b$ \\\\\n  \\verb|a\\qquad b|                & a\\qquad b \\\\\n  \\verb|$a\\qquad b$|              & $a\\qquad b$ \\\\\n  \\verb|a\\hskip 1em b|            & a\\hskip 1em b \\\\\n  \\verb|$a\\hskip 1em b$|          & $a\\hskip 1em b$ \\\\\n  \\verb|a\\kern 1pc b|             & a\\kern 1pc b \\\\\n  \\verb|$a\\kern 1pc b$|           & $a\\kern 1pc b$ \\\\\n  \\verb|$a\\mkern 17mu b$|         & $a\\mkern 17mu b$ \\\\\n  \\verb|a\\hspace{35pt}b|          & a\\hspace{35pt}b \\\\\n  \\verb|$a\\hspace{35pt}b$|        & $a\\hspace{35pt}b$ \\\\\n  \\verb|axyzb|                    & axyzb \\\\\n  \\verb|a\\hphantom{xyz}b|         & a\\hphantom{xyz}b (or just \\verb|\\phantom|) \\\\\n  \\verb|$axyzb$|                  & $axyzb$ \\\\\n  \\verb|$a\\hphantom{xyz}b$|       & $a\\hphantom{xyz}b$ (or just \\verb|\\phantom|) \\\\\n  \\verb|a b|                      & a b \\\\\n  \\verb|$a b$|                    & $a b$ \\\\\n  \\verb|a\\space b|                & a\\space b \\\\\n  \\verb|$a\\space b$|              & $a\\space b$ \\\\\n  \\verb|a\\ b|                     & a\\ b \\\\\n  \\verb|$a\\ b$|                   & $a\\ b$ \\\\\n  \\verb|a{ }b|                    & a{ }b \\\\\n  \\verb|$a{ }b$|                  & $a{ }b$ \\\\\n  \\verb|a~b|                      & a~b \\\\\n  \\verb|$a~b$|                    & $a~b$ \\\\\n  \\verb|a\\hfill b|                & a\\hfill b \\\\\n  \\verb|$a\\hfill b$|              & $a\\hfill b$\n\\end{tabular}\n\n\\end{document}\n```\n\n其中，控制间距的代码是可以在公式环境内部调整的。\n```latex\n\\begin{equation}\n\\thinmuskip=3mu\n\\medmuskip=4mu plus 2mu minus 4mu\n\\thickmuskip=5mu plus 5mu\na + b = c\n\\end{equation}\n```","source":"_posts/2024-08-24-elsarticle.md","raw":"---\ntitle: 爱思唯尔期刊Latex模板elsarticle使用心得经验\ntag: Latex\ndate: 2024-08-24 21:07:00\n---\n<!-- {% katex %} \\int_a^b \\sin x dx{% endkatex %} -->\n\nLaTex是科研写作中常见的排版工具。爱思唯尔期刊提供了Latex模板，使用该模板可简化在投稿过程中关于稿件的排版过程，在编译过后就能得到期刊认可的排版格式。\n\n不少期刊都已经采用了“Your paper your way”的投稿方式，即根据作者的喜好的排版方式提交稿件，在接收后排版成期刊的要求的格式即可，但也提供了Latex模板。\n关于爱思唯尔期刊的Latex模板，详见https://www.elsevier.com/researcher/author/policies-and-guidelines/latex-instructions\n\n尽管**内容大于形式，红楼梦手抄一万遍也是经典，我的博客打印出来也只是我的博客**，\n但我们使用Latex模板将给审稿人表达一种专业且认真的态度，也可以简化写作、排版、公式输入及编号、交叉引用的流程。\n\n请注意：<u>阅读本文需要一定Latex使用经验，且本文只针对爱思唯尔期刊Latex模板elsarticle有效。</u>\n\n# 1. 使用的宏包介绍\n\n```latex\n% \\usepackage[numbers]{natbib}\n% \\usepackage[authoryear,longnamesfirst]{natbib}\n\\usepackage[authoryear]{natbib}\n```\n该宏包是elsarticle自带的引用格式的宏包，一般我选择使用第三个`[authoryear]`参数。\n\n```latex\n\\usepackage{lineno}\n```\n`lineno`是行号宏包，投稿时如需加行号则使用此宏包。\n然而，该宏包对于模板的双列布局可用，但是支持性一般。\n此外**不推荐使用双列模板**，除非没有长公式或者长图、长表等等，\nelsarticle的双列模板虽然好看，但是给排版（尤其是跨列图、表、公式）带来诸多困难。\n\n```latex\n\\usepackage{threeparttable} \n```\n`threeparttable`可以实现表格以及表格下方的注释，十分好用。\n\n```latex\n\\usepackage[ruled,linesnumbered]{algorithm2e} \n```\n`algorithm2e`是算法伪代码的常用宏包。\n\n```latex\n\\usepackage{subcaption}\n```\n`subcaption` 可以实现子图\n\n```latex\n\\usepackage[nameinlink,capitalize]{cleveref} \n```\n`cleveref` 实现交叉引用带label名字，比如`Section 1`, 而不是使用`\\ref`仅引用一个数字。\n**该宏包最好放在所有宏包命令的最后**\n\n```latex\n\\usepackage{pdflscape} % 单页横置\n```\n`pdflscape`是某页横置的包，支持pdf旋转，比`landscape`更好一些。\n`landscape`编译出来后，pdf内容是横置的，但是页面仍是竖置，而`pdflscape`的页面也是横置的。\n\n```latex\n\\usepackage{midpage} % 页面垂直居中内容\n```\n`midpage`配合`pdflscape`使用，可以使用横置的内容位于页面的垂直方向的中心（垂直居中）。\n再配合横向居中`\\centering`使用，就是页面的正中心。\n\n\n```latex\n\\usepackage{afterpage} % 减少横向排版某页前后的空白页\n```\n`afterpage`配合`pdflscape`使用，可避免`pdflscape`使用前后文章出现大面积空白（因为`pdflscape`在哪里使用就在哪里分页）。\n\n# 2. 实践例子\nMinimal Working Example (MWE) 是Latex是一个精简到最小长度的.tex文件。是一个可以运行的，最简短的tex文件。\n以下例子均基于`MWE`或者elsarticle的`cas-sc-sample.tex`文件进行展示。\n文本填充使用了`lipsum`宏包生成随机文本\n\n## 行号 `lineno`\n展示行号使用了lineno宏包，代码如下：\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{lineno}\n\n\\begin{document}\n\\let\\WriteBookmarks\\relax\n\\def\\floatpagepagefraction{1}\n\\def\\textpagefraction{.001}\n\n\\title [mode = title]{This is a title}                      \n\\author[1]{Name}[]\n\n\\begin{abstract}\n  Null.\n\\end{abstract}\n\n\\begin{keywords}\n  Null\n\\end{keywords}\n\n\\maketitle\n\n\\linenumbers\n\\section{Introduction}\n\\lipsum[1]\n\n\\end{document}\n```\n`\\linenumbers`命令放在节标题前面就可以生成行号了，结果如下：\n\n![行号生成](../images/20240824/2024-08-27-14-21-28.png)\n\n## 表格注释`threeparttable`\n在表格展示结果的过程中总会有需要在表格下方注释的情况，使用`threeparttable`宏包可满足该需求。\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{threeparttable}\n\n\\begin{document}\n\\let\\WriteBookmarks\\relax\n\\def\\floatpagepagefraction{1}\n\\def\\textpagefraction{.001}\n\n\\title [mode = title]{This is a title}                      \n\\author[1]{Name}[]\n\n\\begin{abstract}\n  Null.\n\\end{abstract}\n\n\\begin{keywords}\n  Null\n\\end{keywords}\n\n\\maketitle\n\n\\section{Introduction}\n\\lipsum[1]\n\n\\begin{table}[width=0.4\\textwidth, pos=thb]\n\\scriptsize\n\\tabcolsep=2.5pt\n\\renewcommand\\arraystretch{1.5}\n\\centering\n\\caption{Table notes}\n\\label{tb:review}%\n\\begin{threeparttable}\n  \\begin{tabular*}{\\tblwidth}{lcclccl}\n    \\toprule\n    Ref. & \\multicolumn{2}{c}{Omnichannel concept} & \\multicolumn{2}{l}{Customer} & \\multicolumn{1}{l}{Store}  \\\\\n    \\midrule\n    O\\tnote{a} & F  & S & M  & P & S  & L,C   \\\\\n    C & R  & S & M\\tnote{*}  & C & H  & L,R   \\\\\n    O & R  & S & M  & C & H  & L,R\\tnote{$\\dagger$} \\\\\n    \\bottomrule\n  \\end{tabular*}%\n\n  \\begin{tablenotes}\n    \\scriptsize\n    \\item[a] table note a \n    \\item[*] asterisk\n    \\item[$\\dagger$] dagger\n  \\end{tablenotes}\n\\end{threeparttable}\n\\end{table}\n\n\\end{document}\n```\n这会生成一个带有注释的表格。\n\n![表格注释](../images/20240824/tablenote.png)\n\n## 伪代码\n请参考Overleaf的伪代码包，写的非常详细。\nhttps://www.overleaf.com/learn/latex/Algorithms\n\n## 子图 `subcaption`\n使用子图，只需要引用`subcaption`宏包即可，子图换行使用`\\\\`即可。\n\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{subcaption}\n\n\\begin{document}\n\\let\\WriteBookmarks\\relax\n\\def\\floatpagepagefraction{1}\n\\def\\textpagefraction{.001}\n\n\\title [mode = title]{This is a title}                      \n\\author[1]{Name}[]\n\n\\begin{abstract}\n  Null.\n\\end{abstract}\n\n\\begin{keywords}\n  Null\n\\end{keywords}\n\n\\maketitle\n\n\\section{Introduction}\n\\lipsum[1]\n\n\\begin{figure}[pos = htb]\n  \\centering\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 1}\n    \\label{subfig:routes}\n  \\end{subfigure}\n  \\hfill\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 2}\n    \\label{subfig:cycle}\n  \\end{subfigure}\n  \\hfill\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 3}\n    \\label{subfig:aggregate}\n  \\end{subfigure}\n  \\\\\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 4}\n    \\label{subfig:assign}\n  \\end{subfigure}\n  \\hspace{0.15\\textwidth}\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 5}\n    \\label{subfig:newroute}\n  \\end{subfigure}\n  \\caption{\\label{fig:aggr} Subfigures}\n\\end{figure}\n\n\\end{document}\n```\n这会生成一个两行子图，第一行有3张，第二行有2张。\n![表格注释](../images/20240824/subfigure.png)\n\n## 交叉引用 `cleveref`\n交叉引用是Latex一个重要的功能，自带的`\\ref`功能只能引用数字，生成出来的效果并不好看，比如“Section <span style=\"color:blue;\">1.1 </span>”, 而不是期刊常见的“<span style=\"color:blue;\">Section 1.1 </span>”。使用`cleveref`宏包解决这个问题。\n\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{subcaption}\n\\usepackage[nameinlink,capitalize]{cleveref}\n\n\n\\begin{document}\n\\let\\WriteBookmarks\\relax\n\\def\\floatpagepagefraction{1}\n\\def\\textpagefraction{.001}\n\n\\title [mode = title]{This is a title}                      \n\\author[1]{Name}[]\n\n\\begin{abstract}\n  Null.\n\\end{abstract}\n\n\\begin{keywords}\n  Null\n\\end{keywords}\n\n\\maketitle\n\n\\section{Introduction}\n\\Cref{subfig:assign} is in \\Cref{fig:aggr}. \n\n\\begin{figure}[pos = htb]\n  \\centering\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 1}\n    \\label{subfig:routes}\n  \\end{subfigure}\n  \\hfill\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 2}\n    \\label{subfig:cycle}\n  \\end{subfigure}\n  \\hfill\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 3}\n    \\label{subfig:aggregate}\n  \\end{subfigure}\n  \\\\\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 4}\n    \\label{subfig:assign}\n  \\end{subfigure}\n  \\hspace{0.15\\textwidth}\n  \\begin{subfigure}{0.3\\textwidth}\n    \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n    \\caption{subfigure 5}\n    \\label{subfig:newroute}\n  \\end{subfigure}\n  \\caption{\\label{fig:aggr} Subfigures}\n\\end{figure}\n\n\\end{document}\n```\n这会生成一个带引用类型的交叉引用格式。\n![ref](../images/20240824/cleveref.png)\n\n## 横置某页 `pdflscape` `midpage` `afterpage`\n横置一个pdf页码可以解决某个表格或者图太长的问题，使用`pdflscape`可以将某一页横置，以放下这些图表。\n基础使用方法如下：\n\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{subcaption}\n\\usepackage{pdflscape} \n\\usepackage[nameinlink,capitalize]{cleveref}\n\n\\begin{document}\n\\let\\WriteBookmarks\\relax\n\\def\\floatpagepagefraction{1}\n\\def\\textpagefraction{.001}\n\n\\title [mode = title]{This is a title}                      \n\\author[1]{Name}[]\n\n\\begin{abstract}\n  Null.\n\\end{abstract}\n\n\\begin{keywords}\n  Null\n\\end{keywords}\n\n\\maketitle\n\n\\section{Introduction}\n\\Cref{subfig:assign} is in \\Cref{fig:aggr}. \n\n\\begin{landscape}\n  \\begin{figure}[pos = htb]\n    \\centering\n    \\begin{subfigure}{0.3\\textwidth}\n      \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n      \\caption{subfigure 1}\n      \\label{subfig:routes}\n    \\end{subfigure}\n    \\hfill\n    \\begin{subfigure}{0.3\\textwidth}\n      \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n      \\caption{subfigure 2}\n      \\label{subfig:cycle}\n    \\end{subfigure}\n    \\hfill\n    \\begin{subfigure}{0.3\\textwidth}\n      \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n      \\caption{subfigure 3}\n      \\label{subfig:aggregate}\n    \\end{subfigure}\n    \\\\\n    \\begin{subfigure}{0.3\\textwidth}\n      \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n      \\caption{subfigure 4}\n      \\label{subfig:assign}\n    \\end{subfigure}\n    \\hspace{0.15\\textwidth}\n    \\begin{subfigure}{0.3\\textwidth}\n      \\includegraphics[width=\\textwidth]{figs/cas-grabs.pdf}\n      \\caption{subfigure 5}\n      \\label{subfig:newroute}\n    \\end{subfigure}\n    \\caption{\\label{fig:aggr} Subfigures}\n  \\end{figure}\n\\end{landscape}\n\\end{document}\n```\n这会得到一个横置的页面,注意到这个页面是横置的，所有的内容在页面的上方，下一步是把这些图片垂直居中。\n![landscape](../images/20240824/landscape.png)\n只需要在`landscape`和`figure`环境之间套一层`midpage`环境即可。\n\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{subcaption}\n\\usepackage{pdflscape} \n\\usepackage{midpage}\n\n\\begin{document}\n\n\\begin{landscape}\n  \\begin{midpage}\n    \\begin{figure}[pos = htb]\n      ... 图表代码\n    \\end{figure}\n  \\end{midpage}\n\\end{landscape}\n\n\\end{document}\n```\n得到居中的插图：\n![landscape](../images/20240824/landscape_center.png)\n\n但是，横置页前后的文字会因为横置页突然打断，出现大面积空白。这时还需要`afterpage`宏包，使得横置页平滑插入到文字中，用`\\afterpage{}`命令把`landscape`环境包裹起来。\n\n\n\n```latex\n\\documentclass[a4paper,fleqn]{cas-sc}\n\n\\usepackage{lipsum}\n\\usepackage{subcaption}\n\\usepackage{pdflscape} \n\\usepackage{midpage}\n\n\\begin{document}\n\\afterpage{\n  \\begin{landscape}\n    \\begin{midpage}\n      \\begin{figure}[pos = htb]\n        ... 图表代码\n      \\end{figure}\n    \\end{midpage}\n  \\end{landscape}\n}\n\\end{document}\n```\n生成的效果如图，可见横置页丝滑插入段落中，没有产生大面积空白\n\n![landscape](../images/20240824/landscape_after.png)\n\n## 禁止分页\n使用`\\nopagebreak`表示禁止在此处断页。\n\n此外，还可以使用\n```latex\n\\usepackage{parskip}\n\\AddToHook{env/samepage/begin}{%\n\\AddToHook{para/before}{\\nopagebreak}%\n\\AddToHook{para/after}{\\nopagebreak}%\n}\n\n\\begin{samepage}\n在一页的第一段\n\n在一页的第二段\n\\end{samepage}\n```\n另两个段落出现在同一页。\n\n## 公式间距微调\n参考这篇文章https://tex.stackexchange.com/questions/74353/what-commands-are-there-for-horizontal-spacing\n下面的源代码将在字母ab之间产生不同大小的横向间距。\n\n```latex\n\\documentclass{article}\n\n\\usepackage[margin=1in]{geometry}% Just for this example\n\\setlength{\\parindent}{0pt}% Just for this example\n\n\\begin{document}\n\nThere are a number of horizontal spacing macros for LaTeX:\n\n\\begin{tabular}{lp{5cm}}\n  \\verb|a\\,b|                     & a\\,b \\quad $a\\, b$ \\\\\n  \\verb|a\\thinspace b|            & a\\thinspace b \\quad $a\\thinspace b$ \\\\\n  \\verb|a\\!b|                     & a\\!b \\quad $a\\!b$ \\\\\n  \\verb|a\\negthinspace b|         & a\\negthinspace b \\quad $a\\negthinspace b$ \\\\\n  \\verb|a\\:b|                     & a\\:b \\quad $a\\:b$ \\\\\n  \\verb|a\\>b|                     & a\\>b \\quad $a\\>b$ \\\\\n  \\verb|a\\medspace b|             & a\\medspace b \\quad $a\\medspace b$ \\\\\n  \\verb|a\\negmedspace b|          & a\\negmedspace b \\quad $a\\negmedspace b$ \\\\\n  \\verb|a\\;b|                     & a\\;b \\quad $a\\;b$ \\\\\n  \\verb|a\\thickspace b|           & a\\thickspace b \\quad $a\\thickspace b$ \\\\\n  \\verb|a\\negthickspace b|        & a\\negthickspace b \\quad $a\\negthickspace b$ \\\\\n  \\verb|$a\\mkern\\thinmuskip b$|   & $a\\mkern\\thinmuskip b$ (similar to \\verb|\\,|) \\\\\n  \\verb|$a\\mkern-\\thinmuskip b$|  & $a\\mkern-\\thinmuskip b$ (similar to \\verb|\\!|) \\\\\n  \\verb|$a\\mkern\\medmuskip b$|    & $a\\mkern\\medmuskip b$ (similar to \\verb|\\:| or \\verb|\\>|) \\\\\n  \\verb|$a\\mkern-\\medmuskip b$|   & $a\\mkern-\\medmuskip b$ (similar to \\verb|\\negmedspace|) \\\\\n  \\verb|$a\\mkern\\thickmuskip b$|  & $a\\mkern\\thickmuskip b$ (similar to \\verb|\\;|) \\\\\n  \\verb|$a\\mkern-\\thickmuskip b$| & $a\\mkern-\\thickmuskip b$ (similar to \\verb|\\negthickspace|) \\\\\n  \\verb|a\\enspace b|              & a\\enspace b \\\\\n  \\verb|$a\\enspace b$|            & $a\\enspace b$ \\\\\n  \\verb|a\\quad b|                 & a\\quad b \\\\\n  \\verb|$a\\quad b$|               & $a\\quad b$ \\\\\n  \\verb|a\\qquad b|                & a\\qquad b \\\\\n  \\verb|$a\\qquad b$|              & $a\\qquad b$ \\\\\n  \\verb|a\\hskip 1em b|            & a\\hskip 1em b \\\\\n  \\verb|$a\\hskip 1em b$|          & $a\\hskip 1em b$ \\\\\n  \\verb|a\\kern 1pc b|             & a\\kern 1pc b \\\\\n  \\verb|$a\\kern 1pc b$|           & $a\\kern 1pc b$ \\\\\n  \\verb|$a\\mkern 17mu b$|         & $a\\mkern 17mu b$ \\\\\n  \\verb|a\\hspace{35pt}b|          & a\\hspace{35pt}b \\\\\n  \\verb|$a\\hspace{35pt}b$|        & $a\\hspace{35pt}b$ \\\\\n  \\verb|axyzb|                    & axyzb \\\\\n  \\verb|a\\hphantom{xyz}b|         & a\\hphantom{xyz}b (or just \\verb|\\phantom|) \\\\\n  \\verb|$axyzb$|                  & $axyzb$ \\\\\n  \\verb|$a\\hphantom{xyz}b$|       & $a\\hphantom{xyz}b$ (or just \\verb|\\phantom|) \\\\\n  \\verb|a b|                      & a b \\\\\n  \\verb|$a b$|                    & $a b$ \\\\\n  \\verb|a\\space b|                & a\\space b \\\\\n  \\verb|$a\\space b$|              & $a\\space b$ \\\\\n  \\verb|a\\ b|                     & a\\ b \\\\\n  \\verb|$a\\ b$|                   & $a\\ b$ \\\\\n  \\verb|a{ }b|                    & a{ }b \\\\\n  \\verb|$a{ }b$|                  & $a{ }b$ \\\\\n  \\verb|a~b|                      & a~b \\\\\n  \\verb|$a~b$|                    & $a~b$ \\\\\n  \\verb|a\\hfill b|                & a\\hfill b \\\\\n  \\verb|$a\\hfill b$|              & $a\\hfill b$\n\\end{tabular}\n\n\\end{document}\n```\n\n其中，控制间距的代码是可以在公式环境内部调整的。\n```latex\n\\begin{equation}\n\\thinmuskip=3mu\n\\medmuskip=4mu plus 2mu minus 4mu\n\\thickmuskip=5mu plus 5mu\na + b = c\n\\end{equation}\n```","slug":"2024-08-24-elsarticle","published":1,"updated":"2024-08-27T08:05:56.270Z","comments":1,"layout":"post","photos":[],"_id":"cm0epapyp0006hjm10tf553hh","content":"<!-- <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>∫</mo><mi>a</mi><mi>b</mi></msubsup><mi>sin</mi><mo>⁡</mo><mi>x</mi><mi>d</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\int_a^b \\sin x dx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.3998em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.044em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span><span style=\"top:-3.2579em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span></span> -->\n\n<p>LaTex是科研写作中常见的排版工具。爱思唯尔期刊提供了Latex模板，使用该模板可简化在投稿过程中关于稿件的排版过程，在编译过后就能得到期刊认可的排版格式。</p>\n<p>不少期刊都已经采用了“Your paper your way”的投稿方式，即根据作者的喜好的排版方式提交稿件，在接收后排版成期刊的要求的格式即可，但也提供了Latex模板。<br>关于爱思唯尔期刊的Latex模板，详见<a href=\"https://www.elsevier.com/researcher/author/policies-and-guidelines/latex-instructions\">https://www.elsevier.com/researcher/author/policies-and-guidelines/latex-instructions</a></p>\n<p>尽管<strong>内容大于形式，红楼梦手抄一万遍也是经典，我的博客打印出来也只是我的博客</strong>，<br>但我们使用Latex模板将给审稿人表达一种专业且认真的态度，也可以简化写作、排版、公式输入及编号、交叉引用的流程。</p>\n<p>请注意：<u>阅读本文需要一定Latex使用经验，且本文只针对爱思唯尔期刊Latex模板elsarticle有效。</u></p>\n<h1 id=\"1-使用的宏包介绍\"><a href=\"#1-使用的宏包介绍\" class=\"headerlink\" title=\"1. 使用的宏包介绍\"></a>1. 使用的宏包介绍</h1><figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">% \\usepackage[numbers]&#123;natbib&#125;</span></span><br><span class=\"line\"><span class=\"comment\">% \\usepackage[authoryear,longnamesfirst]&#123;natbib&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[authoryear]&#123;natbib&#125;</span><br></pre></td></tr></table></figure>\n<p>该宏包是elsarticle自带的引用格式的宏包，一般我选择使用第三个<code>[authoryear]</code>参数。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lineno&#125;</span><br></pre></td></tr></table></figure>\n<p><code>lineno</code>是行号宏包，投稿时如需加行号则使用此宏包。<br>然而，该宏包对于模板的双列布局可用，但是支持性一般。<br>此外<strong>不推荐使用双列模板</strong>，除非没有长公式或者长图、长表等等，<br>elsarticle的双列模板虽然好看，但是给排版（尤其是跨列图、表、公式）带来诸多困难。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;threeparttable&#125; </span><br></pre></td></tr></table></figure>\n<p><code>threeparttable</code>可以实现表格以及表格下方的注释，十分好用。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[ruled,linesnumbered]&#123;algorithm2e&#125; </span><br></pre></td></tr></table></figure>\n<p><code>algorithm2e</code>是算法伪代码的常用宏包。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br></pre></td></tr></table></figure>\n<p><code>subcaption</code> 可以实现子图</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[nameinlink,capitalize]&#123;cleveref&#125; </span><br></pre></td></tr></table></figure>\n<p><code>cleveref</code> 实现交叉引用带label名字，比如<code>Section 1</code>, 而不是使用<code>\\ref</code>仅引用一个数字。<br><strong>该宏包最好放在所有宏包命令的最后</strong></p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;pdflscape&#125; <span class=\"comment\">% 单页横置</span></span><br></pre></td></tr></table></figure>\n<p><code>pdflscape</code>是某页横置的包，支持pdf旋转，比<code>landscape</code>更好一些。<br><code>landscape</code>编译出来后，pdf内容是横置的，但是页面仍是竖置，而<code>pdflscape</code>的页面也是横置的。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;midpage&#125; <span class=\"comment\">% 页面垂直居中内容</span></span><br></pre></td></tr></table></figure>\n<p><code>midpage</code>配合<code>pdflscape</code>使用，可以使用横置的内容位于页面的垂直方向的中心（垂直居中）。<br>再配合横向居中<code>\\centering</code>使用，就是页面的正中心。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;afterpage&#125; <span class=\"comment\">% 减少横向排版某页前后的空白页</span></span><br></pre></td></tr></table></figure>\n<p><code>afterpage</code>配合<code>pdflscape</code>使用，可避免<code>pdflscape</code>使用前后文章出现大面积空白（因为<code>pdflscape</code>在哪里使用就在哪里分页）。</p>\n<h1 id=\"2-实践例子\"><a href=\"#2-实践例子\" class=\"headerlink\" title=\"2. 实践例子\"></a>2. 实践例子</h1><p>Minimal Working Example (MWE) 是Latex是一个精简到最小长度的.tex文件。是一个可以运行的，最简短的tex文件。<br>以下例子均基于<code>MWE</code>或者elsarticle的<code>cas-sc-sample.tex</code>文件进行展示。<br>文本填充使用了<code>lipsum</code>宏包生成随机文本</p>\n<h2 id=\"行号-lineno\"><a href=\"#行号-lineno\" class=\"headerlink\" title=\"行号 lineno\"></a>行号 <code>lineno</code></h2><p>展示行号使用了lineno宏包，代码如下：</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lineno&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\let</span><span class=\"keyword\">\\WriteBookmarks</span><span class=\"keyword\">\\relax</span></span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\floatpagepagefraction</span>&#123;1&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\textpagefraction</span>&#123;.001&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class=\"line\"><span class=\"keyword\">\\author</span>[1]&#123;Name&#125;[]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;abstract&#125;</span><br><span class=\"line\">  Null.</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;abstract&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;keywords&#125;</span><br><span class=\"line\">  Null</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;keywords&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\maketitle</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\linenumbers</span></span><br><span class=\"line\"><span class=\"keyword\">\\section</span>&#123;Introduction&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\lipsum</span>[1]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p><code>\\linenumbers</code>命令放在节标题前面就可以生成行号了，结果如下：</p>\n<p><img src=\"/../images/20240824/2024-08-27-14-21-28.png\" alt=\"行号生成\"></p>\n<h2 id=\"表格注释threeparttable\"><a href=\"#表格注释threeparttable\" class=\"headerlink\" title=\"表格注释threeparttable\"></a>表格注释<code>threeparttable</code></h2><p>在表格展示结果的过程中总会有需要在表格下方注释的情况，使用<code>threeparttable</code>宏包可满足该需求。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;threeparttable&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\let</span><span class=\"keyword\">\\WriteBookmarks</span><span class=\"keyword\">\\relax</span></span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\floatpagepagefraction</span>&#123;1&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\textpagefraction</span>&#123;.001&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class=\"line\"><span class=\"keyword\">\\author</span>[1]&#123;Name&#125;[]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;abstract&#125;</span><br><span class=\"line\">  Null.</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;abstract&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;keywords&#125;</span><br><span class=\"line\">  Null</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;keywords&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\maketitle</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\section</span>&#123;Introduction&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\lipsum</span>[1]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;table&#125;[width=0.4<span class=\"keyword\">\\textwidth</span>, pos=thb]</span><br><span class=\"line\"><span class=\"keyword\">\\scriptsize</span></span><br><span class=\"line\"><span class=\"keyword\">\\tabcolsep</span>=2.5pt</span><br><span class=\"line\"><span class=\"keyword\">\\renewcommand</span><span class=\"keyword\">\\arraystretch</span>&#123;1.5&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\centering</span></span><br><span class=\"line\"><span class=\"keyword\">\\caption</span>&#123;Table notes&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\label</span>&#123;tb:review&#125;<span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;threeparttable&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;tabular*&#125;&#123;<span class=\"keyword\">\\tblwidth</span>&#125;&#123;lcclccl&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\toprule</span></span><br><span class=\"line\">    Ref. <span class=\"built_in\">&amp;</span> <span class=\"keyword\">\\multicolumn</span>&#123;2&#125;&#123;c&#125;&#123;Omnichannel concept&#125; <span class=\"built_in\">&amp;</span> <span class=\"keyword\">\\multicolumn</span>&#123;2&#125;&#123;l&#125;&#123;Customer&#125; <span class=\"built_in\">&amp;</span> <span class=\"keyword\">\\multicolumn</span>&#123;1&#125;&#123;l&#125;&#123;Store&#125;  <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">    <span class=\"keyword\">\\midrule</span></span><br><span class=\"line\">    O<span class=\"keyword\">\\tnote</span>&#123;a&#125; <span class=\"built_in\">&amp;</span> F  <span class=\"built_in\">&amp;</span> S <span class=\"built_in\">&amp;</span> M  <span class=\"built_in\">&amp;</span> P <span class=\"built_in\">&amp;</span> S  <span class=\"built_in\">&amp;</span> L,C   <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">    C <span class=\"built_in\">&amp;</span> R  <span class=\"built_in\">&amp;</span> S <span class=\"built_in\">&amp;</span> M<span class=\"keyword\">\\tnote</span>&#123;*&#125;  <span class=\"built_in\">&amp;</span> C <span class=\"built_in\">&amp;</span> H  <span class=\"built_in\">&amp;</span> L,R   <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">    O <span class=\"built_in\">&amp;</span> R  <span class=\"built_in\">&amp;</span> S <span class=\"built_in\">&amp;</span> M  <span class=\"built_in\">&amp;</span> C <span class=\"built_in\">&amp;</span> H  <span class=\"built_in\">&amp;</span> L,R<span class=\"keyword\">\\tnote</span>&#123;<span class=\"built_in\">$</span><span class=\"keyword\">\\dagger</span><span class=\"built_in\">$</span>&#125; <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">    <span class=\"keyword\">\\bottomrule</span></span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;tabular*&#125;<span class=\"comment\">%</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;tablenotes&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\scriptsize</span></span><br><span class=\"line\">    <span class=\"keyword\">\\item</span>[a] table note a </span><br><span class=\"line\">    <span class=\"keyword\">\\item</span>[*] asterisk</span><br><span class=\"line\">    <span class=\"keyword\">\\item</span>[<span class=\"built_in\">$</span><span class=\"keyword\">\\dagger</span><span class=\"built_in\">$</span>] dagger</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;tablenotes&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;threeparttable&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;table&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>这会生成一个带有注释的表格。</p>\n<p><img src=\"/../images/20240824/tablenote.png\" alt=\"表格注释\"></p>\n<h2 id=\"伪代码\"><a href=\"#伪代码\" class=\"headerlink\" title=\"伪代码\"></a>伪代码</h2><p>请参考Overleaf的伪代码包，写的非常详细。<br><a href=\"https://www.overleaf.com/learn/latex/Algorithms\">https://www.overleaf.com/learn/latex/Algorithms</a></p>\n<h2 id=\"子图-subcaption\"><a href=\"#子图-subcaption\" class=\"headerlink\" title=\"子图 subcaption\"></a>子图 <code>subcaption</code></h2><p>使用子图，只需要引用<code>subcaption</code>宏包即可，子图换行使用<code>\\\\</code>即可。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\let</span><span class=\"keyword\">\\WriteBookmarks</span><span class=\"keyword\">\\relax</span></span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\floatpagepagefraction</span>&#123;1&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\textpagefraction</span>&#123;.001&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class=\"line\"><span class=\"keyword\">\\author</span>[1]&#123;Name&#125;[]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;abstract&#125;</span><br><span class=\"line\">  Null.</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;abstract&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;keywords&#125;</span><br><span class=\"line\">  Null</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;keywords&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\maketitle</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\section</span>&#123;Introduction&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\lipsum</span>[1]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class=\"line\">  <span class=\"keyword\">\\centering</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 1&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:routes&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 2&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:cycle&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 3&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:aggregate&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 4&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:assign&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hspace</span>&#123;0.15<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 5&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:newroute&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\caption</span>&#123;<span class=\"keyword\">\\label</span>&#123;fig:aggr&#125; Subfigures&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;figure&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>这会生成一个两行子图，第一行有3张，第二行有2张。<br><img src=\"/../images/20240824/subfigure.png\" alt=\"表格注释\"></p>\n<h2 id=\"交叉引用-cleveref\"><a href=\"#交叉引用-cleveref\" class=\"headerlink\" title=\"交叉引用 cleveref\"></a>交叉引用 <code>cleveref</code></h2><p>交叉引用是Latex一个重要的功能，自带的<code>\\ref</code>功能只能引用数字，生成出来的效果并不好看，比如“Section <span style=\"color:blue;\">1.1 </span>”, 而不是期刊常见的“<span style=\"color:blue;\">Section 1.1 </span>”。使用<code>cleveref</code>宏包解决这个问题。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[nameinlink,capitalize]&#123;cleveref&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\let</span><span class=\"keyword\">\\WriteBookmarks</span><span class=\"keyword\">\\relax</span></span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\floatpagepagefraction</span>&#123;1&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\textpagefraction</span>&#123;.001&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class=\"line\"><span class=\"keyword\">\\author</span>[1]&#123;Name&#125;[]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;abstract&#125;</span><br><span class=\"line\">  Null.</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;abstract&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;keywords&#125;</span><br><span class=\"line\">  Null</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;keywords&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\maketitle</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\section</span>&#123;Introduction&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\Cref</span>&#123;subfig:assign&#125; is in <span class=\"keyword\">\\Cref</span>&#123;fig:aggr&#125;. </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class=\"line\">  <span class=\"keyword\">\\centering</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 1&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:routes&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 2&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:cycle&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 3&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:aggregate&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 4&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:assign&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hspace</span>&#123;0.15<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 5&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:newroute&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\caption</span>&#123;<span class=\"keyword\">\\label</span>&#123;fig:aggr&#125; Subfigures&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;figure&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>这会生成一个带引用类型的交叉引用格式。<br><img src=\"/../images/20240824/cleveref.png\" alt=\"ref\"></p>\n<h2 id=\"横置某页-pdflscape-midpage-afterpage\"><a href=\"#横置某页-pdflscape-midpage-afterpage\" class=\"headerlink\" title=\"横置某页 pdflscape midpage afterpage\"></a>横置某页 <code>pdflscape</code> <code>midpage</code> <code>afterpage</code></h2><p>横置一个pdf页码可以解决某个表格或者图太长的问题，使用<code>pdflscape</code>可以将某一页横置，以放下这些图表。<br>基础使用方法如下：</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;pdflscape&#125; </span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[nameinlink,capitalize]&#123;cleveref&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\let</span><span class=\"keyword\">\\WriteBookmarks</span><span class=\"keyword\">\\relax</span></span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\floatpagepagefraction</span>&#123;1&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\textpagefraction</span>&#123;.001&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class=\"line\"><span class=\"keyword\">\\author</span>[1]&#123;Name&#125;[]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;abstract&#125;</span><br><span class=\"line\">  Null.</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;abstract&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;keywords&#125;</span><br><span class=\"line\">  Null</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;keywords&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\maketitle</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\section</span>&#123;Introduction&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\Cref</span>&#123;subfig:assign&#125; is in <span class=\"keyword\">\\Cref</span>&#123;fig:aggr&#125;. </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;landscape&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class=\"line\">    <span class=\"keyword\">\\centering</span></span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\caption</span>&#123;subfigure 1&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\label</span>&#123;subfig:routes&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\caption</span>&#123;subfigure 2&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\label</span>&#123;subfig:cycle&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\caption</span>&#123;subfigure 3&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\label</span>&#123;subfig:aggregate&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\caption</span>&#123;subfigure 4&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\label</span>&#123;subfig:assign&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\hspace</span>&#123;0.15<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\caption</span>&#123;subfigure 5&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\label</span>&#123;subfig:newroute&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;<span class=\"keyword\">\\label</span>&#123;fig:aggr&#125; Subfigures&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;figure&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;landscape&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>这会得到一个横置的页面,注意到这个页面是横置的，所有的内容在页面的上方，下一步是把这些图片垂直居中。<br><img src=\"/../images/20240824/landscape.png\" alt=\"landscape\"><br>只需要在<code>landscape</code>和<code>figure</code>环境之间套一层<code>midpage</code>环境即可。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;pdflscape&#125; </span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;midpage&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;landscape&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;midpage&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class=\"line\">      ... 图表代码</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;figure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;midpage&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;landscape&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>得到居中的插图：<br><img src=\"/../images/20240824/landscape_center.png\" alt=\"landscape\"></p>\n<p>但是，横置页前后的文字会因为横置页突然打断，出现大面积空白。这时还需要<code>afterpage</code>宏包，使得横置页平滑插入到文字中，用<code>\\afterpage&#123;&#125;</code>命令把<code>landscape</code>环境包裹起来。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;pdflscape&#125; </span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;midpage&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\afterpage</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;landscape&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;midpage&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class=\"line\">        ... 图表代码</span><br><span class=\"line\">      <span class=\"keyword\">\\end</span>&#123;figure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;midpage&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;landscape&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>生成的效果如图，可见横置页丝滑插入段落中，没有产生大面积空白</p>\n<p><img src=\"/../images/20240824/landscape_after.png\" alt=\"landscape\"></p>\n<h2 id=\"禁止分页\"><a href=\"#禁止分页\" class=\"headerlink\" title=\"禁止分页\"></a>禁止分页</h2><p>使用<code>\\nopagebreak</code>表示禁止在此处断页。</p>\n<p>此外，还可以使用</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;parskip&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\AddToHook</span>&#123;env/samepage/begin&#125;&#123;<span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"keyword\">\\AddToHook</span>&#123;para/before&#125;&#123;<span class=\"keyword\">\\nopagebreak</span>&#125;<span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"keyword\">\\AddToHook</span>&#123;para/after&#125;&#123;<span class=\"keyword\">\\nopagebreak</span>&#125;<span class=\"comment\">%</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;samepage&#125;</span><br><span class=\"line\">在一页的第一段</span><br><span class=\"line\"></span><br><span class=\"line\">在一页的第二段</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;samepage&#125;</span><br></pre></td></tr></table></figure>\n<p>另两个段落出现在同一页。</p>\n<h2 id=\"公式间距微调\"><a href=\"#公式间距微调\" class=\"headerlink\" title=\"公式间距微调\"></a>公式间距微调</h2><p>参考这篇文章<a href=\"https://tex.stackexchange.com/questions/74353/what-commands-are-there-for-horizontal-spacing\">https://tex.stackexchange.com/questions/74353/what-commands-are-there-for-horizontal-spacing</a><br>下面的源代码将在字母ab之间产生不同大小的横向间距。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>&#123;article&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[margin=1in]&#123;geometry&#125;<span class=\"comment\">% Just for this example</span></span><br><span class=\"line\"><span class=\"keyword\">\\setlength</span>&#123;<span class=\"keyword\">\\parindent</span>&#125;&#123;0pt&#125;<span class=\"comment\">% Just for this example</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">There are a number of horizontal spacing macros for LaTeX:</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;tabular&#125;&#123;lp&#123;5cm&#125;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\,b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\,</span>b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\,</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\thinspace b</span>|            <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\thinspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\thinspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\!b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\!</span>b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\!</span>b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\negthinspace b</span>|         <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\negthinspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\negthinspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\:b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\:</span>b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\:</span>b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\&gt;b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\&gt;</span>b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\&gt;</span>b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\medspace b</span>|             <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\medspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\medspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\negmedspace b</span>|          <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\negmedspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\negmedspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\;b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\;</span>b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\;</span>b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\thickspace b</span>|           <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\thickspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\thickspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\negthickspace b</span>|        <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\negthickspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\negthickspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern\\thinmuskip b$</span>|   <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span><span class=\"keyword\">\\thinmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\,</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern-\\thinmuskip b$</span>|  <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span>-<span class=\"keyword\">\\thinmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\!</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern\\medmuskip b$</span>|    <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span><span class=\"keyword\">\\medmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\:</span>| or <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\&gt;</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern-\\medmuskip b$</span>|   <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span>-<span class=\"keyword\">\\medmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\negmedspace</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern\\thickmuskip b$</span>|  <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span><span class=\"keyword\">\\thickmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\;</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern-\\thickmuskip b$</span>| <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span>-<span class=\"keyword\">\\thickmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\negthickspace</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\enspace b</span>|              <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\enspace</span> b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\enspace b$</span>|            <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\enspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\quad b</span>|                 <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\quad</span> b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\quad b$</span>|               <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\quad</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\qquad b</span>|                <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\qquad</span> b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\qquad b$</span>|              <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\qquad</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\hskip 1em b</span>|            <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\hskip</span> 1em b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\hskip 1em b$</span>|          <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\hskip</span> 1em b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\kern 1pc b</span>|             <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\kern</span> 1pc b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\kern 1pc b$</span>|           <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\kern</span> 1pc b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern 17mu b$</span>|         <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span> 17mu b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\hspace&#123;35pt&#125;b</span>|          <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\hspace</span>&#123;35pt&#125;b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\hspace&#123;35pt&#125;b$</span>|        <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\hspace</span>&#123;35pt&#125;b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">axyzb</span>|                    <span class=\"built_in\">&amp;</span> axyzb <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\hphantom&#123;xyz&#125;b</span>|         <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\hphantom</span>&#123;xyz&#125;b (or just <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\phantom</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$axyzb$</span>|                  <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>axyzb<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\hphantom&#123;xyz&#125;b$</span>|       <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\hphantom</span>&#123;xyz&#125;b<span class=\"built_in\">$</span> (or just <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\phantom</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a b</span>|                      <span class=\"built_in\">&amp;</span> a b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a b$</span>|                    <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\space b</span>|                <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\space</span> b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\space b$</span>|              <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\space</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\ b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\ </span>b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\ b$</span>|                   <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\ </span>b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a&#123; &#125;b</span>|                    <span class=\"built_in\">&amp;</span> a&#123; &#125;b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a&#123; &#125;b$</span>|                  <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a&#123; &#125;b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a~b</span>|                      <span class=\"built_in\">&amp;</span> a~b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a~b$</span>|                    <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a~b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\hfill b</span>|                <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\hfill</span> b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\hfill b$</span>|              <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\hfill</span> b<span class=\"built_in\">$</span></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;tabular&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n\n<p>其中，控制间距的代码是可以在公式环境内部调整的。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;equation&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\thinmuskip</span>=3mu</span><br><span class=\"line\"><span class=\"keyword\">\\medmuskip</span>=4mu plus 2mu minus 4mu</span><br><span class=\"line\"><span class=\"keyword\">\\thickmuskip</span>=5mu plus 5mu</span><br><span class=\"line\">a + b = c</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;equation&#125;</span><br></pre></td></tr></table></figure>","excerpt":"","more":"<!-- <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mo>∫</mo><mi>a</mi><mi>b</mi></msubsup><mi>sin</mi><mo>⁡</mo><mi>x</mi><mi>d</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\int_a^b \\sin x dx</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.3998em;vertical-align:-0.3558em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.044em;\"><span style=\"top:-2.3442em;margin-left:-0.1945em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span><span style=\"top:-3.2579em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3558em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span></span> -->\n\n<p>LaTex是科研写作中常见的排版工具。爱思唯尔期刊提供了Latex模板，使用该模板可简化在投稿过程中关于稿件的排版过程，在编译过后就能得到期刊认可的排版格式。</p>\n<p>不少期刊都已经采用了“Your paper your way”的投稿方式，即根据作者的喜好的排版方式提交稿件，在接收后排版成期刊的要求的格式即可，但也提供了Latex模板。<br>关于爱思唯尔期刊的Latex模板，详见<a href=\"https://www.elsevier.com/researcher/author/policies-and-guidelines/latex-instructions\">https://www.elsevier.com/researcher/author/policies-and-guidelines/latex-instructions</a></p>\n<p>尽管<strong>内容大于形式，红楼梦手抄一万遍也是经典，我的博客打印出来也只是我的博客</strong>，<br>但我们使用Latex模板将给审稿人表达一种专业且认真的态度，也可以简化写作、排版、公式输入及编号、交叉引用的流程。</p>\n<p>请注意：<u>阅读本文需要一定Latex使用经验，且本文只针对爱思唯尔期刊Latex模板elsarticle有效。</u></p>\n<h1 id=\"1-使用的宏包介绍\"><a href=\"#1-使用的宏包介绍\" class=\"headerlink\" title=\"1. 使用的宏包介绍\"></a>1. 使用的宏包介绍</h1><figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">% \\usepackage[numbers]&#123;natbib&#125;</span></span><br><span class=\"line\"><span class=\"comment\">% \\usepackage[authoryear,longnamesfirst]&#123;natbib&#125;</span></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[authoryear]&#123;natbib&#125;</span><br></pre></td></tr></table></figure>\n<p>该宏包是elsarticle自带的引用格式的宏包，一般我选择使用第三个<code>[authoryear]</code>参数。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lineno&#125;</span><br></pre></td></tr></table></figure>\n<p><code>lineno</code>是行号宏包，投稿时如需加行号则使用此宏包。<br>然而，该宏包对于模板的双列布局可用，但是支持性一般。<br>此外<strong>不推荐使用双列模板</strong>，除非没有长公式或者长图、长表等等，<br>elsarticle的双列模板虽然好看，但是给排版（尤其是跨列图、表、公式）带来诸多困难。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;threeparttable&#125; </span><br></pre></td></tr></table></figure>\n<p><code>threeparttable</code>可以实现表格以及表格下方的注释，十分好用。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[ruled,linesnumbered]&#123;algorithm2e&#125; </span><br></pre></td></tr></table></figure>\n<p><code>algorithm2e</code>是算法伪代码的常用宏包。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br></pre></td></tr></table></figure>\n<p><code>subcaption</code> 可以实现子图</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[nameinlink,capitalize]&#123;cleveref&#125; </span><br></pre></td></tr></table></figure>\n<p><code>cleveref</code> 实现交叉引用带label名字，比如<code>Section 1</code>, 而不是使用<code>\\ref</code>仅引用一个数字。<br><strong>该宏包最好放在所有宏包命令的最后</strong></p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;pdflscape&#125; <span class=\"comment\">% 单页横置</span></span><br></pre></td></tr></table></figure>\n<p><code>pdflscape</code>是某页横置的包，支持pdf旋转，比<code>landscape</code>更好一些。<br><code>landscape</code>编译出来后，pdf内容是横置的，但是页面仍是竖置，而<code>pdflscape</code>的页面也是横置的。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;midpage&#125; <span class=\"comment\">% 页面垂直居中内容</span></span><br></pre></td></tr></table></figure>\n<p><code>midpage</code>配合<code>pdflscape</code>使用，可以使用横置的内容位于页面的垂直方向的中心（垂直居中）。<br>再配合横向居中<code>\\centering</code>使用，就是页面的正中心。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;afterpage&#125; <span class=\"comment\">% 减少横向排版某页前后的空白页</span></span><br></pre></td></tr></table></figure>\n<p><code>afterpage</code>配合<code>pdflscape</code>使用，可避免<code>pdflscape</code>使用前后文章出现大面积空白（因为<code>pdflscape</code>在哪里使用就在哪里分页）。</p>\n<h1 id=\"2-实践例子\"><a href=\"#2-实践例子\" class=\"headerlink\" title=\"2. 实践例子\"></a>2. 实践例子</h1><p>Minimal Working Example (MWE) 是Latex是一个精简到最小长度的.tex文件。是一个可以运行的，最简短的tex文件。<br>以下例子均基于<code>MWE</code>或者elsarticle的<code>cas-sc-sample.tex</code>文件进行展示。<br>文本填充使用了<code>lipsum</code>宏包生成随机文本</p>\n<h2 id=\"行号-lineno\"><a href=\"#行号-lineno\" class=\"headerlink\" title=\"行号 lineno\"></a>行号 <code>lineno</code></h2><p>展示行号使用了lineno宏包，代码如下：</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lineno&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\let</span><span class=\"keyword\">\\WriteBookmarks</span><span class=\"keyword\">\\relax</span></span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\floatpagepagefraction</span>&#123;1&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\textpagefraction</span>&#123;.001&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class=\"line\"><span class=\"keyword\">\\author</span>[1]&#123;Name&#125;[]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;abstract&#125;</span><br><span class=\"line\">  Null.</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;abstract&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;keywords&#125;</span><br><span class=\"line\">  Null</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;keywords&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\maketitle</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\linenumbers</span></span><br><span class=\"line\"><span class=\"keyword\">\\section</span>&#123;Introduction&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\lipsum</span>[1]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p><code>\\linenumbers</code>命令放在节标题前面就可以生成行号了，结果如下：</p>\n<p><img src=\"/../images/20240824/2024-08-27-14-21-28.png\" alt=\"行号生成\"></p>\n<h2 id=\"表格注释threeparttable\"><a href=\"#表格注释threeparttable\" class=\"headerlink\" title=\"表格注释threeparttable\"></a>表格注释<code>threeparttable</code></h2><p>在表格展示结果的过程中总会有需要在表格下方注释的情况，使用<code>threeparttable</code>宏包可满足该需求。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;threeparttable&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\let</span><span class=\"keyword\">\\WriteBookmarks</span><span class=\"keyword\">\\relax</span></span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\floatpagepagefraction</span>&#123;1&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\textpagefraction</span>&#123;.001&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class=\"line\"><span class=\"keyword\">\\author</span>[1]&#123;Name&#125;[]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;abstract&#125;</span><br><span class=\"line\">  Null.</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;abstract&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;keywords&#125;</span><br><span class=\"line\">  Null</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;keywords&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\maketitle</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\section</span>&#123;Introduction&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\lipsum</span>[1]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;table&#125;[width=0.4<span class=\"keyword\">\\textwidth</span>, pos=thb]</span><br><span class=\"line\"><span class=\"keyword\">\\scriptsize</span></span><br><span class=\"line\"><span class=\"keyword\">\\tabcolsep</span>=2.5pt</span><br><span class=\"line\"><span class=\"keyword\">\\renewcommand</span><span class=\"keyword\">\\arraystretch</span>&#123;1.5&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\centering</span></span><br><span class=\"line\"><span class=\"keyword\">\\caption</span>&#123;Table notes&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\label</span>&#123;tb:review&#125;<span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;threeparttable&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;tabular*&#125;&#123;<span class=\"keyword\">\\tblwidth</span>&#125;&#123;lcclccl&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\toprule</span></span><br><span class=\"line\">    Ref. <span class=\"built_in\">&amp;</span> <span class=\"keyword\">\\multicolumn</span>&#123;2&#125;&#123;c&#125;&#123;Omnichannel concept&#125; <span class=\"built_in\">&amp;</span> <span class=\"keyword\">\\multicolumn</span>&#123;2&#125;&#123;l&#125;&#123;Customer&#125; <span class=\"built_in\">&amp;</span> <span class=\"keyword\">\\multicolumn</span>&#123;1&#125;&#123;l&#125;&#123;Store&#125;  <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">    <span class=\"keyword\">\\midrule</span></span><br><span class=\"line\">    O<span class=\"keyword\">\\tnote</span>&#123;a&#125; <span class=\"built_in\">&amp;</span> F  <span class=\"built_in\">&amp;</span> S <span class=\"built_in\">&amp;</span> M  <span class=\"built_in\">&amp;</span> P <span class=\"built_in\">&amp;</span> S  <span class=\"built_in\">&amp;</span> L,C   <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">    C <span class=\"built_in\">&amp;</span> R  <span class=\"built_in\">&amp;</span> S <span class=\"built_in\">&amp;</span> M<span class=\"keyword\">\\tnote</span>&#123;*&#125;  <span class=\"built_in\">&amp;</span> C <span class=\"built_in\">&amp;</span> H  <span class=\"built_in\">&amp;</span> L,R   <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">    O <span class=\"built_in\">&amp;</span> R  <span class=\"built_in\">&amp;</span> S <span class=\"built_in\">&amp;</span> M  <span class=\"built_in\">&amp;</span> C <span class=\"built_in\">&amp;</span> H  <span class=\"built_in\">&amp;</span> L,R<span class=\"keyword\">\\tnote</span>&#123;<span class=\"built_in\">$</span><span class=\"keyword\">\\dagger</span><span class=\"built_in\">$</span>&#125; <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">    <span class=\"keyword\">\\bottomrule</span></span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;tabular*&#125;<span class=\"comment\">%</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;tablenotes&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\scriptsize</span></span><br><span class=\"line\">    <span class=\"keyword\">\\item</span>[a] table note a </span><br><span class=\"line\">    <span class=\"keyword\">\\item</span>[*] asterisk</span><br><span class=\"line\">    <span class=\"keyword\">\\item</span>[<span class=\"built_in\">$</span><span class=\"keyword\">\\dagger</span><span class=\"built_in\">$</span>] dagger</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;tablenotes&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;threeparttable&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;table&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>这会生成一个带有注释的表格。</p>\n<p><img src=\"/../images/20240824/tablenote.png\" alt=\"表格注释\"></p>\n<h2 id=\"伪代码\"><a href=\"#伪代码\" class=\"headerlink\" title=\"伪代码\"></a>伪代码</h2><p>请参考Overleaf的伪代码包，写的非常详细。<br><a href=\"https://www.overleaf.com/learn/latex/Algorithms\">https://www.overleaf.com/learn/latex/Algorithms</a></p>\n<h2 id=\"子图-subcaption\"><a href=\"#子图-subcaption\" class=\"headerlink\" title=\"子图 subcaption\"></a>子图 <code>subcaption</code></h2><p>使用子图，只需要引用<code>subcaption</code>宏包即可，子图换行使用<code>\\\\</code>即可。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\let</span><span class=\"keyword\">\\WriteBookmarks</span><span class=\"keyword\">\\relax</span></span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\floatpagepagefraction</span>&#123;1&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\textpagefraction</span>&#123;.001&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class=\"line\"><span class=\"keyword\">\\author</span>[1]&#123;Name&#125;[]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;abstract&#125;</span><br><span class=\"line\">  Null.</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;abstract&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;keywords&#125;</span><br><span class=\"line\">  Null</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;keywords&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\maketitle</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\section</span>&#123;Introduction&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\lipsum</span>[1]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class=\"line\">  <span class=\"keyword\">\\centering</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 1&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:routes&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 2&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:cycle&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 3&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:aggregate&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 4&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:assign&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hspace</span>&#123;0.15<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 5&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:newroute&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\caption</span>&#123;<span class=\"keyword\">\\label</span>&#123;fig:aggr&#125; Subfigures&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;figure&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>这会生成一个两行子图，第一行有3张，第二行有2张。<br><img src=\"/../images/20240824/subfigure.png\" alt=\"表格注释\"></p>\n<h2 id=\"交叉引用-cleveref\"><a href=\"#交叉引用-cleveref\" class=\"headerlink\" title=\"交叉引用 cleveref\"></a>交叉引用 <code>cleveref</code></h2><p>交叉引用是Latex一个重要的功能，自带的<code>\\ref</code>功能只能引用数字，生成出来的效果并不好看，比如“Section <span style=\"color:blue;\">1.1 </span>”, 而不是期刊常见的“<span style=\"color:blue;\">Section 1.1 </span>”。使用<code>cleveref</code>宏包解决这个问题。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[nameinlink,capitalize]&#123;cleveref&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\let</span><span class=\"keyword\">\\WriteBookmarks</span><span class=\"keyword\">\\relax</span></span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\floatpagepagefraction</span>&#123;1&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\textpagefraction</span>&#123;.001&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class=\"line\"><span class=\"keyword\">\\author</span>[1]&#123;Name&#125;[]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;abstract&#125;</span><br><span class=\"line\">  Null.</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;abstract&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;keywords&#125;</span><br><span class=\"line\">  Null</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;keywords&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\maketitle</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\section</span>&#123;Introduction&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\Cref</span>&#123;subfig:assign&#125; is in <span class=\"keyword\">\\Cref</span>&#123;fig:aggr&#125;. </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class=\"line\">  <span class=\"keyword\">\\centering</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 1&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:routes&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 2&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:cycle&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 3&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:aggregate&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 4&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:assign&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\hspace</span>&#123;0.15<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;subfigure 5&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\label</span>&#123;subfig:newroute&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\caption</span>&#123;<span class=\"keyword\">\\label</span>&#123;fig:aggr&#125; Subfigures&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;figure&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>这会生成一个带引用类型的交叉引用格式。<br><img src=\"/../images/20240824/cleveref.png\" alt=\"ref\"></p>\n<h2 id=\"横置某页-pdflscape-midpage-afterpage\"><a href=\"#横置某页-pdflscape-midpage-afterpage\" class=\"headerlink\" title=\"横置某页 pdflscape midpage afterpage\"></a>横置某页 <code>pdflscape</code> <code>midpage</code> <code>afterpage</code></h2><p>横置一个pdf页码可以解决某个表格或者图太长的问题，使用<code>pdflscape</code>可以将某一页横置，以放下这些图表。<br>基础使用方法如下：</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;pdflscape&#125; </span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[nameinlink,capitalize]&#123;cleveref&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\let</span><span class=\"keyword\">\\WriteBookmarks</span><span class=\"keyword\">\\relax</span></span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\floatpagepagefraction</span>&#123;1&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\def</span><span class=\"keyword\">\\textpagefraction</span>&#123;.001&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\title</span> [mode = title]&#123;This is a title&#125;                      </span><br><span class=\"line\"><span class=\"keyword\">\\author</span>[1]&#123;Name&#125;[]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;abstract&#125;</span><br><span class=\"line\">  Null.</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;abstract&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;keywords&#125;</span><br><span class=\"line\">  Null</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;keywords&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\maketitle</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\section</span>&#123;Introduction&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\Cref</span>&#123;subfig:assign&#125; is in <span class=\"keyword\">\\Cref</span>&#123;fig:aggr&#125;. </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;landscape&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class=\"line\">    <span class=\"keyword\">\\centering</span></span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\caption</span>&#123;subfigure 1&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\label</span>&#123;subfig:routes&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\caption</span>&#123;subfigure 2&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\label</span>&#123;subfig:cycle&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\hfill</span></span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\caption</span>&#123;subfigure 3&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\label</span>&#123;subfig:aggregate&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\caption</span>&#123;subfigure 4&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\label</span>&#123;subfig:assign&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\hspace</span>&#123;0.15<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;subfigure&#125;&#123;0.3<span class=\"keyword\">\\textwidth</span>&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\includegraphics</span>[width=<span class=\"keyword\">\\textwidth</span>]&#123;figs/cas-grabs.pdf&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\caption</span>&#123;subfigure 5&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\label</span>&#123;subfig:newroute&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;subfigure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\caption</span>&#123;<span class=\"keyword\">\\label</span>&#123;fig:aggr&#125; Subfigures&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;figure&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;landscape&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>这会得到一个横置的页面,注意到这个页面是横置的，所有的内容在页面的上方，下一步是把这些图片垂直居中。<br><img src=\"/../images/20240824/landscape.png\" alt=\"landscape\"><br>只需要在<code>landscape</code>和<code>figure</code>环境之间套一层<code>midpage</code>环境即可。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;pdflscape&#125; </span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;midpage&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;landscape&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;midpage&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class=\"line\">      ... 图表代码</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;figure&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;midpage&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;landscape&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>得到居中的插图：<br><img src=\"/../images/20240824/landscape_center.png\" alt=\"landscape\"></p>\n<p>但是，横置页前后的文字会因为横置页突然打断，出现大面积空白。这时还需要<code>afterpage</code>宏包，使得横置页平滑插入到文字中，用<code>\\afterpage&#123;&#125;</code>命令把<code>landscape</code>环境包裹起来。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>[a4paper,fleqn]&#123;cas-sc&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;lipsum&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;subcaption&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;pdflscape&#125; </span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;midpage&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\afterpage</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">\\begin</span>&#123;landscape&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\begin</span>&#123;midpage&#125;</span><br><span class=\"line\">      <span class=\"keyword\">\\begin</span>&#123;figure&#125;[pos = htb]</span><br><span class=\"line\">        ... 图表代码</span><br><span class=\"line\">      <span class=\"keyword\">\\end</span>&#123;figure&#125;</span><br><span class=\"line\">    <span class=\"keyword\">\\end</span>&#123;midpage&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\end</span>&#123;landscape&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n<p>生成的效果如图，可见横置页丝滑插入段落中，没有产生大面积空白</p>\n<p><img src=\"/../images/20240824/landscape_after.png\" alt=\"landscape\"></p>\n<h2 id=\"禁止分页\"><a href=\"#禁止分页\" class=\"headerlink\" title=\"禁止分页\"></a>禁止分页</h2><p>使用<code>\\nopagebreak</code>表示禁止在此处断页。</p>\n<p>此外，还可以使用</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\usepackage</span>&#123;parskip&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\AddToHook</span>&#123;env/samepage/begin&#125;&#123;<span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"keyword\">\\AddToHook</span>&#123;para/before&#125;&#123;<span class=\"keyword\">\\nopagebreak</span>&#125;<span class=\"comment\">%</span></span><br><span class=\"line\"><span class=\"keyword\">\\AddToHook</span>&#123;para/after&#125;&#123;<span class=\"keyword\">\\nopagebreak</span>&#125;<span class=\"comment\">%</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;samepage&#125;</span><br><span class=\"line\">在一页的第一段</span><br><span class=\"line\"></span><br><span class=\"line\">在一页的第二段</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;samepage&#125;</span><br></pre></td></tr></table></figure>\n<p>另两个段落出现在同一页。</p>\n<h2 id=\"公式间距微调\"><a href=\"#公式间距微调\" class=\"headerlink\" title=\"公式间距微调\"></a>公式间距微调</h2><p>参考这篇文章<a href=\"https://tex.stackexchange.com/questions/74353/what-commands-are-there-for-horizontal-spacing\">https://tex.stackexchange.com/questions/74353/what-commands-are-there-for-horizontal-spacing</a><br>下面的源代码将在字母ab之间产生不同大小的横向间距。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\documentclass</span>&#123;article&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\usepackage</span>[margin=1in]&#123;geometry&#125;<span class=\"comment\">% Just for this example</span></span><br><span class=\"line\"><span class=\"keyword\">\\setlength</span>&#123;<span class=\"keyword\">\\parindent</span>&#125;&#123;0pt&#125;<span class=\"comment\">% Just for this example</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;document&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">There are a number of horizontal spacing macros for LaTeX:</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;tabular&#125;&#123;lp&#123;5cm&#125;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\,b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\,</span>b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\,</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\thinspace b</span>|            <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\thinspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\thinspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\!b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\!</span>b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\!</span>b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\negthinspace b</span>|         <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\negthinspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\negthinspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\:b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\:</span>b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\:</span>b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\&gt;b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\&gt;</span>b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\&gt;</span>b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\medspace b</span>|             <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\medspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\medspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\negmedspace b</span>|          <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\negmedspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\negmedspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\;b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\;</span>b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\;</span>b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\thickspace b</span>|           <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\thickspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\thickspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\negthickspace b</span>|        <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\negthickspace</span> b <span class=\"keyword\">\\quad</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\negthickspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern\\thinmuskip b$</span>|   <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span><span class=\"keyword\">\\thinmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\,</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern-\\thinmuskip b$</span>|  <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span>-<span class=\"keyword\">\\thinmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\!</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern\\medmuskip b$</span>|    <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span><span class=\"keyword\">\\medmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\:</span>| or <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\&gt;</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern-\\medmuskip b$</span>|   <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span>-<span class=\"keyword\">\\medmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\negmedspace</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern\\thickmuskip b$</span>|  <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span><span class=\"keyword\">\\thickmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\;</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern-\\thickmuskip b$</span>| <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span>-<span class=\"keyword\">\\thickmuskip</span> b<span class=\"built_in\">$</span> (similar to <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\negthickspace</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\enspace b</span>|              <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\enspace</span> b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\enspace b$</span>|            <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\enspace</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\quad b</span>|                 <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\quad</span> b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\quad b$</span>|               <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\quad</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\qquad b</span>|                <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\qquad</span> b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\qquad b$</span>|              <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\qquad</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\hskip 1em b</span>|            <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\hskip</span> 1em b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\hskip 1em b$</span>|          <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\hskip</span> 1em b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\kern 1pc b</span>|             <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\kern</span> 1pc b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\kern 1pc b$</span>|           <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\kern</span> 1pc b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\mkern 17mu b$</span>|         <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\mkern</span> 17mu b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\hspace&#123;35pt&#125;b</span>|          <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\hspace</span>&#123;35pt&#125;b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\hspace&#123;35pt&#125;b$</span>|        <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\hspace</span>&#123;35pt&#125;b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">axyzb</span>|                    <span class=\"built_in\">&amp;</span> axyzb <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\hphantom&#123;xyz&#125;b</span>|         <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\hphantom</span>&#123;xyz&#125;b (or just <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\phantom</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$axyzb$</span>|                  <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>axyzb<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\hphantom&#123;xyz&#125;b$</span>|       <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\hphantom</span>&#123;xyz&#125;b<span class=\"built_in\">$</span> (or just <span class=\"keyword\">\\verb</span>|<span class=\"string\">\\phantom</span>|) <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a b</span>|                      <span class=\"built_in\">&amp;</span> a b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a b$</span>|                    <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\space b</span>|                <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\space</span> b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\space b$</span>|              <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\space</span> b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\ b</span>|                     <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\ </span>b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\ b$</span>|                   <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\ </span>b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a&#123; &#125;b</span>|                    <span class=\"built_in\">&amp;</span> a&#123; &#125;b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a&#123; &#125;b$</span>|                  <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a&#123; &#125;b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a~b</span>|                      <span class=\"built_in\">&amp;</span> a~b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a~b$</span>|                    <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a~b<span class=\"built_in\">$</span> <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">a\\hfill b</span>|                <span class=\"built_in\">&amp;</span> a<span class=\"keyword\">\\hfill</span> b <span class=\"keyword\">\\\\</span></span><br><span class=\"line\">  <span class=\"keyword\">\\verb</span>|<span class=\"string\">$a\\hfill b$</span>|              <span class=\"built_in\">&amp;</span> <span class=\"built_in\">$</span>a<span class=\"keyword\">\\hfill</span> b<span class=\"built_in\">$</span></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;tabular&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>\n\n<p>其中，控制间距的代码是可以在公式环境内部调整的。</p>\n<figure class=\"highlight latex\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">\\begin</span>&#123;equation&#125;</span><br><span class=\"line\"><span class=\"keyword\">\\thinmuskip</span>=3mu</span><br><span class=\"line\"><span class=\"keyword\">\\medmuskip</span>=4mu plus 2mu minus 4mu</span><br><span class=\"line\"><span class=\"keyword\">\\thickmuskip</span>=5mu plus 5mu</span><br><span class=\"line\">a + b = c</span><br><span class=\"line\"><span class=\"keyword\">\\end</span>&#123;equation&#125;</span><br></pre></td></tr></table></figure>"}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"cm0epapyk0000hjm1fk1bdvcy","tag_id":"cm0epapyn0001hjm1huhn9sjm","_id":"cm0epapyn0002hjm1g2030zd0"},{"post_id":"cm0epapyo0003hjm1ao0dgs8z","tag_id":"cm0epapyp0005hjm177cd84ta","_id":"cm0epapyp0008hjm1dfhia7cu"},{"post_id":"cm0epapyo0004hjm17gxs4joa","tag_id":"cm0epapyp0007hjm18qlncx60","_id":"cm0epapyp000ahjm12mvdhsvi"},{"post_id":"cm0epapyp0006hjm10tf553hh","tag_id":"cm0epapyp0009hjm1ckuk9vgj","_id":"cm0epapyp000bhjm10oeshbjh"}],"Tag":[{"name":"Others","_id":"cm0epapyn0001hjm1huhn9sjm"},{"name":"Matlab","_id":"cm0epapyp0005hjm177cd84ta"},{"name":"写作","_id":"cm0epapyp0007hjm18qlncx60"},{"name":"Latex","_id":"cm0epapyp0009hjm1ckuk9vgj"}]}}